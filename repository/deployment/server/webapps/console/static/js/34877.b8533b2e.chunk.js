"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[34877,65939,59723,2573,55],{65939:(e,n,t)=>{t.r(n),t.d(n,{addNewTenant:()=>a.addNewTenant,checkDuplicateTenants:()=>a.checkDuplicateTenants,getAssociatedTenants:()=>a.getAssociatedTenants,getDomainQueryParam:()=>a.getDomainQueryParam,makeTenantDefault:()=>a.makeTenantDefault});var a=t(2131)},59723:(e,n,t)=>{t.r(n),t.d(n,{TenantManagementConstants:()=>a.TenantManagementConstants});var a=t(2573)},2573:(e,n,t)=>{function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function r(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,s(a.key),a)}}function o(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,n,t){return(n=s(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e){var n=function(e,n){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==a(n)?n:n+""}t.r(n),t.d(n,{TenantManagementConstants:()=>c});var c=o((function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}));i(c,"TENANT_URI_PLACEHOLDER","myorg"),i(c,"EU_PROD_CONSOLE_FALLBACK_URL","https://console.eu.asgardeo.io"),i(c,"US_PROD_CONSOLE_FALLBACK_URL","https://console.asgardeo.io"),i(c,"FORM_FIELD_CONSTRAINTS",{TENANT_NAME_ALPHANUMERIC:new RegExp("^[a-z0-9]+$"),TENANT_NAME_FIRST_ALPHABET:new RegExp("^[a-z]"),TENANT_NAME_MAX_LENGTH:30,TENANT_NAME_MIN_LENGTH:4,TENANT_NAME_PATTERN:new RegExp("^[a-z][a-z0-9]{3,29}$")})},55:(e,n,t)=>{t.r(n),t.d(n,{Region:()=>a});var a=function(e){return e.US="US",e.EU="EU",e}({})},34877:(e,n,t)=>{t.r(n),t.d(n,{default:()=>M});var a=t(93129),r=t(3356),o=t(20812),i=t(86727),s=t(36382),c=t(87692),l=t(67127),m=t(44194),u=t(10479),d=t(47245),E=t(26154),g=t(89141),f=t(95165),T=t(5323),p=t(62508),N=t(12647),_=t(79589),R=t(76881),C=t(65939),v=t(57197),A=t(59723),L=t(55);function h(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,r,o,i,s=[],c=!0,l=!1;try{if(o=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(a=o.call(t)).done)&&(s.push(a.value),s.length!==n);c=!0);}catch(e){l=!0,r=e}finally{try{if(!c&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(l)throw r}}return s}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return b(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return b(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var y=function(e){var n,t,b=e["data-testid"],y=(0,d.I0)(),M=(0,u.$)().t,S=h((0,m.useState)(!1),2),O=S[0],x=S[1],w=h((0,m.useState)(!1),2),U=w[0],I=w[1],Z=h((0,m.useState)(!1),2),P=Z[0],D=Z[1],H=h((0,m.useState)(!1),2),F=H[0],k=H[1],j=h((0,m.useState)(!1),2),z=j[0],Q=j[1],B=h((0,m.useState)(!1),2),K=B[0],G=B[1],X=h((0,m.useState)(),2),$=X[0],q=X[1],V=h((0,m.useState)(A.TenantManagementConstants.TENANT_URI_PLACEHOLDER),2),W=V[0],J=V[1],Y=h((0,m.useState)(),2),ee=Y[0],ne=Y[1],te=(0,d.v9)((function(e){var n;return null===(n=e.config)||void 0===n||null===(n=n.deployment)||void 0===n||null===(n=n.extensions)||void 0===n?void 0:n.deploymentRegion})),ae=(0,d.v9)((function(e){var n;return null===(n=e.config)||void 0===n||null===(n=n.deployment)||void 0===n||null===(n=n.extensions)||void 0===n?void 0:n.regionQualifiedConsoleUrl})),re=(0,d.v9)((function(e){var n;return null===(n=e.config)||void 0===n||null===(n=n.deployment)||void 0===n?void 0:n.tenantPrefix})),oe=(0,m.useMemo)((function(){if(te)return te===L.Region.EU?L.Region.US:L.Region.EU}),[te]),ie=(0,m.useMemo)((function(){if(!ae)return A.TenantManagementConstants.US_PROD_CONSOLE_FALLBACK_URL;if(te===L.Region.US){if(ae.includes("."+L.Region.EU.toLowerCase())&&A.TenantManagementConstants.EU_PROD_CONSOLE_FALLBACK_URL,ae.includes("asgardeo.io")){var e=ae.indexOf("asgardeo.io");return[ae.slice(0,e),"".concat(L.Region.EU.toLowerCase(),"."),ae.slice(e)].join("")}if(ae.includes("asg.io")){var n=ae.indexOf("asg.io");return[ae.slice(0,n),"".concat(L.Region.EU.toLowerCase(),"."),ae.slice(n)].join("")}return A.TenantManagementConstants.EU_PROD_CONSOLE_FALLBACK_URL}return ae.includes("."+L.Region.EU.toLowerCase())?ae.replace(/.eu/g,""):A.TenantManagementConstants.US_PROD_CONSOLE_FALLBACK_URL}),[ae]),se=h((0,i.IK)(),3),ce=se[0],le=se[1],me=se[2],ue=_.lD.getInstance();(0,m.useEffect)((function(){ee&&K&&U&&!O&&(G(!1),fe())}),[ee,K]);var de,Ee=function(e){var n=!!e&&!!e.match(A.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_PATTERN);return n||(k(!1),ge.cancel()),n},ge=(0,m.useCallback)((0,s.Z)((function(e){(0,C.checkDuplicateTenants)(e).then((function(e){200==e.status&&x(!0),k(!1)})).catch((function(e){404==e.response.status&&x(!1),k(!1)}))}),1e3),[]),fe=function(){D(!0),q(M("extensions:manage.features.tenant.wizards.addTenant.forms.loaderMessages.duplicateCheck")),(0,C.checkDuplicateTenants)(null==ee?void 0:ee.tenantName).then((function(e){D(!1),200==e.status&&(x(!0),le({description:M("extensions:manage.features.tenant.wizards.addTenant.forms.fields.tenantName.validations.duplicate",{tenantName:ee.tenantName}),level:a.QU.ERROR,message:M("extensions:manage.features.tenant.notifications.addTenant.genericError.message")}))})).catch((function(e){404==e.response.status?Te(ee.tenantName):(D(!1),le({description:M("extensions:manage.features.tenant.notifications.addTenant.genericError.description"),level:a.QU.ERROR,message:M("extensions:manage.features.tenant.notifications.addTenant.genericError.message")}))}))},Te=function(e){D(!0),q(M("extensions:manage.features.tenant.wizards.addTenant.forms.loaderMessages.tenantCreate")),(0,C.addNewTenant)(e).then((function(n){201===n.status&&(ue.publish("create-new-organization"),y((0,r.V_)({description:M("extensions:manage.features.tenant.notifications.addTenant.success.description",e),level:a.QU.SUCCESS,message:M("extensions:manage.features.tenant.notifications.addTenant.success.message")})),q(M("extensions:manage.features.tenant.wizards.addTenant.forms.loaderMessages.tenantSwitch")),(0,c.Z)((function(){D(!1),(0,R.R)(e)}),5e3))})).catch((function(e){var n,t;D(!1),null!==(n=e.response.data)&&void 0!==n&&n.code&&["TM-10011","TM-10004","TM-10008","TM-10005"].includes(e.response.data.code)?le({description:M("extensions:manage.features.tenant.notifications.missingClaims.description"),level:a.QU.ERROR,message:M("extensions:manage.features.tenant.notifications.missingClaims.message")}):null!==(t=e.response.data)&&void 0!==t&&t.code&&["TM-10013"].includes(e.response.data.code)?le({description:M("extensions:manage.features.tenant.notifications.addTenant.limitReachError.description"),level:a.QU.ERROR,message:M("extensions:manage.features.tenant.notifications.addTenant.limitReachError.message")}):le({description:M("extensions:manage.features.tenant.notifications.addTenant.genericError.description"),level:a.QU.ERROR,message:M("extensions:manage.features.tenant.notifications.addTenant.genericError.message")})}))};return m.createElement(i.Xg,{padded:!1,contentTopMargin:!1,className:"tenant-creation-page pt-5"},m.createElement(g.Z,{centered:!0,className:"tenant-form-container"},m.createElement(g.Z.Column,{mobile:16,tablet:16,computer:6,largeScreen:6,widescreen:6},m.createElement(i.dn,{transparent:!0,className:"onboard-apps-animated-illustration",size:"tiny",width:50,colored:!0,icon:(0,v.TenantCreationIcons)().asgardeoLogo}),m.createElement(f.Z,{fluid:!0,centered:!0,className:"basic-card no-hover"},m.createElement(f.Z.Content,{className:"p-5"},ce&&me,m.createElement(g.Z,{centered:!0},m.createElement(g.Z.Row,null,m.createElement("div",{className:"card-heading"},m.createElement(i.X6,{as:"h2"},M("extensions:manage.features.tenant.tenantCreationPrompt.heading")))),m.createElement(g.Z.Row,null,m.createElement("div",null,m.createElement(i.xv,{muted:!0,display:"inline"},M("extensions:manage.features.tenant.tenantCreationPrompt.subHeading1")),m.createElement(i.xv,{display:"inline"},m.createElement(T.Z,{name:null===(n=String(te))||void 0===n?void 0:n.toLowerCase()}),te," "),m.createElement(i.xv,{muted:!0,display:"inline"},M("extensions:manage.features.tenant.tenantCreationPrompt.subHeading7")),m.createElement(p.Z,{hidden:!0,fitted:!0}),m.createElement(i.xv,{muted:!0,display:"inline"},M("extensions:manage.features.tenant.tenantCreationPrompt.subHeading4")),m.createElement(p.Z,{hidden:!0,fitted:!0}),m.createElement(i.xv,{muted:!0,display:"inline"},M("extensions:manage.features.tenant.tenantCreationPrompt.subHeading5")),m.createElement(i.rU,{link:ie},M("extensions:manage.features.tenant.tenantCreationPrompt.subHeading2")),m.createElement(i.xv,{muted:!0,display:"inline"},M("extensions:manage.features.tenant.tenantCreationPrompt.subHeading6")),m.createElement(i.xv,{display:"inline"},m.createElement(T.Z,{name:null===(t=String(oe))||void 0===t?void 0:t.toLowerCase()}),oe," "),m.createElement(i.xv,{muted:!0,display:"inline"},M("extensions:manage.features.tenant.tenantCreationPrompt.subHeading7"))))),m.createElement(o.l0,{id:"create-tenant-form",onSubmit:function(e){ne(e)},triggerSubmit:function(e){de=e},uncontrolledForm:!1},m.createElement(o.gN.Input,{className:z||W===A.TenantManagementConstants.TENANT_URI_PLACEHOLDER||U&&!O?"":"error",ariaLabel:"Tenant Name",inputType:"resource_name",name:"tenantName",label:M("extensions:manage.features.tenant.wizards.addTenant.forms.fields.tenantName.label"),placeholder:M("extensions:manage.features.tenant.wizards.addTenant.forms.fields.tenantName.placeholder"),required:!0,listen:function(e){return n=e,x(!1),void((0,l.Z)(n)?(J(A.TenantManagementConstants.TENANT_URI_PLACEHOLDER),I(!1)):(J(n),I(Ee(n))));var n},maxLength:A.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MAX_LENGTH,minLength:A.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MIN_LENGTH,validation:function(e){Ee(e.toString())&&(k(!0),ge(e.toString()))},width:16,onBlur:function(){return Q(!1)},onFocus:function(){return Q(!0)},"data-testid":"".concat(b,"-type-input")})),F?m.createElement(i.xv,{className:"tenant-uri-prefix"},"".concat(null!=ae?ae:"https://console.asgardeo.io","/").concat(null!=re?re:"t","/"),m.createElement(E.Z,{name:"circle notched",color:"grey",loading:!0})):m.createElement("span",null,"".concat(null!=ae?ae:"https://console.asgardeo.io","/").concat(null!=re?re:"t","/"),m.createElement("span",{className:"".concat(W!==A.TenantManagementConstants.TENANT_URI_PLACEHOLDER?U&&!O?"valid-tenant placeholder-uri-bold":"invalid-tenant placeholder-uri-bold":W==A.TenantManagementConstants.TENANT_URI_PLACEHOLDER?U&&!O?"valid-tenant placeholder-uri-bold":"placeholder-uri":void 0)},W,m.createElement(i.kW,{icon:"info circle",popup:!0},M("extensions:manage.features.tenant.wizards.addTenant.tooltips.message")))),m.createElement(g.Z,{className:"m-0 pt-2"},m.createElement(g.Z.Row,{className:"p-0"},W===A.TenantManagementConstants.TENANT_URI_PLACEHOLDER?m.createElement(E.Z,{name:"circle",color:"grey"}):W.match(A.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_FIRST_ALPHABET)?m.createElement(E.Z,{name:"check circle",color:"green"}):z?m.createElement(E.Z,{name:"circle",color:"grey"}):m.createElement(E.Z,{name:"remove circle",color:"red"}),m.createElement(i.xv,{muted:!0},"Must begin with an alphabet character")),m.createElement(g.Z.Row,{className:"p-0"},W===A.TenantManagementConstants.TENANT_URI_PLACEHOLDER?m.createElement(E.Z,{name:"circle",color:"grey"}):W.length>=A.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MIN_LENGTH&&W.length<A.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MAX_LENGTH?m.createElement(E.Z,{name:"check circle",color:"green"}):z?m.createElement(E.Z,{name:"circle",color:"grey"}):m.createElement(E.Z,{name:"remove circle",color:"red"}),m.createElement(i.xv,{muted:!0},"More than 4 characters, Less than 30 characters")),m.createElement(g.Z.Row,{className:"p-0"},W===A.TenantManagementConstants.TENANT_URI_PLACEHOLDER?m.createElement(E.Z,{name:"circle",color:"grey"}):W.match(A.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_ALPHANUMERIC)?m.createElement(E.Z,{name:"check circle",color:"green"}):z?m.createElement(E.Z,{name:"circle",color:"grey"}):m.createElement(E.Z,{name:"remove circle",color:"red"}),m.createElement(i.xv,{muted:!0},"Only consist of lowercase alphanumerics")),m.createElement(g.Z.Row,{className:"p-0"},W===A.TenantManagementConstants.TENANT_URI_PLACEHOLDER?m.createElement(E.Z,{name:"circle",color:"grey"}):!U||F||O?z?m.createElement(E.Z,{name:"circle",color:"grey"}):m.createElement(E.Z,{name:"remove circle",color:"red"}):m.createElement(E.Z,{name:"check circle",color:"green"}),m.createElement(i.xv,{muted:!0},"Must be unique"))),P&&m.createElement(i.pO,{text:$})),m.createElement(f.Z.Content,null,m.createElement(g.Z,{className:"pr-5 pl-5"},m.createElement(g.Z.Row,{column:1},m.createElement(g.Z.Column,{mobile:8,tablet:8,computer:8},m.createElement(i.Qj,{floated:"left",onClick:function(){ue.publish("console-click-logout"),N.m.push(window.AppUtils.getConfig().routes.logout)},disabled:P,"data-testid":"".concat(b,"-cancel-button")},M("common:logout"))),m.createElement(g.Z.Column,{mobile:8,tablet:8,computer:8},m.createElement(i.KM,{floated:"right",onClick:function(){de(),G(!0)},loading:P,"data-testid":"".concat(b,"-create-button"),disabled:P||F},M("common:create"))))))))))};y.defaultProps={"data-testid":"create-tenant-page"};const M=y}}]);