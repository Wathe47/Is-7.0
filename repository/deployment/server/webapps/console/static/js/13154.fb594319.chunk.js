"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[13154,28268,22370],{6890:(e,t,n)=>{n.d(t,{H:()=>p});var i=n(17493);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function a(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}var c,l,u,p=a((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}));c=p,u=function(e){return e===i.K.CHOREO_GW_NAME},(l=r(l="checkIfAPIResourceManagedByChoreo"))in c?Object.defineProperty(c,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):c[l]=u},18660:(e,t,n)=>{n.r(t),n.d(t,{APIAuthorization:()=>z});var i=n(54833),o=n(93129),s=n(3356),a=n(86727),r=n(44194),c=n(10479),l=n(59673),u=n(47245),p=n(89141),d=n(26154),m=n(62508),f=n(13154),h=n(22370),b=n(24393),v=n(7553),A=n(14200),S=n(6890),E=n(98621);function g(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||R(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,s,a,r=[],c=!0,l=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=s.call(n)).done)&&(r.push(i.value),r.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return r}}(e,t)||R(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var z=function(e){var t=e.isChoreoApp,n=e["data-componentid"],R=(0,c.$)().t,I=(0,u.I0)(),z=(0,a.fQ)().getLink,P=y((0,r.useState)(!1),2),x=P[0],C=P[1],w=y((0,r.useState)(!1),2),O=w[0],Z=w[1],U=y((0,r.useState)(null),2),_=U[0],k=U[1],N=y((0,r.useState)(!1),2),T=N[0],j=N[1],F=y((0,r.useState)(!1),2),H=F[0],V=F[1],D=y((0,r.useState)(!1),2),Q=D[0],K=D[1],L=y((0,r.useState)([]),2),M=L[0],$=L[1],J=y((0,r.useState)(!1),2),W=J[0],B=J[1],q=y((0,r.useState)(!0),2),X=q[0],G=q[1],Y=y((0,r.useState)(!1),2),ee=Y[0],te=Y[1],ne=y((0,r.useState)([]),2),ie=ne[0],oe=ne[1],se=(0,u.v9)((function(e){return e.config.ui.features})),ae=(0,u.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.allowedScopes})),re=b.m8.location.pathname.split("/"),ce=re[re.length-1].split("#")[0],le=["gwName","permissions"],ue=(0,v.cQ)(),pe=ue.data,de=ue.isLoading,me=ue.error,fe=ue.mutate,he=(0,E.useSubscribedAPIResources)(ce),be=he.data,ve=he.isLoading,Ae=he.isValidating,Se=he.error,Ee=he.mutate,ge=!!Se||!!me||0===(null==pe?void 0:pe.apiResources.length)||0===(null==ie?void 0:ie.length);(0,r.useEffect)((function(){!Ae&&(null==be?void 0:be.length)>0?function(){te(!0);var e=be.map((function(e){return e.apiId}));(0,E.searchAPIResources)(e,le).then((function(e){var t=be.map((function(t){var n=e.find((function(e){return e.id===t.apiId}));return t.isChoreoAPI=S.H.checkIfAPIResourceManagedByChoreo(null==n?void 0:n.gwName),t.allPermissions=null==n?void 0:n.permissions,t}));oe(t)})).catch((function(){I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.genericError.description"),level:o.QU.ERROR,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.genericError.message")}))})).finally((function(){te(!1)}))}():oe(be||[])}),[be]),(0,r.useEffect)((function(){var e;if((me||Se)&&(G(!0),!O))if(Z(!0),(null===(e=(me||Se).response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.code)===A.K.UNAUTHORIZED_ACCESS)I((0,s.V_)({description:R("extensions:develop.apiResource.notifications.getAPIResources.unauthorizedError.description"),level:o.QU.ERROR,message:R("extensions:develop.apiResource.notifications.getAPIResources.unauthorizedError.message")}));else I((0,s.V_)({description:R("extensions:develop.apiResource.notifications.getAPIResources.genericError.description"),level:o.QU.ERROR,message:R("extensions:develop.apiResource.notifications.getAPIResources.genericError.message")}))}),[me,Se]),(0,r.useEffect)((function(){C(Q||de||ve||ee)}),[Q,de,ve,ee]),(0,r.useEffect)((function(){if((null==ie?void 0:ie.length)>0){var e=[];ie.forEach((function(t){e=e.concat(t.permissions)})),$(e)}}),[ie]),(0,r.useEffect)((function(){Q&&(fe(),Ee(),K(!1))}),[Q]),(0,r.useEffect)((function(){var e;pe&&ie&&B((null===(e=pe.apiResources)||void 0===e?void 0:e.length)===ie.length)}),[pe,ie]);var ye=function(){var e;return(0,i.Xr)(null==se?void 0:se.applications,null==se||null===(e=se.applications)||void 0===e||null===(e=e.scopes)||void 0===e?void 0:e.update,ae)};(0,r.useEffect)((function(){var e,t=!ye()||0===(null==pe||null===(e=pe.apiResources)||void 0===e?void 0:e.length)||0===(null==ie?void 0:ie.length);G(t)}),[se,pe,ie]);return r.createElement(r.Fragment,null,r.createElement(a.pJ,{padded:"very",loading:x,"data-componentid":"".concat(n,"-sub-api-resources-section")},r.createElement(p.Z,null,r.createElement(p.Z.Row,null,r.createElement(p.Z.Column,{className:"heading-wrapper",computer:8,mobile:10},r.createElement(a.X6,{as:"h4"},R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.heading")),r.createElement(a.X6,{subHeading:!0,ellipsis:!0,as:"h6"},R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.subHeading"),r.createElement(a.eb,{link:z("develop.applications.apiAuthorization.learnMore")},R("extensions:common.learnMore")))),r.createElement(p.Z.Column,{computer:4,mobile:6},!X&&r.createElement(a.GI,{content:W?R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.allAPIAuthorizedPopOver"):null,position:"top center",disabled:!W,trigger:r.createElement("span",null,r.createElement(a.KM,{"data-componentid":"subscribed-api-resources-subcribe-api-resource-button",size:"medium",floated:"right",onClick:function(){return V(!0)},disabled:W},r.createElement(d.Z,{name:"add"}),R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.buttons.subAPIResource")))})))),r.createElement(m.Z,{hidden:!0}),r.createElement(f.SubscribedAPIResources,{appId:ce,allAPIResourcesListData:null==pe?void 0:pe.apiResources,allAPIResourcesFetchRequestError:me,allAuthorizedScopes:M,subscribedAPIResourcesListData:ie,subscribedAPIResourcesFetchRequestError:Se,isChoreoApp:t,isScopesAvailableForUpdate:ye(),isShownPlaceholder:ge,setRemoveSubscribedAPIResource:k,bulkChangeAllAuthorizedScopes:function(e,t){if(t)$(M.filter((function(t){return!e.some((function(e){return e.name===t.name}))})));else{var n=e.filter((function(e){return!M.some((function(t){return e.name===t.name}))}));$([].concat(g(M),g(n)))}},setIsAuthorizeAPIResourceWizardOpen:V})),_&&r.createElement(a.cV,{primaryActionLoading:T,open:null!==_,onClose:function(){return k(null)},type:"negative",assertionHint:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.confirmations.unsubscribeAPIResource.assertionHint"),assertionType:"checkbox",primaryAction:R("common:confirm"),secondaryAction:R("common:cancel"),onSecondaryActionClick:function(){return k(null)},onPrimaryActionClick:function(){return j(!0),void(0,E.unsubscribeAPIResources)(ce,null==_?void 0:_.apiId).then((function(){I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.success.description"),level:o.QU.SUCCESS,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.success.message")})),j(!1),K(!0)})).catch((function(e){switch(null==e?void 0:e.code){case A.K.UNAUTHORIZED_ACCESS:I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.unauthorizedError.description"),level:o.QU.ERROR,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.unauthorizedError.message")}));break;case A.K.NO_VALID_API_RESOURCE_ID_FOUND:case A.K.API_RESOURCE_NOT_FOUND:I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.notFoundError.description"),level:o.QU.ERROR,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.notFoundError.message")}));break;default:I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.genericError.description"),level:o.QU.ERROR,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.genericError.message")}))}})).finally((function(){j(!1),k(null)}))},"data-componentid":"".concat(n,"-delete-confirmation-modal"),closeOnDimmerClick:!1},r.createElement(a.cV.Header,{"data-componentid":"".concat(n,"-delete-confirmation-modal-header")},R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.confirmations.unsubscribeAPIResource.header")),r.createElement(a.cV.Message,{attached:!0,negative:!0,"data-componentid":"".concat(n,"-delete-confirmation-modal-message")},R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.confirmations.unsubscribeAPIResource.message")),r.createElement(a.cV.Content,{"data-componentid":"".concat(n,"-delete-confirmation-modal-content")},t&&_.isChoreoAPI?r.createElement(l.c,{i18nKey:"extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.confirmations.unsubscribeChoreoAPIResource.content"},"Unsubscribing this API resource will not be reflected on the Choreo end, but will impact/affect the user authorization as the authorized scopes will no longer be accessible. ",r.createElement("b",null,"Proceed with caution.")):R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.confirmations.unsubscribeAPIResource.content"))),H&&r.createElement(h.AuthorizeAPIResource,{subscribedAPIResourcesListData:ie,closeWizard:function(){return V(!1)},handleCreateAPIResource:function(e,t,n,i){(0,E.createAuthorizedAPIResource)(ce,e,t,n).then((function(){I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.success.description"),level:o.QU.SUCCESS,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.success.message")})),K(!0),V(!1)})).catch((function(e){switch(null==e?void 0:e.code){case A.K.UNAUTHORIZED_ACCESS:I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.unauthorizedError.description"),level:o.QU.ERROR,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.unauthorizedError.message")}));break;case A.K.NO_VALID_API_RESOURCE_ID_FOUND:case A.K.API_RESOURCE_NOT_FOUND:I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.notFoundError.description"),level:o.QU.ERROR,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.notFoundError.message")}));break;default:I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.genericError.description"),level:o.QU.ERROR,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.genericError.message")}))}})).finally((function(){j(!1),i&&i()}))}}))};z.defaultProps={"data-componentid":"api-authorization-tab"}},13154:(e,t,n)=>{n.r(t),n.d(t,{APIAuthorization:()=>i.APIAuthorization,ScopeForm:()=>s.ScopeForm,SubscribedAPIResources:()=>o.SubscribedAPIResources});var i=n(18660),o=n(80331),s=n(28268)},28268:(e,t,n)=>{n.r(t),n.d(t,{ScopeForm:()=>E});var i=n(95817),o=n(93129),s=n(3356),a=n(86727),r=n(44194),c=n(10479),l=n(47245),u=n(12638),p=n(89141),d=n(77757),m=n(33040),f=n(14200),h=n(98621);function b(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||A(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,s,a,r=[],c=!0,l=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=s.call(n)).done)&&(r.push(i.value),r.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return r}}(e,t)||A(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var E=function(e){var t=e.appId,n=e.subscribedAPIResource,A=e.isScopesAvailableForUpdate,S=e.bulkChangeAllAuthorizedScopes,E=e["data-componentid"],g=(0,c.$)().t,y=(0,l.I0)(),R=v((0,r.useState)(!1),2),I=R[0],z=R[1],P=v((0,r.useState)(!0),2),x=P[0],C=P[1],w=v((0,r.useState)(null),2),O=w[0],Z=w[1],U=v((0,r.useState)(null),2),_=U[0],k=U[1],N=v((0,r.useState)(n.permissions),2),T=N[0],j=N[1],F=v((0,r.useState)(null),2),H=F[0],V=F[1],D=v((0,r.useState)([]),2),Q=D[0],K=D[1],L=v((0,r.useState)([]),2),M=L[0],$=L[1],J=v((0,r.useState)(!1),2),W=J[0],B=J[1],q=v((0,r.useState)(!1),2),X=q[0],G=q[1],Y=I||null===O||null===_||null===H;(0,r.useEffect)((function(){var e,t=[];null===(e=n.allPermissions)||void 0===e||e.forEach((function(e){t.push({content:r.createElement(u.Z,{as:"h6",className:"header-with-icon","data-componentId":"".concat(E,"-heading")},r.createElement(u.Z.Content,null,e.displayName,r.createElement(u.Z.Subheader,null,r.createElement(a.EK,{withBackground:!0},e.name)))),key:e.name,text:e.displayName,value:e.name})})),Z(t)}),[n]),(0,r.useEffect)((function(){var e=[];n.permissions.forEach((function(t){e.push(t.name)})),k(e),V(e)}),[n]),(0,r.useEffect)((function(){var e;B((null===(e=n.allPermissions)||void 0===e?void 0:e.length)===(null==H?void 0:H.length))}),[H,n]),(0,r.useEffect)((function(){G(0===(null==H?void 0:H.length))}),[H]);var ee=function(e,t){var n=e.map((function(e){return e.name}));t?(0!==(null==_?void 0:_.toString().length)?C(!1):C(!0),j([]),V([]),$(_),K([])):(_.toString()!==n.toString()?C(!1):C(!0),j(e),V(n),K(n.filter((function(e){return!_.includes(e)}))),$([]))};return r.createElement(a.pJ,{padded:"very"},Y?null===H||null===O||null===_||I?r.createElement(a.pO,{inline:"centered",active:!0}):null:r.createElement(p.Z,null,r.createElement(p.Z.Row,{columns:1},r.createElement(p.Z.Column,null,r.createElement(d.Z,null,r.createElement(d.Z.Field,null,r.createElement(p.Z,null,r.createElement(p.Z.Row,{columns:2},r.createElement(p.Z.Column,{className:"pb-1",floated:"left",stretched:!0,verticalAlign:"bottom"},r.createElement("label",null,g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.scopesSection.label"))),r.createElement(p.Z.Column,{floated:"right",textAlign:"right"},A&&r.createElement(a.xv,{className:"mb-0",muted:!0,subHeading:!0,size:12},r.createElement(i.Z,{variant:"text",size:"small",tabIndex:6,disabled:W,onClick:function(){return ee(n.allPermissions?n.allPermissions:[],!1)}},g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.scopesSection.selectAll")),"|",r.createElement(i.Z,{variant:"text",size:"small",tabIndex:7,disabled:X,onClick:function(){return ee(n.allPermissions?n.allPermissions:[],!0)}},g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.scopesSection.selectNone")))))),r.createElement(m.Z,{placeholder:g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.scopesSection.placeholder"),fluid:!0,multiple:!0,search:!0,selection:!0,options:O||[],defaultValue:_,value:H,onChange:function(e,t){var i=t.value;if(V(i),i.toString()!==_.toString()?C(!1):C(!0),i.length>=T.length){var o,s=null===(o=n.allPermissions)||void 0===o?void 0:o.find((function(e){return e.name===i[i.length-1]}));s&&j([].concat(b(T),[s])),_.includes(s.name)||K([].concat(b(Q),[s.name])),M.includes(s.name)&&$(M.filter((function(e){return e!==s.name})))}else{var a=null==T?void 0:T.filter((function(e){return!i.includes(e.name)}))[0];a&&j(T.filter((function(e){return e.name!==a.name}))),_.includes(a.name)&&$([].concat(b(M),[a.name])),Q.includes(a.name)&&K(Q.filter((function(e){return e!==a.name})))}},disabled:!A}),r.createElement(a.kW,null,g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.scopesSection.hint")))))),A&&r.createElement(p.Z.Row,null,r.createElement(p.Z.Column,{floated:"left"},r.createElement(a.Qj,{size:"small",floated:"left",tabIndex:8,onClick:function(){V(_),j(n.permissions),K([]),$([]),C(!0)},"data-componentid":"".concat(E,"-cancel-btn"),disabled:x},g("common:cancel")),r.createElement(a.KM,{size:"small",floated:"right",tabIndex:9,onClick:function(){z(!0),(0,h.patchScopesOfAPIResource)(t,null==n?void 0:n.apiId,Q,M).then((function(){var e,t;y((0,s.V_)({description:g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.patchScopes.success.description"),level:o.QU.SUCCESS,message:g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.patchScopes.success.message")}));var i=null===(e=n.allPermissions)||void 0===e?void 0:e.map((function(e){if(Q.includes(e.name))return e})).filter((function(e){return void 0!==e})),a=null===(t=n.allPermissions)||void 0===t?void 0:t.map((function(e){if(M.includes(e.name))return e})).filter((function(e){return void 0!==e}));0!==(null==i?void 0:i.length)&&S(i,!1),0!==(null==a?void 0:a.length)&&S(a,!0),K([]),$([]),k(H),C(!0)})).catch((function(e){if((null==e?void 0:e.code)===f.K.UNAUTHORIZED_ACCESS)y((0,s.V_)({description:g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.patchScopes.unauthorizedError.description"),level:o.QU.ERROR,message:g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.patchScopes.unauthorizedError.message")}));else y((0,s.V_)({description:g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.patchScopes.genericError.description"),level:o.QU.ERROR,message:g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.patchScopes.genericError.message")}))})).finally((function(){return z(!1)}))},"data-componentid":"".concat(E,"-update-btn"),disabled:x},g("extensions:develop.applications.edit.sections.apiAuthorization.sections.policySection.buttons.update"))))))};E.defaultProps={"data-componentid":"permission-form"}},80331:(e,t,n)=>{n.r(t),n.d(t,{SubscribedAPIResources:()=>g});var i=n(73150),o=n(90960),s=n(86727),a=n(24393),r=n(44194),c=n(10479),l=n(59673),u=n(26154),p=n(12638),d=n(89141),m=n(37077),f=n(12950),h=n(77757),b=n(13154),v=n(14200),A=n(157);function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,s,a,r=[],c=!0,l=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=s.call(n)).done)&&(r.push(i.value),r.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return r}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var g=function(e){var t=e.appId,n=e.allAPIResourcesListData,E=e.allAPIResourcesFetchRequestError,g=e.allAuthorizedScopes,y=e.subscribedAPIResourcesListData,R=e.subscribedAPIResourcesFetchRequestError,I=e.isScopesAvailableForUpdate,z=e.isChoreoApp,P=e.setRemoveSubscribedAPIResource,x=e.bulkChangeAllAuthorizedScopes,C=e.setIsAuthorizeAPIResourceWizardOpen,w=e["data-componentid"],O=0===(null==n?void 0:n.length)||0===(null==y?void 0:y.length)||null!=E||null!=R,Z=(0,c.$)().t,U=S((0,r.useState)(null),2),_=U[0],k=U[1],N=S((0,r.useState)(null),2),T=N[0],j=N[1],F=S((0,r.useState)(null),2),H=F[0],V=F[1],D=S((0,r.useState)(null),2),Q=D[0],K=D[1];(0,r.useEffect)((function(){y&&V(y)}),[y]),(0,r.useEffect)((function(){g&&K(g.map((function(e){return e.name})).join(" "))}),[g]);var L=function(){return a.m8.push(v.K.getPaths().get("API_RESOURCES"))},M=function(){return E||R?r.createElement(s.$J,{image:(0,a.jF)().genericError,imageSize:"tiny",title:Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.errorText.title"),subtitle:[Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.errorText.subtitles.1"),Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.errorText.subtitles.0")],"data-componentid":"".concat(w,"-all-empty-placeholder-icon")}):n&&0===n.length?r.createElement(s.$J,{image:(0,a.jF)().emptySearch,action:I&&r.createElement(s.rU,{"data-componentid":"".concat(w,"-link-api-resource-page"),onClick:L,external:!1},Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.buttons.noAPIResourcesLink")),imageSize:"tiny",subtitle:[Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.noAPIResources")],"data-componentid":"".concat(w,"-sub-empty-placeholder-icon")}):y&&0===y.length?r.createElement(s.$J,{image:(0,a.jF)().emptyList,action:I&&r.createElement(s.KM,{"data-componentid":"".concat(w,"-empty-placeholder-sub-api-resource-button"),onClick:function(){return C(!0)}},r.createElement(u.Z,{name:"add"}),Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.buttons.subAPIResource")),imageSize:"tiny",subtitle:[Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.emptyText")],"data-componentid":"".concat(w,"-sub-empty-placeholder-icon")}):0===(null==H?void 0:H.length)?r.createElement(s.$J,{title:Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.emptySearch.title"),subtitle:[Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.emptySearch.subTitle.0"),Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.emptySearch.subTitle.1")],image:(0,a.jF)().emptySearch,action:r.createElement(s.Qj,{onClick:B},Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.buttons.emptySearchButton")),imageSize:"tiny"}):null},$=function(e){return r.createElement(p.Z,{as:"h6",className:"header-with-icon","data-componentId":"".concat(w,"-heading")},r.createElement(d.Z,{verticalAlign:"middle"},r.createElement(d.Z.Row,null,r.createElement(d.Z.Column,{width:8},r.createElement(p.Z.Content,null,r.createElement(d.Z,{verticalAlign:"middle"},r.createElement(d.Z.Row,null,r.createElement(d.Z.Column,{width:16},e.apiDisplayName,e.isChoreoAPI&&r.createElement(m.Z,{size:"mini",className:"choreo-label"},Z("extensions:develop.apiResource.managedByChoreoText"))))),r.createElement(p.Z.Subheader,{className:"mt-1"},e.apiIdentifier?r.createElement(s.EK,{withBackground:!0},e.apiIdentifier):null))),r.createElement(d.Z.Column,{width:8},e.apiIdentifier?r.createElement(p.Z.Subheader,null,function(e){switch(e){case A.Policy.ROLE:return o.I18n.instance.t("extensions:develop.applications.edit.sections.apiAuthorization.sections.policySection.form.fields.rbac.name");case A.Policy.NO:default:return o.I18n.instance.t("extensions:develop.applications.edit.sections.apiAuthorization.sections.policySection.form.fields.noPolicy.name")}}(e.policyIdentifier)):null))))},J=function(e){return[{disabled:!I,icon:"trash alternate",onClick:function(){return P(e)},popoverText:Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.unsubscribeAPIResourcePopOver"),type:"icon"}]},W=function(e){return r.createElement(r.Fragment,null,z&&e.isChoreoAPI&&r.createElement(i.Z,{severity:"warning"},r.createElement(l.c,{i18nKey:"extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.choreoApiEditWarning"},"Updating the authorized scopes will create unforeseen errors as this is an API resource managed by Choreo. ",r.createElement("b",null,"Proceed with caution."))),r.createElement(b.ScopeForm,{appId:t,subscribedAPIResource:e,isScopesAvailableForUpdate:I,bulkChangeAllAuthorizedScopes:x}))},B=function(){j(""),V(y)};return O?r.createElement(s.pJ,null,M()):r.createElement(d.Z,{className:"mt-3"},r.createElement(d.Z.Row,{columns:1},r.createElement(d.Z.Column,{mobile:16,tablet:16,computer:12},r.createElement(s.PS,{showTopActionPanel:!0,showPagination:!1,onPageChange:function(){return null},totalPages:100,"data-componentid":"".concat(w,"-list-layout"),totalListSize:null==y?void 0:y.length,leftActionPanel:r.createElement("div",{className:"advanced-search-wrapper aligned-left fill-default"},r.createElement(f.Z,{className:"advanced-search with-add-on","data-componentid":"".concat(w,"-list-search-input"),icon:"search",iconPosition:"left",onChange:function(e){var t=e.target.value;j(t),t.length>0?V(null==y?void 0:y.filter((function(e){return e.apiDisplayName.toLowerCase().includes(t.toLowerCase())}))):V(y)},placeholder:Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.search"),floated:"right",size:"small",value:T}))},0!==(null==H?void 0:H.length)?r.createElement(s.el,{"data-componentid":"".concat(w,"-subscribed-api-resources"),viewType:"table-view"},null==H?void 0:H.map((function(e){return r.createElement(r.Fragment,{key:e.apiId},r.createElement(s.el.Title,{id:e.apiId,"data-componentid":"".concat(w,"-title"),active:_===e.apiId,accordionIndex:e.apiId,onClick:function(){return function(e){_===e.apiId?k(null):k(e.apiId)}(e)},content:$(e),hideChevron:!1,actions:J(e)}),r.createElement(s.el.Content,{active:_===e.apiId,"data-componentid":"".concat(w,"-").concat(e.apiId,"\n                                                                                    -content"),children:W(e)}))}))):M()))),Q&&r.createElement(d.Z.Row,{className:"mt-2"},r.createElement(d.Z.Column,{mobile:16,tablet:16,computer:12},r.createElement(d.Z.Row,null,r.createElement(h.Z,null,r.createElement(h.Z.Field,null,r.createElement(s.OR,{className:"copy-input spaced",value:Q,"data-componentid":"".concat(w,"-selected-scope-area")}),r.createElement(s.kW,null,Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.scopesSection.copyScopesHint"))))))))};g.defaultProps={"data-componentid":"subscribed-api-resources"}},22370:(e,t,n)=>{n.r(t),n.d(t,{AuthorizeAPIResource:()=>i.AuthorizeAPIResource});var i=n(80943)}}]);