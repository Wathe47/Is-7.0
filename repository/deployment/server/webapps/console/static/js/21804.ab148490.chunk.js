"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[21804],{21804:(e,n,t)=>{t.r(n),t.d(n,{default:()=>N});var o=t(54833),r=t(93129),i=t(3356),a=t(20812),l=t(86727),c=t(86375),s=t(67127),u=t(44194),d=t(10479),p=t(47245),m=t(24393),v=t(57550),f=t(45909);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function g(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?g(Object(t),!0).forEach((function(n){C(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function C(e,n,t){var o;return o=function(e,n){if("object"!=b(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,n||"default");if("object"!=b(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(n,"string"),(n="symbol"==b(o)?o:o+"")in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function O(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,r,i,a,l=[],c=!0,s=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(o=i.call(t)).done)&&(l.push(o.value),l.length!==n);c=!0);}catch(e){s=!0,r=e}finally{try{if(!c&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(s)throw r}}return l}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return h(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return h(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}var E=function(e){var n=e["data-componentid"],t=(0,d.$)().t,b=(0,p.I0)(),g="governance-connectors-attribute-verification-form",h="Attribute Verification Settings",E=c.v.USER_CLAIM_UPDATE_CONNECTOR_ID,N=c.v.OTHER_SETTINGS_CONNECTOR_CATEGORY_ID,U="UserClaimUpdate.Email.VerificationCode.ExpiryTime",P="UserClaimUpdate.Email.EnableNotification",S="UserClaimUpdate.Email.EnableVerification",L="UserClaimUpdate.MobileNumber.EnableVerification",T="UserClaimUpdate.MobileNumber.EnableVerificationByPrivilegedUser",w=["UserClaimUpdate.OTP.UseLowercaseCharactersInOTP","UserClaimUpdate.OTP.UseNumbersInOTP","UserClaimUpdate.OTP.UseUppercaseCharactersInOTP","UserClaimUpdate.MobileNumber.VerificationCode.ExpiryTime","UserClaimUpdate.OTP.OTPLength","UserClaimUpdate.OTP.SendOTPInEmail"],j=O((0,u.useState)(void 0),2),I=j[0],_=j[1],R=O((0,u.useState)(void 0),2),V=R[0],F=R[1],A=O((0,u.useState)(void 0),2),k=A[0],x=A[1],D=O((0,u.useState)(!1),2),M=D[0],Q=D[1],B=O((0,u.useState)(!1),2),$=B[0],G=B[1],H=O((0,u.useState)(!1),2),J=H[0],X=H[1],q=(0,p.v9)((function(e){var n;return null==e||null===(n=e.auth)||void 0===n?void 0:n.allowedScopes})),z=(0,p.v9)((function(e){return e.config.ui.features})),Y=(0,u.useMemo)((function(){var e;return!(0,o.Xr)(null==z?void 0:z.governanceConnectors,null==z||null===(e=z.governanceConnectors)||void 0===e||null===(e=e.scopes)||void 0===e?void 0:e.update,q)}),[z,q]);(0,u.useEffect)((function(){Q(!0),I||(Z(),Q(!1))}),[I]),(0,u.useEffect)((function(){J&&(W(V),Q(!1))}),[V]);var Z=function(){(0,v.PP)(N,E).then((function(e){_(e),K(e)})).catch((function(e){e.response&&e.response.data&&e.response.data.detail?b((0,i.V_)({description:t("governanceConnectors:notifications.getConnector.error.description",{description:e.response.data.description}),level:r.QU.ERROR,message:t("governanceConnectors:notifications.getConnector.error.message")})):b((0,i.V_)({description:t("governanceConnectors:notifications.getConnector.genericError.description"),level:r.QU.ERROR,message:t("governanceConnectors:notifications.getConnector.genericError.message")}))})).finally((function(){X(!0),Q(!1)}))},K=function(e){var n;if(!(0,s.Z)(null==e?void 0:e.properties)){var t=null,o=null;null===(n=e.properties)||void 0===n||n.map((function(e){w.includes(e.name)||(t=y(y({},t),{},C({},e.name,JSON.parse(e.value))),o=y(y({},o),{},C({},e.name,C(C({},"description",e.description),"displayName",e.displayName))))})),F(t),x(o)}},W=function(e){var n={operation:"UPDATE",properties:[]};for(var o in e)w.includes(o)||n.properties.push({name:o,value:e[o]});G(!0),(0,v.u9)(n,N,E).then((function(){b((0,i.V_)({description:t("extensions:manage.accountLogin.alternativeLoginIdentifierPage.notification.success.description"),level:r.QU.SUCCESS,message:t("governanceConnectors:notifications.updateConnector.success.message")}))})).catch((function(e){!function(e){e.response&&e.response.data&&e.response.data.detail?b((0,i.V_)({description:t("extensions:manage.accountLogin.alternativeLoginIdentifierPage.notification.error.description"),level:r.QU.ERROR,message:t("governanceConnectors:notifications.updateConnector.error.message")})):b((0,i.V_)({description:t("governanceConnectors:notifications.updateConnector.genericError.description"),level:r.QU.ERROR,message:t("governanceConnectors:notifications.updateConnector.genericError.message")}))}(e)})).finally((function(){G(!1),Q(!1)}))},ee=function(){var e,o,r,i,l,c,s,d,p,m,v,b,O,E,N;return u.createElement(a.l0,{id:g,uncontrolledForm:!0,initialValues:V,onSubmit:function(e){return n=function(e){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n=y(y({},n),{},C({},f.e.decodeConnectorPropertyName(t),e[t])));return n}(e),void F((function(e){return y(y({},e),n)}));var n}},u.createElement(a.gN.Checkbox,{ariaLabel:f.e.resolveFieldLabel(h,S,null==k||null===(e=k[S])||void 0===e?void 0:e.displayName),name:f.e.encodeConnectorPropertyName(S),className:"toggle",label:f.e.resolveFieldLabel(h,S,null==k||null===(o=k[S])||void 0===o?void 0:o.displayName),defaultValue:1==(null==V?void 0:V[S]),readOnly:Y,disabled:!1,width:16,"data-componentid":"".concat(n,"-enable-auto-login"),hint:f.e.resolveFieldLabel(h,S,null==k||null===(r=k[S])||void 0===r?void 0:r.description)}),u.createElement(a.gN.Input,{ariaLabel:f.e.resolveFieldLabel(h,U,null==k||null===(i=k[U])||void 0===i?void 0:i.displayName),inputType:"number",name:f.e.encodeConnectorPropertyName(U),type:"number",width:16,required:!0,labelPosition:"top",minLength:3,maxLength:100,readOnly:Y,initialValue:null==V?void 0:V[U],"data-componentId":"".concat(n,"-otp-length"),label:f.e.resolveFieldLabel(h,U,null==k||null===(l=k[U])||void 0===l?void 0:l.displayName),disabled:!1,hint:f.e.resolveFieldLabel(h,U,null==k||null===(c=k[U])||void 0===c?void 0:c.description)}),u.createElement(a.gN.Checkbox,{ariaLabel:f.e.resolveFieldLabel(h,P,null==k||null===(s=k[P])||void 0===s?void 0:s.displayName),name:f.e.encodeConnectorPropertyName(P),className:"toggle",label:f.e.resolveFieldLabel(h,P,null==k||null===(d=k[P])||void 0===d?void 0:d.displayName),defaultValue:1==(null==V?void 0:V[P]),readOnly:Y,disabled:!1,width:16,"data-componentid":"".concat(n,"-enable-auto-login"),hint:f.e.resolveFieldLabel(h,P,null==k||null===(p=k[P])||void 0===p?void 0:p.description)}),u.createElement(a.gN.Checkbox,{ariaLabel:f.e.resolveFieldLabel(h,L,null==k||null===(m=k[L])||void 0===m?void 0:m.displayName),name:f.e.encodeConnectorPropertyName(L),className:"toggle",label:f.e.resolveFieldLabel(h,L,null==k||null===(v=k[L])||void 0===v?void 0:v.displayName),defaultValue:1==(null==V?void 0:V[L]),readOnly:Y,disabled:!1,width:16,"data-componentid":"".concat(n,"-enable-auto-login"),hint:f.e.resolveFieldLabel(h,L,null==k||null===(b=k[L])||void 0===b?void 0:b.description)}),u.createElement(a.gN.Checkbox,{ariaLabel:f.e.resolveFieldLabel(h,T,null==k||null===(O=k[T])||void 0===O?void 0:O.displayName),name:f.e.encodeConnectorPropertyName(T),className:"toggle",label:f.e.resolveFieldLabel(h,T,null==k||null===(E=k[T])||void 0===E?void 0:E.displayName),defaultValue:1==(null==V?void 0:V[T]),readOnly:Y,disabled:!1,width:16,"data-componentid":"".concat(n,"-enable-auto-login"),hint:f.e.resolveFieldLabel(h,T,null==k||null===(N=k[T])||void 0===N?void 0:N.description)}),u.createElement(a.gN.Button,{form:g,size:"small",buttonType:"primary_btn",ariaLabel:"Self registration update button",name:"update-button","data-componentId":"".concat(n,"-submit-button"),disabled:$,loading:$,label:t("common:update"),hidden:Y}))};return u.createElement(l.Xg,{title:t("governanceConnectors:connectorCategories.otherSettings.connectors.userClaimUpdate.friendlyName"),pageTitle:t("governanceConnectors:connectorCategories.otherSettings.connectors.userClaimUpdate.friendlyName"),description:t("governanceConnectors:connectorSubHeading",{name:t("governanceConnectors:connectorCategories.otherSettings.connectors.userClaimUpdate.friendlyName")}),"data-componentid":"".concat(n,"-page-layout"),backButton:{onClick:function(){m.m8.push(m.$x.getPaths().get("CLAIM_DIALECTS"))},text:t("claims:local.pageLayout.local.back")}},u.createElement(l.pJ,{className:"very padded"},!M&&V?u.createElement(ee,null):u.createElement(l.pO,null)))};E.defaultProps={"data-componentid":"attribute-verification-settings-form"};const N=E}}]);