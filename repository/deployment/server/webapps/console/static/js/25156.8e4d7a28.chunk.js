"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[25156],{25156:(e,n,t)=>{t.r(n),t.d(n,{default:()=>P});var a=t(24184),i=t(54833),o=t(93129),r=t(3356),l=t(66112),c=t(90960),u=t(86727),s=t(38314),d=t(67127),f=t(44194),g=t(10479),m=t(47245),p=t(26154),v=t(12638),h=t(62508),z=t(13460),E=t(6776),b=t(24393),S=t(48397),y=t(54126);function O(e){return function(e){if(Array.isArray(e))return A(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||k(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,i,o,r,l=[],c=!0,u=!1;try{if(o=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(a=o.call(t)).done)&&(l.push(a.value),l.length!==n);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=t.return&&(r=t.return(),Object(r)!==r))return}finally{if(u)throw i}}return l}}(e,n)||k(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,n){if(e){if("string"==typeof e)return A(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?A(e,n):void 0}}function A(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var L=[{key:0,text:c.I18n.instance.t("common:name"),value:"name"}],R=function(e){var n,t,c,k,A,R=e["data-componentid"],P=(0,g.$)().t,I=(0,m.I0)(),w=C((0,f.useState)(null),2),_=w[0],Z=w[1],U=C((0,f.useState)(""),2),j=U[0],T=U[1],Q=C((0,f.useState)(L[0]),2),V=Q[0],M=Q[1],X=C((0,f.useState)(b.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT),2),x=X[0],D=X[1],F=C((0,f.useState)(!0),2),N=F[0],B=F[1],$=C((0,f.useState)(!1),2),q=$[0],H=$[1],K=C((0,f.useState)(void 0),2),W=K[0],G=K[1],J=C((0,f.useState)(void 0),2),Y=J[0],ee=J[1],ne=C((0,f.useState)(null),2),te=ne[0],ae=ne[1],ie=C((0,f.useState)([]),2),oe=ie[0],re=ie[1],le=C((0,f.useState)(null),2),ce=le[0],ue=le[1],se=C((0,f.useState)(""),2),de=se[0],fe=se[1],ge=C((0,f.useState)(""),2),me=ge[0],pe=ge[1],ve=C((0,f.useState)(""),2),he=ve[0],ze=ve[1],Ee=C((0,f.useState)(""),2),be=Ee[0],Se=Ee[1],ye=C((0,f.useState)(1),2),Oe=ye[0],Ce=ye[1],ke=(0,m.v9)((function(e){return e.organization.organization})),Ae=(0,m.v9)((function(e){return e.config.ui.features})),Le=(0,m.v9)((function(e){var n;return null==e||null===(n=e.auth)||void 0===n?void 0:n.allowedScopes})),Re=b.lD.getInstance(),Pe=C((0,l.cC)(),2),Ie=Pe[0],we=Pe[1];(0,f.useEffect)((function(){var e,n=!1,t=!1;null==_||null===(e=_.links)||void 0===e||e.forEach((function(e){if("next"===e.rel){var a=e.href.split("after=")[1];fe(a),G(!0),n=!0}if("previous"===e.rel){var i=e.href.split("before=")[1];pe(i),ee(!0),t=!0}})),n||(fe(""),G(!1)),t||(pe(""),ee(!1))}),[_]);var _e=(0,f.useCallback)((function(){Ce(1),we()}),[Ce,we]);(0,f.useEffect)((function(){te&&!(0,d.Z)(te)&&(0,S.Xu)(te.id).then((function(e){ue(e)})).catch((function(e){null!=e&&e.description?I((0,r.V_)({description:e.description,level:o.QU.ERROR,message:P("organizations:notifications.fetchOrganization.error.message")})):I((0,r.V_)({description:P("organizations:notifications.fetchOrganization.genericError.description"),level:o.QU.ERROR,message:P("organizations:notifications.fetchOrganization.genericError.message")}))}))}),[te,I,P]);var Ze=(0,f.useMemo)((function(){return!te||(0,d.Z)(te)?j:"".concat(j?j+" and ":"","parentId eq ").concat(te.id)}),[j,te]),Ue=(0,f.useCallback)((function(e,n,t,a,l){var c;(0,i.Xr)(null==Ae?void 0:Ae.organizations,null==Ae||null===(c=Ae.organizations)||void 0===c||null===(c=c.scopes)||void 0===c?void 0:c.read,Le)&&(B(!0),(0,S.jX)(n,e,t,a,!1).then((function(e){Z(e)})).catch((function(e){Z(null),null!=e&&e.description?I((0,r.V_)({description:e.description,level:o.QU.ERROR,message:P("organizations:notifications.getOrganizationList.error.message")})):I((0,r.V_)({description:P("organizations:notifications.getOrganizationList.genericError.description"),level:o.QU.ERROR,message:P("organizations:notifications.getOrganizationList.genericError.message")}))})).finally((function(){B(!1)})))}),[S.jX,I,P,Z,B]);(0,f.useEffect)((function(){Ue(x,Ze,null,null)}),[x,Ue,Ze]);var je=(0,S.IE)(Ze,x,be,he,E.jo.CONSOLE_APP_NAME,!1),Te=je.data,Qe=je.isLoading,Ve=je.error,Me=je.mutate;(0,f.useEffect)((function(){Ve&&Xe(Ve)}),[Ve]);var Xe=function(e){var n,t;null!=e&&null!==(n=e.response)&&void 0!==n&&null!==(n=n.data)&&void 0!==n&&n.description?I((0,r.V_)({description:null==e||null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.description,level:o.QU.ERROR,message:P("organizations:notifications.getOrganizationList.error.message")})):I((0,r.V_)({description:P("organizations:notifications.getOrganizationList.genericError.description"),level:o.QU.ERROR,message:P("organizations:notifications.getOrganizationList.genericError.message")}))},xe=(0,f.useCallback)((function(e){_e(),T(e)}),[_e,T]),De=(0,f.useCallback)((function(e,n){var t=parseInt(null==n?void 0:n.activePage);t>Oe?(Ue(x,Ze,de,null),Se(de),ze(null)):t<Oe&&(Ue(x,Ze,null,me),Se(null),ze(me)),Ce(t)}),[Ue,Oe,Ze,x,de,me]),Fe=(0,f.useCallback)((function(e,n){D(n.value),_e()}),[D,_e]),Ne=function(){Ue(x,Ze,de,me),Me()},Be=(0,f.useCallback)((function(){T(""),_e()}),[T,_e]),$e=function(e,n){var t=O(oe);t.splice(n+1),re(t),ae(e),_e(),e||ue(null)};return f.createElement(f.Fragment,null,f.createElement(u.Xg,{action:!N&&!Qe&&!(!j&&((0,d.Z)(_)||(null==_||null===(n=_.organizations)||void 0===n?void 0:n.length)<=0))&&f.createElement(a.di,{when:null==Ae||null===(t=Ae.organizations)||void 0===t||null===(t=t.scopes)||void 0===t?void 0:t.create},f.createElement(u.KM,{disabled:N,loading:N,onClick:function(){Re.publish("organization-click-new-organization-button"),H(!0)},"data-componentid":"".concat(R,"-list-layout-add-button")},f.createElement(p.Z,{name:"add"}),P("organizations:list.actions.add"))),pageTitle:P("pages:organizations.title"),title:N?null:ce?ce.name:P("organizations:homeList.name"),description:f.createElement("p",null,N?null:ce?ce.description:null),"data-componentid":"".concat(R,"-page-layout"),titleAs:"h3",componentAbovePageHeader:f.createElement(f.Fragment,null,f.createElement(v.Z,{as:"h1","data-componentid":"".concat(R,"-organization-header")},P("pages:organizations.title"),f.createElement(v.Z.Subheader,{"data-componentid":"".concat(R,"-sub-title")},P("pages:organizations.subTitle"))),f.createElement(h.Z,{hidden:!0}),te&&oe.length>0&&f.createElement(z.Z,{className:"margined","data-componentid":"".concat(R,"-breadcrumb")},f.createElement(z.Z.Section,{onClick:function(){$e(null,-1)}},f.createElement("span",{"data-componentid":"".concat(R,"-breadcrumb-home")},ke.name)),null==oe?void 0:oe.map((function(e,n){return f.createElement(f.Fragment,{key:n},f.createElement(z.Z.Divider,{icon:"right chevron"}),f.createElement(z.Z.Section,{active:n===oe.length-1,link:n!==oe.length-1,onClick:n!==oe.length-1?function(){return $e(e,n)}:null},e.name))})))," ")},f.createElement(u.PS,{advancedSearch:f.createElement(b.nC,{onFilter:xe,filterAttributeOptions:[{key:0,text:P("common:name"),value:"name"}],filterAttributePlaceholder:P("organizations:advancedSearch.form.inputs.filterAttribute.placeholder"),filterConditionsPlaceholder:P("organizations:advancedSearch.form.inputs.filterCondition.placeholder"),filterValuePlaceholder:P("organizations:advancedSearch.form.inputs.filterValue.placeholder"),placeholder:P("organizations:advancedSearch.placeholder"),defaultSearchAttribute:"name",defaultSearchOperator:"co","data-componentid":"".concat(R,"-list-advanced-search")}),currentListSize:null==_||null===(c=_.organizations)||void 0===c?void 0:c.length,listItemLimit:x,onItemsPerPageDropdownChange:Fe,onPageChange:De,onSortStrategyChange:function(e,n){M((0,s.Z)(L,(function(e){return n.value===e.value})))},showPagination:!0,showTopActionPanel:N||!(!j&&(null==_||null===(k=_.organizations)||void 0===k?void 0:k.length)<=0),sortOptions:L,sortStrategy:V,totalPages:10,totalListSize:null==_||null===(A=_.organizations)||void 0===A?void 0:A.length,paginationOptions:{disableNextButton:!W,disablePreviousButton:!Y},isLoading:N,"data-componentid":"".concat(R,"-list-layout"),resetPagination:Ie,activePage:Oe},f.createElement(y.Bg,{list:_,authorizedList:Te,onOrganizationDelete:function(){Ue(x,Ze,de,me)},onEmptyListPlaceholderActionClick:function(){H(!0)},onSearchQueryClear:Be,searchQuery:j,"data-componentid":"organization-list",onListItemClick:function(e,n){if(!oe.find((function(e){return e.id===n.id}))){Be(),ae(n),_e();var t=O(oe);t.push(n),re(t)}},parentOrganization:te,onListMutate:Ne})),q&&f.createElement(y.Xh,{onUpdate:Ne,closeWizard:function(){return H(!1)},parent:te})))};R.defaultProps={"data-componentid":"organizations"};const P=R}}]);