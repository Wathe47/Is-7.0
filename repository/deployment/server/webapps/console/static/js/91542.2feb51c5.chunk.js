"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[91542,76305,43690],{91542:(e,t,n)=>{n.r(t);n(43690),n(76305),n(67711)},76305:(e,t,n)=>{n.r(t),n.d(t,{default:()=>U});var r=n(93129),o=n(3356),i=n(66112),a=n(86727),s=n(44194),l=n(10479),u=n(47245),c=n(62508),d=n(89141),f=n(35542),m=n(45481),p=n(24393),g=n(28897),E=n(37313),S=n(78645),v=n(15263),h=n(46556),R=n(8889);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const U=function(e){var t=e["data-testid"],n=(0,l.$)().t,b=(0,u.I0)(),U=(0,u.v9)((function(e){return e.config.ui.features})),_=(0,u.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t?void 0:t.enableIdentityClaims})),A=y((0,i.cC)(),2),T=A[0],I=A[1],O=y((0,i.cC)(),2),C=O[0],w=O[1],M=y((0,s.useState)(null),2),L=M[0],P=M[1],x=y((0,s.useState)({description:"",name:""}),2),N=x[0],D=x[1],j=y((0,s.useState)(R.RemoteUserStoreTypes.LDAP),2),k=j[0],$=j[1],Y=y((0,s.useState)(R.RemoteUserStoreAccessTypes.ReadOnly),2),Z=Y[0],Q=Y[1],V=y((0,s.useState)(!1),2),G=V[0],B=V[1],z=y((0,s.useState)(!1),2),F=z[0],X=z[1],H=y((0,s.useState)(null),2),W=H[0],q=H[1];(0,s.useEffect)((function(){J(null,null,null,null,!_)}),[]),(0,s.useEffect)((function(){(0,g.E4)(R.RemoteUserStoreConstants.OUTBOUND_USER_STORE_TYPE_ID,null).then((function(e){P(e)}))}),[]);var J=function(e,t,i,a,s){X(!0);var l={"exclude-identity-claims":s,filter:a||null,limit:e||null,offset:i||null,sort:t||null};(0,f.WN)(l).then((function(e){q(e.filter((function(e){return e.claimURI===m.Q.USER_NAME_CLAIM_URI||e.claimURI===m.Q.USER_ID_CLAIM_URI})))})).catch((function(e){var t,i;b((0,o.V_)({description:(null==e||null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.description)||n("claims:local.notifications.getClaims.genericError.description"),level:r.QU.ERROR,message:(null==e||null===(i=e.response)||void 0===i||null===(i=i.data)||void 0===i?void 0:i.message)||n("claims:local.notifications.getClaims.genericError.message")}))})).finally((function(){X(!1)}))},K=function(e){switch(e){case R.RemoteUserStoreConstants.PROPERTY_NAME_CONNECTED_USERSTORE_TYPE:return k.toString();case R.RemoteUserStoreConstants.PROPERTY_NAME_READ_ONLY:return Z.toString()}},ee=function(e){if(G){var t=[],i=function(){var e=[];return L.properties.Mandatory.map((function(t){e.push({name:t.name,value:K(t.name)})})),L.properties.Optional.map((function(t){e.push({name:t.name,value:t.defaultValue})})),e.push({name:R.RemoteUserStoreConstants.PROPERTY_NAME_READ_ONLY,value:K(R.RemoteUserStoreConstants.PROPERTY_NAME_READ_ONLY)}),e}();e.forEach((function(e,n){t.push({claimURI:n,mappedAttribute:e})}));var a,s={claimAttributeMappings:t,description:N.description,name:N.name,properties:i,typeId:R.RemoteUserStoreConstants.OUTBOUND_USER_STORE_TYPE_ID};a=s,(0,g.yS)(a).then((function(e){b((0,o.V_)({description:n("userstores:notifications.addUserstore.success.description"),level:r.QU.SUCCESS,message:n("userstores:notifications.addUserstore.success.message")})),b((0,o.V_)({description:n("userstores:notifications.delay.description"),level:r.QU.WARNING,message:n("userstores:notifications.delay.message")})),p.m8.push({pathname:p.$x.getPaths().get("USERSTORES_EDIT").replace(":id",e.id).replace("edit-user-store",S.userstoresConfig.userstoreEdit.remoteUserStoreEditPath)+"#tab=1",search:"?isNew=true"})})).catch((function(e){var t,i,a;403===(null===(t=e.response)||void 0===t?void 0:t.status)&&(null===(i=e.response.data)||void 0===i?void 0:i.code)===E.u4.ERROR_CREATE_LIMIT_REACHED.getErrorCode()&&b((0,o.V_)({description:n(E.u4.ERROR_CREATE_LIMIT_REACHED.getErrorDescription()),level:r.QU.ERROR,message:n(E.u4.ERROR_CREATE_LIMIT_REACHED.getErrorMessage())})),b((0,o.V_)({description:n("userstores:notifications.addUserstore.genericError.description"),level:r.QU.ERROR,message:null!==(a=null==e?void 0:e.message)&&void 0!==a?a:n("userstores:notifications.addUserstore.genericError.message")}))}))}},te=[{preventGoToNextStep:!G,stepAction:I,stepContent:s.createElement(h.GeneralUserStoreDetails,{triggerSubmit:T,featureConfig:U,handleBasicDetailsSubmit:function(e){D({description:e.get("description").toString(),name:e.get("name").toString()})},handleUserStoreTypeChange:function(e){$(e)},handleUserStoreAccessTypeChange:function(e){Q(e)},setUserStoreNameValid:B}),stepTitle:n("extensions:manage.features.userStores.create.pageLayout.steps.generalSettings.title")},{stepAction:w,stepContent:s.createElement(s.Fragment,null,s.createElement(a.xv,{className:"section-description"},n("extensions:manage.features.userStores.create.pageLayout.steps.attributeMappings.subTitle")),s.createElement(c.Z,{hidden:!0}),s.createElement(h.AttributeMappingsComponent,{isAttributesListRequestLoading:F,triggerSubmit:C,mandatoryAttributes:W,handleAttributeMappingsSubmit:ee})),stepTitle:n("extensions:manage.features.userStores.create.pageLayout.steps.attributeMappings.title")}];return s.createElement(a.Xg,{title:n("extensions:manage.features.userStores.create.pageLayout.title"),contentTopMargin:!0,description:n("extensions:manage.features.userStores.create.pageLayout.description"),backButton:{"data-testid":"".concat(t,"-page-back-button"),onClick:function(){p.m8.push(p.$x.getPaths().get("USERSTORES"))},text:n("userstores:pageLayout.edit.back")},titleTextAlign:"left",bottomMargin:!1,showBottomDivider:!0,"data-testid":"".concat(t,"-page-layout")},s.createElement("div",{className:"remote-user-store-create-section"},s.createElement(a.pJ,{padded:"very"},s.createElement(d.Z,null,s.createElement(d.Z.Row,null,s.createElement(d.Z.Column,{width:10},s.createElement(v.VerticalStepper,{alwaysOpen:!1,isSidePanelOpen:!1,stepContent:te,isNextEnabled:!0,"data-testid":"".concat(t,"-vertical-stepper"),handleFinishAction:function(){return w()}})))))))}},43690:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var r=n(93129),o=n(3356),i=n(86727),a=n(87692),s=n(56024),l=n(67127),u=n(44194),c=n(10479),d=n(47245),f=n(26154),m=n(9261),p=n(24393),g=n(28897),E=n(13992),S=n(37313),v=n(47195),h=n(61793),R=n(46556),y=n(8889);function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const _=function(e){var t=e.match,n=e["data-testid"],U=(0,d.I0)(),_=(0,c.$)().t,A=t.params.id,T=b((0,u.useState)(null),2),I=T[0],O=T[1],C=b((0,u.useState)(null),2),w=C[0],M=C[1],L=b((0,u.useState)(null),2),P=L[0],x=L[1],N=b((0,u.useState)(void 0),2),D=N[0],j=N[1],k=b((0,u.useState)(void 0),1)[0],$=b((0,u.useState)(void 0),2),Y=$[0],Z=$[1],Q=b((0,u.useState)(""),2),V=Q[0],G=Q[1],B=b((0,u.useState)(!1),2),z=B[0],F=B[1],X=b((0,u.useState)(!1),2),H=X[0],W=X[1],q=b((0,u.useState)([]),2)[1];(0,u.useEffect)((function(){window.location.hash||ee()}),[]),(0,u.useEffect)((function(){W(!0),(0,h.getAgentConnections)(A).then((function(e){q(e.filter((function(e){return null==e?void 0:e.agent})))})).finally((function(){W(!1)}))}),[A]),(0,u.useEffect)((function(){window.location.hash&&(I||(F(!0),(0,a.Z)((function(){ee(),F(!1)}),12e3)))}),[I]),(0,u.useEffect)((function(){(0,g.E4)(y.RemoteUserStoreConstants.OUTBOUND_USER_STORE_TYPE_ID,null).then((function(e){M(e)}))}),[]),(0,u.useEffect)((function(){w&&x((0,v.Y)(null==w?void 0:w.properties,null==I?void 0:I.properties))}),[w]),(0,u.useEffect)((function(){var e;I&&G(null==I||null===(e=I.properties)||void 0===e||null===(e=e.find((function(e){return e.name===S.rr})))||void 0===e?void 0:e.value)}),[I]),(0,u.useEffect)((function(){if(void 0===Y||window.location.hash.includes(m.El.VIEW)||(0,l.Z)(window.location.hash)){if((0,l.Z)(window.location.hash))return void J(1);if(void 0===Y||(0,l.Z)(window.location.hash))return;var e=window.location.hash.split("#"+m.El.TAB_INDEX);if(2===e.length&&(0,l.Z)(e[0])&&/^\d+$/.test(e[1])){var t=parseInt(e[1],10);if((0,s.Z)(t,0,Y)){if(t===D)return;J(t)}else K(k)}else K(k)}}),[window.location.hash,Y]);var J=function(e){p.m8.push({hash:"#".concat(m.El.TAB_INDEX).concat(e),pathname:window.location.pathname}),j(e)},K=function(e){J(e)},ee=function(){(0,g.YZ)(A).then((function(e){O(e)})).catch((function(e){U((0,o.V_)({description:(null==e?void 0:e.description)||_("userstores:notifications.fetchUserstores.genericError.description"),level:r.QU.ERROR,message:(null==e?void 0:e.message)||_("userstores:notifications.fetchUserstores.genericError.message")}))}))},te=[{menuItem:"Setup Guide",render:function(){return u.createElement(i.M$.Pane,{controlledSegmentation:!0,attached:!1},u.createElement(R.SetupGuideTab,{isUserStoreLoading:z,userStoreId:A}))}},{menuItem:"General",render:function(){return u.createElement(i.M$.Pane,{controlledSegmentation:!0,attached:!1},u.createElement(R.UserStoreGeneralSettings,{userStoreProperties:P,isDisabled:V,userStore:I,userStoreId:A,handleUserStoreDisabled:function(e){return G(e)}}))}},{menuItem:"Attribute Mappings",render:function(){return u.createElement(i.M$.Pane,{controlledSegmentation:!0,attached:!1},u.createElement(R.AttributeMappings,{userStore:I,userStoreId:A}))}}];return u.createElement(i.O9,{image:u.createElement(i.dn,{bordered:!0,defaultIcon:!0,size:"x60",relaxed:"very",shape:"rounded",hoverable:!1,icon:(0,E.jw)()}),title:u.createElement(u.Fragment,null,"false"===V?u.createElement(i.GI,{trigger:u.createElement(f.Z,{className:"mr-2 ml-0 vertical-aligned-baseline",size:"small",name:"circle",color:"green"}),content:_("common:enabled"),inverted:!0}):u.createElement(i.GI,{trigger:u.createElement(f.Z,{className:"mr-2 ml-0 vertical-aligned-baseline",size:"small",name:"circle",color:"orange"}),content:_("common:disabled"),inverted:!0}),null==I?void 0:I.name),backButton:{onClick:function(){p.m8.push(p.$x.getPaths().get("USERSTORES"))},text:_("userstores:pageLayout.edit.back")},titleTextAlign:"left",bottomMargin:!1,isLoading:z||H,"data-testid":"".concat(n,"-page-layout")},u.createElement(i.M$,{className:"remote-user-store-edit-section",panes:te,onTabChange:function(e,t){J(t.activeIndex),ee()},"data-testid":"".concat(n,"-tabs"),onInitialize:function(e){var t=e.panesLength;Z(t)},activeIndex:D,defaultActiveIndex:k}))}},67711:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var r=n(93129),o=n(3356),i=n(86727),a=n(44194),s=n(10479),l=n(47245),u=n(24393),c=n(97474),d=n(2057),f=n(40231),m=n(8889);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var E=function(e){var t=e["data-testid"],n=(0,s.$)().t,g=(0,i.fQ)().getLink,E=[{key:0,text:n("common:name"),value:"name"},{key:1,text:n("common:description"),value:"description"}],S=(0,l.v9)((function(e){return e.config.ui.features})),v=p((0,a.useState)([]),2),h=v[0],R=v[1],y=p((0,a.useState)(0),2),b=y[0],U=y[1],_=p((0,a.useState)(u.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT),1)[0],A=p((0,a.useState)(void 0),2),T=A[0],I=A[1],O=p((0,a.useState)(E[0]),1)[0],C=p((0,a.useState)(!0),1)[0],w=p((0,a.useState)(""),2),M=w[0],L=w[1],P=p((0,a.useState)(!1),2),x=P[0],N=P[1],D=(0,l.I0)(),j=(0,c.zU)({filter:null,limit:null,offset:null,sort:null}),k=j.data,$=j.isLoading,Y=j.error,Z=j.mutate;(0,a.useEffect)((function(){if(k){var e=k.filter((function(e){return e.id!==m.RemoteUserStoreConstants.CUSTOMER_USERSTORE_ID}));R(e),I(e)}}),[k]),(0,a.useEffect)((function(){var e,t,i;Y&&(null==Y||null===(e=Y.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.message)!==f.u4.RESOURCE_NOT_FOUND_ERROR_MESSAGE&&D((0,o.V_)({description:(null==Y||null===(t=Y.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.description)||n("userstores:notifications.fetchUserstores.genericError.description"),level:r.QU.ERROR,message:(null==Y||null===(i=Y.response)||void 0===i||null===(i=i.data)||void 0===i?void 0:i.message)||n("userstores:notifications.fetchUserstores.genericError.message")}))}),[Y]),(0,a.useEffect)((function(){I((0,u.fS)(T,O.value,C))}),[O,C]);return a.createElement(i.Xg,{pageTitle:"User Stores",title:n("extensions:manage.features.userStores.list.title"),description:a.createElement(a.Fragment,null,n("extensions:manage.features.userStores.list.subTitle"),a.createElement(i.eb,{link:g("manage.userStores.userStoresList.learnMore")},n("extensions:common.learnMore"))),"data-testid":"".concat(t,"-page-layout")},a.createElement(i.PS,{currentListSize:_,listItemLimit:_,onPageChange:function(e,t){U((t.activePage-1)*_)},leftActionPanel:null,showPagination:!1,showTopActionPanel:!1,totalPages:1,totalListSize:null==T?void 0:T.length,isLoading:$||void 0===T,"data-testid":"".concat(t,"-list-layout")},a.createElement(d.rO,{list:function(e,t,n){return null==e?void 0:e.slice(n,n+t)}(T,_,b),onEmptyListPlaceholderActionClick:function(){return u.m8.push(m.RemoteUserStoreConstants.getPaths().get("REMOTE_USER_STORE_CREATE"))},onSearchQueryClear:function(){N(!x),L(""),I(h)},searchQuery:M,update:function(){return Z()},featureConfig:S,"data-testid":"".concat(t,"-list")})))};E.defaultProps={"data-testid":"userstores"};const S=E}}]);