"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[5248],{5248:(e,t,n)=>{n.r(t),n.d(t,{default:()=>U});var r=n(86727),a=n(46440),i=n(44194),o=n(10479),l=n(24393),c=n(43970),u=n(93129),d=n(3356),s=n(20812),m=n(47245),f=n(89141),p=n(26154),v=n(57369),y=n(52988),h=n(58143),g=n(73534),b=n(67127),E=n(62508),S=n(44661),w=n(40807),C=n(69879),A=n(71490);function I(e){return function(e){if(Array.isArray(e))return L(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||P(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}(e,t)||P(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D=function(e){var t=e.initialClaims,n=e.mappedAttributesList,a=e.setMappedAttributeList,l=e.hideIdentityClaimAttributes,c=T((0,i.useState)([]),2),u=c[0],d=c[1],s=T((0,i.useState)(!0),2),m=s[0],p=s[1],v=T((0,i.useState)(),2),y=v[0],h=v[1],g=T((0,i.useState)(!0),2),L=g[0],D=g[1],j=T((0,i.useState)(!1),2),V=j[0],k=j[1],N=(0,o.$)().t;(0,i.useEffect)((function(){(0,A.ep)(l,d,p)}),[]),(0,i.useEffect)((function(){var e,t=new Set,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=P(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}(n);try{for(r.s();!(e=r.n()).done;){var a=e.value;t.add(a.localClaim.id)}}catch(i){r.e(i)}finally{r.f()}h(t)}),[u,n]),(0,i.useEffect)((function(){k(0===n.length)}),[n]),(0,i.useEffect)((function(){(0,b.Z)(n)&&!(0,b.Z)(u)&&L&&(O(),D(!1))}),[u,t]);var O=function(){t&&(t.forEach((function(e){e.localClaim=u.find((function(t){return t.uri===e.localClaim.uri}))})),a(t))},M=function(){return I(u.filter((function(e){return!y.has(e.id)})))};return m?i.createElement(r.pO,null):i.createElement(f.Z,null,i.createElement(f.Z.Row,{columns:1},i.createElement(f.Z.Column,{computer:16,tablet:16,largeScreen:16,widescreen:16},i.createElement(r.X6,{as:"h4"},N("idvp:forms.attributeSettings.attributeMapping.heading")),i.createElement(r.kW,{compact:!0},N("idvp:forms.attributeSettings.attributeMapping.hint"))),i.createElement(f.Z.Column,{width:16},i.createElement(S.f,{availableAttributeList:M(),alreadyMappedAttributesList:n,onSubmit:function(e){a([].concat(I(n),[e])),h(new Set([].concat(I(y),[e.localClaim.id])))}})),i.createElement(f.Z.Column,{width:16},V?(0,C.l)():i.createElement(i.Fragment,null,i.createElement(E.Z,{hidden:!0}),i.createElement(w.Y,{key:"attribute-mapping-working-list",alreadyMappedAttributesList:n,onMappingDeleted:function(e){var t=n.filter((function(t){return t.localClaim.id!==e.localClaim.id})),r=new Set(y);a(I(t)),r.delete(e.localClaim.id),h(r)},onMappingEdited:function(e,t){var r=[].concat(I(n.filter((function(t){return t.localClaim.id!==e.localClaim.id}))),[t]);if(a(r),e.localClaim.id!==t.localClaim.id){var i=new Set(y);i.delete(e.localClaim.id),i.add(t.localClaim.id),h(i)}},attributeMappingsListToShow:n,availableAttributesList:M()})))))};function j(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=k(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}(e,t)||k(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){if(e){if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(e,t):void 0}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}D.defaultProps={"data-componentid":"attributes-selection-wizard-page"};var O=function(e){return e.CONFIGURATION="Configuration",e.IDVP_SETTINGS="Identity Verification Provider Settings",e.ATTRIBUTES="Attributes",e}(O||{}),M=[{icon:(0,v.n)().idvpSettings,name:O.CONFIGURATION,title:"Configuration"},{icon:(0,v.n)().general,name:O.ATTRIBUTES,title:"Attributes"}],R=function(e){var t=e.showWizard,n=e.onWizardClose,a=e.selectedTemplateType,v=e.onIDVPCreate,b=(0,i.useRef)(null),E="idvp-create-wizard-factory",S=(0,o.$)().t,w=V((0,i.useState)(0),2),C=w[0],A=w[1],I=V((0,i.useState)(!1),2),T=I[0],P=I[1],L=(0,m.I0)(),k=V((0,i.useState)([]),2),N=k[0],O=k[1],R=V((0,r.IK)(),3),x=R[0],z=R[1],_=R[2],Z=(0,c.Yy)(),G=Z.data,U=Z.isLoading,$=Z.error,F=(0,c.yy)(null==a?void 0:a.id),Q=F.data,H=F.isLoading,B=F.error,W=(0,c.Xx)(null==a?void 0:a.id),X=W.data,J=W.error,K=W.isLoading,q=V((0,i.useState)(!1),2),Y=q[0],ee=q[1];(0,i.useEffect)((function(){$&&(0,h.o6)($)}),[$]),(0,i.useEffect)((function(){J&&(0,h.Ji)(J)}),[J]),(0,i.useEffect)((function(){B&&(0,h.II)(B)}),[B]);var te=function(){x&&z(void 0),n()},ne=function(){var e;return i.createElement(s.k0,{validate:function(e){var t,n=(0,h.w)(null==e?void 0:e.name,G.identityVerificationProviders);if(n)return ee(!0),n;var r,a=j(null==X||null===(t=X.pages)||void 0===t||null===(t=t.edit)||void 0===t?void 0:t.settings);try{for(a.s();!(r=a.n()).done;){var i=r.value,o=(0,g.r)(e[i.name],i);if(o)return ee(!0),o}}catch(l){a.e(l)}finally{a.f()}ee(!1)}},i.createElement(s.gN.Input,{ariaLabel:"name",inputType:"resource_name",name:"name",label:S("idvp:forms.generalDetails.name.label"),required:!0,message:S("idvp:forms.generalDetails.name.validations.empty"),placeholder:S("idvp:forms.generalDetails.name.placeholder"),validate:function(e){return(0,h.w)(e,G.identityVerificationProviders)},maxLength:y.G.IDVP_NAME_MAX_LENGTH,minLength:y.G.IDVP_NAME_MIN_LENGTH,format:function(e){return e.toString().trimStart()},"data-componentid":"".concat(E,"-form-wizard-idvp-name"),hint:S("idvp:forms.generalDetails.name.hint")}),(0,g.A)(null==X||null===(e=X.pages)||void 0===e||null===(e=e.edit)||void 0===e?void 0:e.settings,Q))},re=function(){return i.createElement(s.k0,null,i.createElement(D,{mappedAttributesList:N,initialClaims:(0,h.jm)(Q.claims),hideIdentityClaimAttributes:!0,"data-componentid":"".concat(E,"-attribute-settings"),setMappedAttributeList:O}))},ae=function(e){var t,n;Q.Name=null!==(t=null==e?void 0:e.name)&&void 0!==t?t:Q.Name,Q.description=null!==(n=null==e?void 0:e.description)&&void 0!==n?n:Q.description;var r,a,i=j(null==Q?void 0:Q.configProperties);try{for(i.s();!(r=i.n()).done;){var o=r.value;e[null==o?void 0:o.key]&&(o.value=e[null==o?void 0:o.key])}}catch(l){i.e(l)}finally{i.f()}Q.claims=N.map((function(e){return{idvpClaim:e.idvpClaim,localClaim:e.localClaim.uri}})),a=Q,P(!0),(0,c.j8)(a).then((function(e){var t;L((0,d.V_)({description:S("idvp:notifications.addIDVP.success.description"),level:u.QU.SUCCESS,message:S("idvp:notifications.addIDVP.success.message")})),null!=e&&null!==(t=e.data)&&void 0!==t&&t.id?v(e.data.id):v()})).catch((function(e){var t;null!=e&&null!==(t=e.response)&&void 0!==t&&null!==(t=t.data)&&void 0!==t&&t.description?z({description:S("idvp:notifications.addIDVP.error.description",{description:e.response.data.description}),level:u.QU.ERROR,message:S("idvp:notifications.addIDVP.error.message")}):z({description:S("idvp:notifications.addIDVP.genericError.description"),level:u.QU.ERROR,message:S("idvp:notifications.addIDVP.genericError.message")})})).finally((function(){P(!1)}))};return!t||U||H||K?null:i.createElement(l.wv,{open:t,className:"wizard identity-verification-provider-create-wizard",dimmer:"blurring",onClose:n,closeOnDimmerClick:!1,closeOnEscape:!0,"data-componentid":"".concat(E,"-modal")},i.createElement(l.wv.MainPanel,null,i.createElement(l.wv.Header,{className:"wizard-header","data-componentid":"".concat(E,"-modal-header")},i.createElement("div",{className:"display-flex"},i.createElement(r.dn,{icon:(0,h.VT)(a.image),size:"x30",transparent:!0,spaced:"right","data-componentid":"".concat(E,"-image")}),i.createElement("div",null,a.name,a.description&&i.createElement(r.X6,{as:"h6"},a.description)))),i.createElement(i.Fragment,null,i.createElement(l.wv.Content,{className:"steps-container","data-componentid":"".concat(E,"-modal-content-1")},i.createElement(r.Rg.Group,{current:C},M.map((function(e,t){return i.createElement(r.Rg.Step,{active:!0,key:t,icon:e.icon,title:e.title})})))),i.createElement(l.wv.Content,{className:"content-container","data-componentid":"".concat(E,"-modal-content-2")},i.createElement(i.Fragment,null,x&&_,U?i.createElement(r.pO,null):i.createElement(s.w,{id:"idvp-create-wizard-content",ref:b,onSubmit:ae,uncontrolledForm:!0,pageChanged:function(e){return A(e)},"data-componentid":E},[ne(),re()])))),i.createElement(l.wv.Actions,{"data-componentid":"".concat(E,"-modal-actions")},i.createElement(f.Z,null,i.createElement(f.Z.Row,{column:1},i.createElement(f.Z.Column,{mobile:8,tablet:8,computer:8},i.createElement(r.Qj,{floated:"left",onClick:te,"data-componentid":"".concat(E,"-modal-cancel-button")},S("common:cancel"))),i.createElement(f.Z.Column,{mobile:8,tablet:8,computer:8},C<M.length-1&&i.createElement(r.KM,{disabled:Y,floated:"right",onClick:function(){b.current.gotoNextPage()},"data-componentid":"".concat(E,"-modal-next-button")},S("authenticationProvider:wizards.buttons.next"),i.createElement(p.Z,{name:"arrow right"})),C===M.length-1&&i.createElement(r.KM,{disabled:Y||T,type:"submit",floated:"right",onClick:function(){b.current.gotoNextPage()},"data-componentid":"".concat(E,"-modal-finish-button"),loading:T},S("authenticationProvider:wizards.buttons.finish")),C>0&&i.createElement(r.Qj,{type:"submit",floated:"right",onClick:function(){return b.current.gotoPreviousPage()},"data-componentid":"".concat(E,"-modal-previous-button")},i.createElement(p.Z,{name:"arrow left"}),S("authenticationProvider:wizards.buttons.previous"))))))))};function x(e){return function(e){if(Array.isArray(e))return Z(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}(e,t)||_(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){if(e){if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(e,t):void 0}}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}R.defaultProps={"data-componentid":"idvp-create-wizard"};var G=function(e){var t=e["data-componentid"],n=(0,o.$)().t,u=z((0,i.useState)(!1),2),d=u[0],s=u[1],m=z((0,i.useState)(void 0),2),f=m[0],p=m[1],v=z((0,i.useState)(new Set),2),g=v[0],b=v[1],E=z((0,i.useState)([]),2),S=E[0],w=E[1],C=z((0,i.useState)(void 0),2),A=C[0],I=C[1],T=z((0,i.useState)(""),2),P=T[0],L=T[1],D=(0,c.Nl)(),j=D.data,V=D.isLoading,k=D.error;(0,i.useEffect)((function(){if(j&&Array.isArray(j)&&j.length>0){w(j);var e=new Set;j.forEach((function(t){var n;null===(n=t.tags)||void 0===n||n.forEach((function(t){e.add(t)}))})),b(e)}}),[j]),(0,i.useEffect)((function(){k&&(0,h.mp)(k)}),[k]);var N,O=function(e,t){return(0,a.Z)(j).filter((function(n){var r=!0,a=!0;return e&&(r=n.name.toLocaleLowerCase().includes(e)),t.length>0&&(a=t.some((function(e){return n.tags.includes(e)}))),r&&a}))};return i.createElement(r.Xg,{pageTitle:"Create a New Identity Verification Provider",isLoading:V,title:n("console:develop.pages.idvpTemplate.title"),contentTopMargin:!0,description:n("console:develop.pages.idvpTemplate.subTitle"),backButton:{"data-componentid":"".concat(t,"-page-back-button"),onClick:function(){l.m8.push(l.$x.getPaths().get(y.G.IDVP_PATH))},text:n("console:develop.pages.idvpTemplate.backButton")},titleTextAlign:"left",bottomMargin:!1,"data-componentid":"".concat(t,"-page-layout"),showBottomDivider:!0},i.createElement(r.Me,{search:i.createElement(r.m6,{placeholder:n("console:develop.pages.idvpTemplate.search.placeholder"),onSearch:function(e,t){L(e),w(O(e.toLocaleLowerCase(),t))},onFilter:function(e,t){L(e),w(O(e,t))},filterLabels:x(g),disableSearchFilterDropdown:!0}),isLoading:V},!V&&S?i.createElement(r.Q8,{isEmpty:!(S&&S.length>0),emptyPlaceholder:(N=S,P&&0===N.length?i.createElement(r.$J,{image:(0,l.jF)().emptySearch,imageSize:"tiny",title:n("console:develop.placeholders.emptySearchResult.title"),subtitle:[n("console:develop.placeholders.emptySearchResult.subtitles.0",{query:P}),n("console:develop.placeholders.emptySearchResult.subtitles.1")],"data-componentid":"".concat(t,"-empty-search-placeholder")}):0===N.length?i.createElement(r.$J,{image:(0,l.jF)().newList,imageSize:"tiny",title:n("idvp:placeholders.emptyIDVPTypeList.title"),subtitle:[n("idvp:placeholders.emptyIDVPTypeList.subtitles.0"),n("idvp:placeholders.emptyIDVPTypeList.subtitles.1")],"data-componentid":"".concat(t,"-empty-placeholder")}):null)},S.map((function(e,a){return i.createElement(r.Q8.Card,{key:a,resourceName:e.name,comingSoonRibbonLabel:n("common:comingSoon"),resourceDescription:e.description,resourceImage:(0,h.VT)(e.image),tags:e.tags,onClick:function(t){!function(e,t){t&&(I(t),p(t.id),s(!0))}(0,e)},showTooltips:{description:!0,header:!1},"data-componentid":"".concat(t,"-").concat(e.name)})}))):i.createElement(r.pO,{dimmer:!0})),i.createElement(R,{showWizard:d,type:f,selectedTemplateType:A,onIDVPCreate:function(e){e?l.m8.push({pathname:l.$x.getPaths().get(y.G.IDVP_EDIT_PATH).replace(":id",e)}):l.m8.push(l.$x.getPaths().get(y.G.IDVP_PATH))},onWizardClose:function(){p(void 0),s(!1)}}))};G.defaultProps={"data-componentid":"idvp-templates"};const U=G}}]);