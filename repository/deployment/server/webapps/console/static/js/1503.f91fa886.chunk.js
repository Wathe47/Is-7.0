"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[1503],{1503:(e,t,n)=>{n.r(t),n.d(t,{CreateGroupWizard:()=>P});var r=n(93129),o=n(3356),i=n(66112),a=n(86727),s=n(99285),l=n(44194),u=n(10479),c=n(47245),d=n(47018),f=n(89141),m=n(26154),p=n(10909),g=n(58117),v=n(24393),b=n(79589),S=n(49534),y=n(41391),h=n(71662),E=n(12742),A=n(40231),R=n(78645);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){var r;return r=function(e,t){if("object"!=C(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==C(r)?r:r+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||_(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var B=function(e){return e.BASIC_DETAILS="BasicDetails",e.SUMMARY="summary",e}(B||{}),P=function(e){var t,n,C=e.closeWizard,I=e.initStep,j=e.requiredSteps,P=e.showStepper,U=e.submitStep,M=e["data-testid"],T=(0,u.$)().t,L=(0,c.I0)(),z=D((0,l.useState)(I),2),G=z[0],N=z[1],k=D((0,l.useState)(void 0),2),Z=k[0],Q=k[1],W=D((0,l.useState)(void 0),2),Y=W[0],x=W[1],V=D((0,l.useState)(void 0),2),q=V[0],F=V[1],K=D((0,l.useState)(null!==R.commonConfig&&void 0!==R.commonConfig&&R.commonConfig.primaryUserstoreOnly?A.pH:A.XS),2),$=K[0],H=K[1],X=D((0,l.useState)(!1),2),J=X[0],ee=X[1],te=D((0,i.cC)(),2),ne=te[0],re=te[1],oe=D((0,i.cC)(),2),ie=oe[0],ae=oe[1],se=D((0,l.useState)(!1),2),le=se[0],ue=se[1],ce=D((0,l.useState)(!0),2),de=ce[0],fe=ce[1],me=D((0,a.IK)(),3),pe=me[0],ge=me[1],ve=me[2],be=b.lD.getInstance();(0,l.useEffect)((function(){F(Ae([B.BASIC_DETAILS,B.SUMMARY]))}),[]),(0,l.useEffect)((function(){void 0!==Z&&(N(G-1),Q(void 0))}),[Z]),(0,l.useEffect)((function(){le&&Y&&Y[B.BASIC_DETAILS]&&Se(Y[B.BASIC_DETAILS])}),[Y&&Y[B.BASIC_DETAILS]]);var Se=function(e){var t,n,i,a,s,l="";l="primary"!==(null==e?void 0:e.domain)?null!=e&&e.BasicDetails.basic?(null==e||null===(t=e.BasicDetails)||void 0===t||null===(t=t.basic)||void 0===t?void 0:t.domain)+"/"+(null==e||null===(n=e.BasicDetails)||void 0===n||null===(n=n.basic)||void 0===n?void 0:n.groupName):(null==e?void 0:e.domain)+"/"+(null==e?void 0:e.groupName):null!=e&&null!==(i=e.BasicDetails)&&void 0!==i&&i.basic?null==e||null===(a=e.BasicDetails)||void 0===a?void 0:a.groupName:null==e?void 0:e.groupName;var u=[],c=null==e||null===(s=e.BasicDetails)||void 0===s?void 0:s.users;(null==c?void 0:c.length)>0&&(null==c||c.forEach((function(e){null==u||u.push({display:e.userName,value:e.id})})));var d={displayName:l,members:u,schemas:["urn:ietf:params:scim:schemas:core:2.0:Group"]};ee(!0),(0,S.sS)(d).then((function(t){if(201===t.status){var n,i,a=t.data,s=[];if(null!=e&&null!==(n=e.RoleList)&&void 0!==n&&n.roles)null==e||null===(i=e.RoleList)||void 0===i||i.roles.forEach((function(e){null==s||s.push(e.id)}));var l={Operations:[{op:"add",value:{groups:[{display:a.displayName,value:a.id}]}}],schemas:["urn:ietf:params:scim:api:messages:2.0:PatchOp"]};if(s&&s.length>0){var u,c=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(s);try{for(c.s();!(u=c.n()).done;){var d=u.value;(0,E.ul)(d,l).catch((function(e){e.response&&401!==e.response.status?e.response&&e.response.data.detail?ge({description:T("console:manage.features.groups.notifications.createPermission.error.description",{description:e.response.data.detail}),level:r.QU.ERROR,message:T("console:manage.features.groups.notifications.createPermission.error.message")}):ge({description:T("console:manage.features.groups.notifications.createPermission.genericError.description"),level:r.QU.ERROR,message:T("console:manage.features.groups.notifications.createPermission.genericError.message")}):ge({description:T("console:manage.features.groups.notifications.createPermission.error.description"),level:r.QU.ERROR,message:T("console:manage.features.groups.notifications.createPermission.error.message")})}))}}catch(f){c.e(f)}finally{c.f()}}L((0,o.V_)({description:T("console:manage.features.groups.notifications.createGroup.success.description"),level:r.QU.SUCCESS,message:T("console:manage.features.groups.notifications.createGroup.success.message")}))}C(),v.m8.push(v.$x.getPaths().get("GROUP_EDIT").replace(":id",t.data.id))})).catch((function(e){e.response&&401!==e.response.status?e.response&&e.response.data.detail?(C(),L((0,o.V_)({description:T("console:manage.features.groups.notifications.createGroup.error.description",{description:e.response.data.detail}),level:r.QU.ERROR,message:T("console:manage.features.groups.notifications.createGroup.error.message")}))):(C(),L((0,o.V_)({description:T("console:manage.features.groups.notifications.createGroup.genericError.description"),level:r.QU.ERROR,message:T("console:manage.features.groups.notifications.createGroup.genericError.message")}))):(C(),L((0,o.V_)({description:T("console:manage.features.groups.notifications.createGroup.error.description"),level:r.QU.ERROR,message:T("console:manage.features.groups.notifications.createGroup.error.message")})))})).finally((function(){ee(!1)}))},ye=function(e){be.publish("manage-groups-finish-create-new-group"),Se(e)},he=function(){if(Y)return Y},Ee=function(){switch(G){case 0:re();break;case 1:ae()}},Ae=function(e){var t=function(e){var t=[];return e.forEach((function(e){e===B.BASIC_DETAILS?t.push(Re()):e===B.SUMMARY&&t.push(Ce())})),t};return t(j?(0,s.Z)(e,j):e)},Re=function(){return{content:l.createElement(l.Fragment,null,l.createElement(g.AddGroupUsers,{"data-testid":"new-group",isEdit:!1,triggerSubmit:ne,userStore:$,initialValues:Y&&Y[B.BASIC_DETAILS],onSubmit:function(e){return function(e,t){B.BASIC_DETAILS===t&&H(e.basic.domain),U===t||le||N(G+1),x(w(w({},Y),{},O({},t,e))),U===B.SUMMARY||U!==t||ye(w(w({},Y),{},O({},t,e)))}(e,B.BASIC_DETAILS)},onUserFetchRequestFinish:function(){return fe(!1)}})),icon:(0,h.i)().general,name:B.BASIC_DETAILS,title:T("roles:addRoleWizard.wizardSteps.0")}},Ce=function(){return{content:l.createElement(y.EG,{"data-testid":"add-group-summary",triggerSubmit:ie,onSubmit:function(){return ye(Y)},summary:he()}),icon:(0,h.i)().summary,name:B.SUMMARY,title:T("roles:addRoleWizard.wizardSteps.3")}};return l.createElement(d.Z,{open:!0,className:"wizard create-role-wizard",dimmer:"blurring",size:"small",onClose:C,closeOnDimmerClick:!1,closeOnEscape:!1,"data-testid":M},l.createElement(d.Z.Header,{className:"wizard-header"},T("roles:addRoleWizard.heading",{type:"Group"}),Y&&null!==(t=Y[B.BASIC_DETAILS])&&void 0!==t&&t.groupName?" - "+(null===(n=Y[B.BASIC_DETAILS])||void 0===n?void 0:n.groupName):"",l.createElement(a.X6,{as:"h6"},"Create new group and add users to the group.")),P&&l.createElement(d.Z.Content,{className:"steps-container"},l.createElement(a.Rg.Group,{current:G},null==q?void 0:q.map((function(e,t){return l.createElement(a.Rg.Step,{key:t,icon:e.icon,title:e.title})})))),l.createElement(d.Z.Content,{className:"content-container",scrolling:!0},pe&&ve,function(){var e,t,n;if(!q)return null;switch(null===(e=q[G])||void 0===e?void 0:e.name){case B.BASIC_DETAILS:return null===(t=Re())||void 0===t?void 0:t.content;case B.SUMMARY:return null===(n=Ce())||void 0===n?void 0:n.content}}()),l.createElement(d.Z.Actions,null,l.createElement(f.Z,null,l.createElement(f.Z.Row,{column:1},l.createElement(f.Z.Column,{mobile:8,tablet:8,computer:8},l.createElement(a.Qj,{floated:"left",onClick:function(){return C()},"data-testid":"".concat(M,"-cancel-button")},T("common:cancel"))),l.createElement(f.Z.Column,{mobile:8,tablet:8,computer:8},G<(null==q?void 0:q.length)-1&&l.createElement(a.KM,{floated:"right",onClick:Ee,disabled:de,"data-testid":"".concat(M,"-next-button")},T("roles:addRoleWizard.buttons.next"),l.createElement(m.Z,{name:"arrow right","data-testid":"".concat(M,"-next-button-icon")})),(null==q?void 0:q.length)>1&&0===G&&l.createElement(p.Z,{basic:!0,color:"orange",floated:"right",onClick:function(){ue(!0),re()},disabled:de,"data-testid":"".concat(M,"-initial-finish-button")},T("roles:addRoleWizard.buttons.finish")),G===(null==q?void 0:q.length)-1&&l.createElement(a.KM,{floated:"right",onClick:Ee,"data-testid":"".concat(M,"-finish-button"),disabled:de||J,loading:J},T("roles:addRoleWizard.buttons.finish")),(null==q?void 0:q.length)>1&&G>0&&l.createElement(a.Qj,{floated:"right",onClick:function(){Q(G)},"data-testid":"".concat(M,"-previous-button"),disabled:de},l.createElement(m.Z,{name:"arrow left","data-testid":"".concat(M,"-previous-button-icon")}),T("roles:addRoleWizard.buttons.previous")))))))};P.defaultProps={initStep:0,requiredSteps:[B.BASIC_DETAILS,B.SUMMARY],showStepper:!1,submitStep:B.SUMMARY}}}]);