"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[91450],{91450:(e,n,t)=>{t.r(n),t.d(n,{SessionManagementSettingsPage:()=>w,default:()=>G});var r,o=t(67442),i=t(54833),a=t(93129),s=t(3356),l=t(20812),u=t(86727),m=t(21036),c=t(44194),d=t(10479),E=t(47245),f=t(89141),g=t(41193),_=t(62508),S=t(41206),p=t(24393),N=t(34148),M=t(58097),O=t(73508),T=t(22732);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function C(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function v(e,n,t){return n&&C(e.prototype,n),t&&C(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function A(e,n,t){return(n=b(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function b(e){var n=function(e,n){if("object"!=I(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==I(n)?n:n+""}var h=v((function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}));r=h,A(h,"IDLE_SESSION_TIMEOUT_PATH","/idleSessionTimeoutPeriod"),A(h,"REMEMBER_ME_PERIOD_PATH","/rememberMePeriod"),A(h,"REPLACE_OPERATION","REPLACE"),A(h,"SESSION_MANAGEMENT_CONFIG_FETCH_ERROR_CODE","SMC-00001"),A(h,"SESSION_MANAGEMENT_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE","SMC-00002"),A(h,"SESSION_MANAGEMENT_CONFIG_UPDATE_ERROR_CODE","SMC-00003"),A(h,"SESSION_MANAGEMENT_CONFIG_FIELD_MIN_LENGTH",0),A(h,"SESSION_MANAGEMENT_CONFIG_FIELD_MAX_LENGTH",100),A(h,"ErrorMessages",{SESSION_MANAGEMENT_CONFIG_FETCH_ERROR_CODE:new T.O(r.SESSION_MANAGEMENT_CONFIG_FETCH_ERROR_CODE,"An error occurred while fetching the session management configurations.","Error while fetching the session management configurations",null),SESSION_MANAGEMENT_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE:new T.O(r.SESSION_MANAGEMENT_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE,"Received an invalid status code while fetching the session management configurations.","Invalid Status Code while fetching the session management configurations",null),SESSION_MANAGEMENT_CONFIG_UPDATE_ERROR_CODE:new T.O(r.SESSION_MANAGEMENT_CONFIG_UPDATE_ERROR_CODE,"An error occurred while updating the session management configurations.","Error while updating the session management configurations",null)});var R=N.AsgardeoSPAClient.getInstance().httpRequest.bind(N.AsgardeoSPAClient.getInstance());function y(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i,a,s=[],l=!0,u=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;l=!1}else for(;!(l=(r=i.call(t)).done)&&(s.push(r.value),s.length!==n);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return P(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return P(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var w=function(e){var n,t,r,N,T=e["data-componentid"],I=(0,c.useRef)(null),C=(0,c.useRef)(null),v=(0,E.v9)((function(e){return e.config.ui.features})),A=(0,E.v9)((function(e){var n;return null==e||null===(n=e.auth)||void 0===n?void 0:n.allowedScopes})),b=(0,c.useMemo)((function(){var e;return!(0,i.Xr)(null==v?void 0:v.governanceConnectors,null==v||null===(e=v.governanceConnectors)||void 0===e||null===(e=e.scopes)||void 0===e?void 0:e.update,A)}),[v,A]),P=(0,E.I0)(),w=(0,d.$)().t,G=y((0,c.useState)(!1),2),D=G[0],L=G[1],F=y((0,c.useState)(void 0),2),H=F[0],Z=F[1],U=(n={headers:{Accept:"application/json","Content-Type":"application/json"},method:a.f2.GET,url:M.De.getServiceResourceEndpoints().serverConfigurations},t=(0,O.Z)(n),r=t.data,N=t.error,{data:r,error:N,isLoading:!N&&!r,isValidating:t.isValidating,mutate:t.mutate}),j=U.data,k=U.isLoading,V=U.mutate,x=U.error;(0,c.useEffect)((function(){j instanceof o.u||x?q():j&&j.idleSessionTimeoutPeriod&&j.rememberMePeriod&&Z({idleSessionTimeout:parseInt(j.idleSessionTimeoutPeriod),rememberMePeriod:parseInt(j.rememberMePeriod)})}),[j]);var q=function(){P((0,s.V_)({description:w("sessionManagement:notifications.getConfiguration.error.description"),level:a.QU.ERROR,message:w("sessionManagement:notifications.getConfiguration.error.message")}))};return c.createElement(u.Xg,{title:w("sessionManagement:title"),pageTitle:w("sessionManagement:title"),description:w("sessionManagement:description"),backButton:{onClick:function(){p.m8.push(p.$x.getPaths().get("LOGIN_AND_REGISTRATION"))},text:w("governanceConnectors:goBackLoginAndRegistration")},bottomMargin:!1,contentTopMargin:!1,pageHeaderMaxWidth:!0,"data-componentid":"".concat(T,"-form-layout")},c.createElement(S.R,{innerRef:I},c.createElement(f.Z,{className:"mt-2"},c.createElement(f.Z.Row,{columns:1},c.createElement(f.Z.Column,{width:16},c.createElement(u.pJ,{className:"form-wrapper",padded:"very"},k?c.createElement(f.Z.Row,{columns:1},c.createElement("div",null,c.createElement("div",{className:"ui card fluid settings-card","data-testid":"".concat(T,"-loading-card")},c.createElement("div",{className:"content no-padding"},c.createElement("div",{className:"header-section"},c.createElement(g.Z,null,c.createElement(g.Z.Header,null,c.createElement(g.Z.Line,{length:"medium"}),c.createElement(g.Z.Line,{length:"full"}))),c.createElement(_.Z,{hidden:!0}))),c.createElement("div",{className:"content extra extra-content"},c.createElement("div",{className:"action-button"},c.createElement(g.Z,null,c.createElement(g.Z.Line,{length:"very short"}))))),c.createElement(_.Z,{hidden:!0}))):c.createElement(c.Fragment,null,c.createElement(l.l0,{id:"session-management-config-form",uncontrolledForm:!0,onSubmit:function(e){L(!0),function(e){var n={data:e,headers:{Accept:"application/json","Content-Type":"application/json"},method:a.f2.PATCH,url:M.De.getServiceResourceEndpoints().serverConfigurations};return R(n).then((function(e){if(200!==e.status&&201!==e.status)throw new o.u(h.ErrorMessages.SESSION_MANAGEMENT_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE.getErrorMessage(),null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){var n,t=h.ErrorMessages.SESSION_MANAGEMENT_CONFIG_UPDATE_ERROR_CODE.getErrorMessage();throw new o.u(t,e.stack,null===(n=e.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.code,e.request,e.response,e.config)}))}([{operation:h.REPLACE_OPERATION,path:h.IDLE_SESSION_TIMEOUT_PATH,value:e.idleSessionTimeout.toString()},{operation:h.REPLACE_OPERATION,path:h.REMEMBER_ME_PERIOD_PATH,value:e.rememberMePeriod.toString()}]).then((function(){P((0,s.V_)({description:w("sessionManagement:notifications.updateConfiguration.success.description"),level:a.QU.SUCCESS,message:w("sessionManagement:notifications.updateConfiguration.success.message")})),V()})).catch((function(){P((0,s.V_)({description:w("sessionManagement:notifications.updateConfiguration.error.description"),level:a.QU.ERROR,message:w("sessionManagement:notifications.updateConfiguration.error.message")}))})).finally((function(){L(!1)}))},initialValues:H,enableReinitialize:!0,ref:C,noValidate:!0,validate:function(e){var n={idleSessionTimeout:void 0,rememberMePeriod:void 0};return null!=e&&e.idleSessionTimeout&&(!m.I.isInteger(e.idleSessionTimeout)||e.idleSessionTimeout<0)&&(n.idleSessionTimeout=w("sessionManagement:form.validation.idleSessionTimeout")),null!=e&&e.rememberMePeriod&&(!m.I.isInteger(e.rememberMePeriod)||e.rememberMePeriod<0)&&(n.rememberMePeriod=w("sessionManagement:form.validation.rememberMePeriod")),n},autoComplete:"new-password"},c.createElement(f.Z,null,c.createElement(f.Z.Row,{columns:2,key:1},c.createElement(f.Z.Column,{key:"idleSessionTimeout"},c.createElement(l.gN.Input,{min:h.SESSION_MANAGEMENT_CONFIG_FIELD_MIN_LENGTH,ariaLabel:"Idle Session Timeout Field",inputType:"number",name:"idleSessionTimeout",label:w("sessionManagement:form.idleSessionTimeout.label"),placeholder:w("sessionManagement:form.idleSessionTimeout.placeholder"),hint:w("sessionManagement:form.idleSessionTimeout.hint"),required:!0,value:null==H?void 0:H.idleSessionTimeout,readOnly:b,maxLength:null,minLength:h.SESSION_MANAGEMENT_CONFIG_FIELD_MIN_LENGTH,width:16,"data-componentid":"".concat(T,"-idle-session-timeout"),autoComplete:"new-password"})),c.createElement(f.Z.Column,{key:"rememberMePeriod"},c.createElement(l.gN.Input,{min:h.SESSION_MANAGEMENT_CONFIG_FIELD_MIN_LENGTH,ariaLabel:"Remember Me Period Field",inputType:"number",name:"rememberMePeriod",label:w("sessionManagement:form.rememberMePeriod.label"),placeholder:w("sessionManagement:form.rememberMePeriod.placeholder"),hint:w("sessionManagement:form.rememberMePeriod.hint"),required:!0,value:null==H?void 0:H.rememberMePeriod,readOnly:b,maxLength:null,minLength:h.SESSION_MANAGEMENT_CONFIG_FIELD_MIN_LENGTH,width:16,"data-componentid":"".concat(T,"-remember-me-period"),autoComplete:"new-password"}))))),!b&&c.createElement(c.Fragment,null,c.createElement(_.Z,{hidden:!0}),c.createElement(f.Z.Row,{columns:1,className:"mt-6"},c.createElement(f.Z.Column,{mobile:16,tablet:16,computer:16},c.createElement(u.KM,{size:"small",loading:D,onClick:function(){var e;null==C||null===(e=C.current)||void 0===e||e.triggerSubmit()},ariaLabel:"Session management form update button","data-componentid":"".concat(T,"-update-button")},w("common:update"))))))))))))};w.defaultProps={"data-componentid":"session-management-settings-page"};const G=w}}]);