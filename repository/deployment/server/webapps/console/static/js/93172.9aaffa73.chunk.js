"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[93172,65939,63336,2579,59723,2573],{65939:(e,n,t)=>{t.r(n),t.d(n,{addNewTenant:()=>a.addNewTenant,checkDuplicateTenants:()=>a.checkDuplicateTenants,getAssociatedTenants:()=>a.getAssociatedTenants,getDomainQueryParam:()=>a.getDomainQueryParam,makeTenantDefault:()=>a.makeTenantDefault});var a=t(2131)},93172:(e,n,t)=>{t.r(n),t.d(n,{AddTenantWizard:()=>_});var a=t(93129),r=t(3356),i=t(66112),s=t(86727),o=t(87692),l=t(44194),c=t(10479),u=t(47245),d=t(47018),m=t(89141),f=t(79589),T=t(76881),E=t(65939),N=t(63336);function g(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,r,i,s,o=[],l=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;l=!1}else for(;!(l=(a=i.call(t)).done)&&(o.push(a.value),o.length!==n);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=t.return&&(s=t.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return p(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return p(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var _=function(e){var n=e.openModal,t=e.onCloseHandler,p=e["data-testid"],_=(0,u.I0)(),A=(0,c.$)().t,h=g((0,l.useState)(0),1)[0],v=g((0,l.useState)(!1),2),b=v[0],M=v[1],y=g((0,l.useState)(!1),2),C=y[0],S=y[1],R=g((0,l.useState)(!1),2),L=R[0],O=R[1],w=g((0,l.useState)(),2),I=w[0],x=w[1],F=g((0,i.cC)(),2),z=F[0],D=F[1],H=g((0,l.useState)(),2),k=H[0],P=H[1],U=g((0,s.IK)(),3),j=U[0],G=U[1],Z=U[2],Q=f.lD.getInstance();(0,l.useEffect)((function(){k&&z&&W()}),[k,z]);var K,W=function(){O(!0),x(A("extensions:manage.features.tenant.wizards.addTenant.forms.loaderMessages.duplicateCheck")),(0,E.checkDuplicateTenants)(null==k?void 0:k.tenantName).then((function(e){O(!1),200==e.status&&(M(!0),G({description:A("extensions:manage.features.tenant.wizards.addTenant.forms.fields.tenantName.validations.duplicate",{tenantName:k.tenantName}),level:a.QU.ERROR,message:A("extensions:manage.features.tenant.notifications.addTenant.genericError.message")}))})).catch((function(e){404==e.response.status?$(k.tenantName):(O(!1),G({description:A("extensions:manage.features.tenant.notifications.addTenant.genericError.description"),level:a.QU.ERROR,message:A("extensions:manage.features.tenant.notifications.addTenant.genericError.message")}))}))},X=[{content:l.createElement(N.AddTenantWizardForm,{triggerSubmission:function(e){K=e},setSubmissionValue:P,"data-testid":"".concat(p,"-form"),tenantDuplicate:b,setTenantDuplicate:M,isCheckingTenantExistence:C,setCheckingTenantExistence:S}),icon:"",title:A("extensions:manage.features.tenant.wizards.addTenant.heading")}],$=function(e){O(!0),x(A("extensions:manage.features.tenant.wizards.addTenant.forms.loaderMessages.tenantCreate")),(0,E.addNewTenant)(e).then((function(n){201===n.status&&(Q.publish("create-new-organization"),_((0,r.V_)({description:A("extensions:manage.features.tenant.notifications.addTenant.success.description",{tenantName:e}),level:a.QU.SUCCESS,message:A("extensions:manage.features.tenant.notifications.addTenant.success.message")})),x(A("extensions:manage.features.tenant.wizards.addTenant.forms.loaderMessages.tenantSwitch")),(0,o.Z)((function(){O(!1),t(),(0,T.R)(e)}),5e3))})).catch((function(e){var n,t;O(!1),null!==(n=e.response.data)&&void 0!==n&&n.code&&["TM-10011","TM-10004","TM-10008","TM-10005"].includes(e.response.data.code)?G({description:A("extensions:manage.features.tenant.notifications.missingClaims.description"),level:a.QU.ERROR,message:A("extensions:manage.features.tenant.notifications.missingClaims.message")}):null!==(t=e.response.data)&&void 0!==t&&t.code&&["TM-10013"].includes(e.response.data.code)?G({description:A("extensions:manage.features.tenant.notifications.addTenant.limitReachError.description"),level:a.QU.ERROR,message:A("extensions:manage.features.tenant.notifications.addTenant.limitReachError.message")}):G({description:A("extensions:manage.features.tenant.notifications.addTenant.genericError.description"),level:a.QU.ERROR,message:A("extensions:manage.features.tenant.notifications.addTenant.genericError.message")})}))};return l.createElement(d.Z,{open:n,className:"wizard add-tenant-wizard",dimmer:"blurring",size:"tiny",onClose:t,closeOnDimmerClick:!1,closeOnEscape:!1,"data-testid":p},l.createElement(d.Z.Header,{className:"wizard-header add-tenant-wizard-header"},A("extensions:manage.features.tenant.wizards.addTenant.heading")),l.createElement(d.Z.Content,{className:"content-container",scrolling:!0},j&&Z,X[h].content,L&&l.createElement(s.pO,{text:I})),l.createElement(d.Z.Actions,null,l.createElement(m.Z,null,l.createElement(m.Z.Row,{column:1},l.createElement(m.Z.Column,{mobile:8,tablet:8,computer:8},l.createElement(s.Qj,{floated:"left",onClick:function(){t()},disabled:L,"data-testid":"".concat(p,"-cancel-button")},A("cancel"))),l.createElement(m.Z.Column,{mobile:8,tablet:8,computer:8},l.createElement(s.KM,{floated:"right",onClick:function(){K(),D()},loading:L,"data-testid":"".concat(p,"-create-button"),disabled:L||C},A("common:create")))))))};_.defaultProps={"data-testid":"tenant-add-wizard"}},2579:(e,n,t)=>{t.r(n),t.d(n,{AddTenantWizardForm:()=>p});var a=t(20812),r=t(86727),i=t(15952),s=t(36382),o=t(67127),l=t(44194),c=t(10479),u=t(59673),d=t(47245),m=t(62508),f=t(19980),T=t(65939),E=t(59723);function N(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,r,i,s,o=[],l=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;l=!1}else for(;!(l=(a=i.call(t)).done)&&(o.push(a.value),o.length!==n);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=t.return&&(s=t.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return g(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return g(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var p=function(e){var n=e.setSubmissionValue,t=e.triggerSubmission,g=e.tenantDuplicate,p=e.setTenantDuplicate,_=e.isCheckingTenantExistence,A=e.setCheckingTenantExistence,h=e["data-testid"],v=N((0,l.useState)(E.TenantManagementConstants.TENANT_URI_PLACEHOLDER),2),b=v[0],M=v[1],y=N((0,l.useState)(!1),2),C=y[0],S=y[1],R=(0,d.v9)((function(e){var n;return null===(n=e.config)||void 0===n||null===(n=n.deployment)||void 0===n||null===(n=n.extensions)||void 0===n?void 0:n.regionQualifiedConsoleUrl})),L=(0,d.v9)((function(e){var n;return null===(n=e.config)||void 0===n||null===(n=n.deployment)||void 0===n?void 0:n.tenantPrefix})),O=(0,c.$)().t,w=function(e){var n=!!e&&!!e.match(E.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_PATTERN);return n||(A(!1),I.cancel()),n},I=(0,l.useCallback)((0,s.Z)((function(e){(0,T.checkDuplicateTenants)(e).then((function(e){200==e.status&&p(!0),A(!1)})).catch((function(e){404==e.response.status&&p(!1),A(!1)}))}),1e3),[]);return l.createElement(l.Fragment,null,l.createElement(a.l0,{id:"add-tenant-wizard-form",onSubmit:function(e){n(e)},triggerSubmit:function(e){return t(e)},uncontrolledForm:!1,validate:(g||b===E.TenantManagementConstants.TENANT_URI_PLACEHOLDER)&&function(e){var n={tenantName:void 0};return g?n.tenantName=O("extensions:manage.features.tenant.wizards.addTenant.forms.fields.tenantName.validations.duplicate",{tenantName:e.toString()}):e.tenantName||(n.tenantName=O("extensions:manage.features.tenant.wizards.addTenant.forms.fields.tenantName.validations.empty")),n}},l.createElement(a.gN.Input,{ariaLabel:"Tenant Name",inputType:"resource_name",name:"tenantName",label:O("extensions:manage.features.tenant.wizards.addTenant.forms.fields.tenantName.label"),placeholder:O("extensions:manage.features.tenant.wizards.addTenant.forms.fields.tenantName.placeholder"),required:!0,listen:function(e){return n=e,p(!1),void((0,o.Z)(n)?(M(E.TenantManagementConstants.TENANT_URI_PLACEHOLDER),S(!1)):(M(n),S(w(n))));var n},maxLength:E.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MAX_LENGTH,minLength:E.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MIN_LENGTH,validation:function(e){return w(e.toString())?g?O("extensions:manage.features.tenant.wizards.addTenant.forms.fields.tenantName.validations.duplicate",{tenantName:e.toString()}):(A(!0),void I(e.toString())):e.length<E.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MIN_LENGTH?l.createElement(r.v0,{error:!0},l.createElement(u.c,{i18nKey:"extensions:manage.features.tenant.wizards.addTenant.forms.fields.tenantName.validations.invalidLength",minLength:E.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MIN_LENGTH,maxLength:E.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MAX_LENGTH},"The name you entered is less than ",{minLength:E.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MIN_LENGTH}," characters. It must",l.createElement("ul",null,l.createElement("li",null,"be unique"),l.createElement("li",null,l.createElement(l.Fragment,null,"contain more than"," ",{minLength:E.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MIN_LENGTH},"and less than"," ",{maxLength:E.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MAX_LENGTH},"characters")),l.createElement("li",null,"consist of only lowercase alphanumeric characters"),l.createElement("li",null,"begin with an alphabetic character")))):l.createElement(r.v0,{error:!0},l.createElement(u.c,{i18nKey:"extensions:manage.features.tenant.wizards.addTenant.forms.fields.tenantName.validations.invalid",minLength:E.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MIN_LENGTH,maxLength:E.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MAX_LENGTH},"Please enter a valid format for organization name. It must",l.createElement("ul",null,l.createElement("li",null,"be unique"),l.createElement("li",null,l.createElement(l.Fragment,null,"contain more than"," ",{minLength:E.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MIN_LENGTH},"and less than"," ",{maxLength:E.TenantManagementConstants.FORM_FIELD_CONSTRAINTS.TENANT_NAME_MAX_LENGTH},"characters")),l.createElement("li",null,"consist of only lowercase alphanumeric characters"),l.createElement("li",null,"begin with an alphabetic character"))))},width:16,"data-testid":"".concat(h,"-type-input")})),l.createElement(m.Z,{className:"mt-1",hidden:!0}),_?l.createElement("span",{className:"display-flex"},"".concat(null!=R?R:"https://console.asgardeo.io","/").concat(null!=L?L:"t","/"),l.createElement(f.Z,{basic:!0,size:"mini"},l.createElement(i.p,{className:"p-0",size:"mini",active:!0,inline:!0,"data-testid":"".concat(h,"-name-loader")}))):l.createElement("span",null,"".concat(null!=R?R:"https://console.asgardeo.io","/").concat(null!=L?L:"t","/"),l.createElement("span",{className:"".concat(b!==E.TenantManagementConstants.TENANT_URI_PLACEHOLDER?C&&!g?"valid-tenant placeholder-uri-bold":"invalid-tenant placeholder-uri-bold":b==E.TenantManagementConstants.TENANT_URI_PLACEHOLDER?C&&!g?"valid-tenant placeholder-uri-bold":"placeholder-uri":void 0)},b,l.createElement(r.kW,{icon:"info circle",popup:!0},O("extensions:manage.features.tenant.wizards.addTenant.tooltips.message")))),l.createElement(m.Z,{className:"mt-1",hidden:!0}),l.createElement(r.v0,{type:"info",content:l.createElement(u.c,{i18nKey:"extensions:manage.features.tenant.wizards.addTenant.forms.messages.info"},"Think of a good, unique organization name for your new Asgardeo workspace because you\xa0won\u2019t be able to change it later!")}))};p.defaultProps={"data-testid":"add-tenant-wizard-form"}},63336:(e,n,t)=>{t.r(n),t.d(n,{AddTenantWizardForm:()=>a.AddTenantWizardForm});var a=t(2579)},59723:(e,n,t)=>{t.r(n),t.d(n,{TenantManagementConstants:()=>a.TenantManagementConstants});var a=t(2573)},2573:(e,n,t)=>{function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function r(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,o(a.key),a)}}function i(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,n,t){return(n=o(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e){var n=function(e,n){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==a(n)?n:n+""}t.r(n),t.d(n,{TenantManagementConstants:()=>l});var l=i((function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}));s(l,"TENANT_URI_PLACEHOLDER","myorg"),s(l,"EU_PROD_CONSOLE_FALLBACK_URL","https://console.eu.asgardeo.io"),s(l,"US_PROD_CONSOLE_FALLBACK_URL","https://console.asgardeo.io"),s(l,"FORM_FIELD_CONSTRAINTS",{TENANT_NAME_ALPHANUMERIC:new RegExp("^[a-z0-9]+$"),TENANT_NAME_FIRST_ALPHABET:new RegExp("^[a-z]"),TENANT_NAME_MAX_LENGTH:30,TENANT_NAME_MIN_LENGTH:4,TENANT_NAME_PATTERN:new RegExp("^[a-z][a-z0-9]{3,29}$")})}}]);