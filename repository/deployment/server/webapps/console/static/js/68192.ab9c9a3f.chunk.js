"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[68192],{68192:(e,t,l)=>{l.r(t),l.d(t,{RoleGroupsList:()=>x});var n=l(93129),r=l(3356),o=l(86727),a=l(39345),i=l(24285),s=l(26109),u=l(67127),c=l(44194),d=l(10479),p=l(47245),m=l(47018),f=l(89141),g=l(66528),h=l(37077),v=l(62508),y=l(12950),b=l(26154),E=l(10909),S=l(24393),C=l(49534),Z=l(45770);function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function w(e,t){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),l.push.apply(l,n)}return l}function R(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{};t%2?w(Object(l),!0).forEach((function(t){I(e,t,l[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):w(Object(l)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(l,t))}))}return e}function I(e,t,l){var n;return n=function(e,t){if("object"!=O(e)||!e)return e;var l=e[Symbol.toPrimitive];if(void 0!==l){var n=l.call(e,t||"default");if("object"!=O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==O(n)?n:n+"")in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}function P(e){return function(e){if(Array.isArray(e))return L(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||j(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var l=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=l){var n,r,o,a,i=[],s=!0,u=!1;try{if(o=(l=l.call(e)).next,0===t){if(Object(l)!==l)return;s=!1}else for(;!(s=(n=o.call(l)).done)&&(i.push(n.value),i.length!==t);s=!0);}catch(e){u=!0,r=e}finally{try{if(!s&&null!=l.return&&(a=l.return(),Object(a)!==a))return}finally{if(u)throw r}}return i}}(e,t)||j(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){if(e){if("string"==typeof e)return L(e,t);var l=Object.prototype.toString.call(e).slice(8,-1);return"Object"===l&&e.constructor&&(l=e.constructor.name),"Map"===l||"Set"===l?Array.from(e):"Arguments"===l||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l)?L(e,t):void 0}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var l=0,n=new Array(t);l<t;l++)n[l]=e[l];return n}var x=function(e){var t=e.role,l=e.onRoleUpdate,O=e.isReadOnly,w=(0,d.$)().t,I=(0,p.I0)(),j=k((0,c.useState)(!1),2),L=j[0],x=j[1],A=k((0,c.useState)([]),2),H=A[0],T=A[1],U=k((0,c.useState)([]),2),N=U[0],D=U[1],G=k((0,c.useState)([]),2),M=G[0],z=G[1],F=k((0,c.useState)([]),2),J=F[0],$=F[1],_=k((0,c.useState)(void 0),2),q=_[0],Q=_[1],X=k((0,c.useState)(void 0),2),K=X[0],B=X[1],V=k((0,c.useState)([]),2),W=V[0],Y=V[1],ee=k((0,c.useState)([]),2),te=ee[0],le=ee[1],ne=k((0,c.useState)(!1),2),re=ne[0],oe=ne[1],ae=k((0,c.useState)(!1),2),ie=ae[0],se=ae[1],ue=k((0,c.useState)([]),2),ce=ue[0],de=ue[1],pe=k((0,c.useState)(!1),2),me=pe[0],fe=pe[1],ge=k((0,o.IK)(),3),he=ge[0],ve=ge[1],ye=ge[2];(0,c.useEffect)((function(){t&&(be(),de(t.groups))}),[]),(0,c.useEffect)((function(){le(ie?N:[])}),[ie]),(0,c.useEffect)((function(){Y(re?H:[])}),[re]),(0,c.useEffect)((function(){t&&(be(),de(t.groups))}),[t]),(0,c.useEffect)((function(){(0,C.hI)(null).then((function(e){Q(e.data.Resources)}))}),[]);var be=function(){var e=new Map;t.groups&&t.groups instanceof Array?((0,s.Z)(t.groups,(function(t){var l=t.display.split("/");l[0]!==Z.Fn&&l[0]!==Z.eT&&e.set(t.display,t.value)})),B(e)):B(void 0)},Ee=function(){oe(!re)},Se=function(){se(!ie)},Ce=function(){var e=P(N);(null==W?void 0:W.length)>0&&W.map((function(t){null!=N&&N.includes(t)||e.push(t)})),D(e),$(e),T(H.filter((function(t){return!(null!=e&&e.includes(t))}))),z(H.filter((function(t){return!(null!=e&&e.includes(t))}))),le([]),oe(!1)},Ze=function(){var e=P(H);(null==te?void 0:te.length)>0&&te.map((function(t){null!=H&&H.includes(t)||e.push(t)})),T(e),z(e),D(null==N?void 0:N.filter((function(t){return!(null!=e&&e.includes(t))}))),$(null==N?void 0:N.filter((function(t){return!(null!=e&&e.includes(t))}))),Y([]),se(!1)},Oe=function(){!function(){var e=q?P(q):[],t=[];if(e&&K){var l=Array.from(null==K?void 0:K.values());(0,i.Z)(e,(function(e){l.includes(null==e?void 0:e.id)&&t.push(e)}))}D(t),$(t),T(e.filter((function(e){return!(null!=t&&t.includes(e))}))),z(e.filter((function(e){return!(null!=t&&t.includes(e))})))}(),x(!0)},we=function(){x(!1)},Re=function(e){var t=e.value,l=[];if((0,u.Z)(t))T(M);else{var n=new RegExp((0,a.Z)(t),"i");H&&H.map((function(e){n.test(e.displayName)&&(l.push(e),T(l))}))}},Ie=function(e){var t=e.value,l=[];if((0,u.Z)(t))D(J);else{var n=new RegExp((0,a.Z)(t),"i");N&&(null==N||N.map((function(e){n.test(e.displayName)&&(l.push(e),D(l))})))}},Pe=function(e){var t=null==e?void 0:e.split("/"),l={labelColor:"olive",labelText:Z.$R};return t[0]!==Z.Fn&&t[0]!==Z.eT&&(null==t?void 0:t.length)>1&&(l=R(R({},l),{},{labelText:t[0]})),l},ke=function(e){var t,l=null===(t=e)||void 0===t?void 0:t.split("/");return 1!==(null==l?void 0:l.length)&&(e=l[1]),e};return c.createElement(c.Fragment,null,c.createElement(o.X6,{as:"h4"},w("roles:edit.groups.heading"),c.createElement(o.X6,{subHeading:!0,ellipsis:!0,as:"h6"},w("roles:edit.groups.subHeading"))),c.createElement(v.Z,{hidden:!0}),c.createElement(f.Z,null,c.createElement(f.Z.Row,null,c.createElement(f.Z.Column,{computer:8},(null==K?void 0:K.size)>0?c.createElement(o.pJ,{"data-testid":"role-mgt-groups-list",className:"user-role-edit-header-segment"},c.createElement(f.Z.Row,null,c.createElement(f.Z.Column,null,c.createElement(y.Z,{"data-testid":"role-mgt-groups-list-search-input",icon:c.createElement(b.Z,{name:"search"}),onChange:function(e){var l=e.value,n=[];if((0,u.Z)(l))de(t.groups);else{var r=new RegExp((0,a.Z)(l),"i");ce&&(null==ce||ce.map((function(e){1===e.display.split("/").length&&r.test(e.display)&&(n.push(e),de(n))})))}},placeholder:w("user:updateUser.groups.editGroups.searchPlaceholder"),floated:"left",size:"small"}),!O&&c.createElement(E.Z,{"data-testid":"role-mgt-groups-list-update-button",size:"medium",icon:"pencil",floated:"right",onClick:Oe}))),c.createElement(f.Z.Row,null,c.createElement(g.Z,{singleLine:!0,compact:!0},c.createElement(g.Z.Header,null,c.createElement(g.Z.Row,null,c.createElement(g.Z.HeaderCell,null,c.createElement("strong",null,w("user:updateUser.groups.editGroups.groupList.headers.0"))),c.createElement(g.Z.HeaderCell,null,c.createElement("strong",null,w("user:updateUser.groups.editGroups.groupList.headers.1"))))),c.createElement(g.Z.Body,null,null==ce?void 0:ce.map((function(e,t){var l,n=null==e||null===(l=e.display)||void 0===l?void 0:l.split("/");if(n[0]!==Z.Fn&&n[0]!==Z.eT)return c.createElement(g.Z.Row,{key:t},c.createElement(g.Z.Cell,null,1===(null==n?void 0:n.length)?c.createElement(h.Z,{color:"olive"},Z.$R):c.createElement(h.Z,{color:"olive"},n[0])),c.createElement(g.Z.Cell,null,1===(null==n?void 0:n.length)?null==e?void 0:e.display:n[1]))})))))):c.createElement(o.pJ,null,c.createElement(o.$J,{"data-testid":"role-mgt-empty-groups-list",title:w("roles:edit.groups.placeholders.emptyPlaceholder.title"),subtitle:[w("roles:edit.groups.emptyPlaceholder.subtitles")],action:!O&&c.createElement(o.KM,{"data-testid":"role-mgt-empty-groups-list-assign-group-button",icon:"plus",onClick:Oe},w("roles:edit.groups.placeholders.emptyPlaceholder.action")),image:(0,S.jF)().emptyList,imageSize:"tiny"}))))),c.createElement(m.Z,{"data-testid":"role-mgt-update-groups-modal",open:L,size:"small",className:"user-roles"},c.createElement(m.Z.Header,null,w("roles:edit.groups.addGroupsModal.heading"),c.createElement(o.X6,{subHeading:!0,ellipsis:!0,as:"h6"},w("roles:edit.groups.addGroupsModal.subHeading"))),c.createElement(m.Z.Content,{image:!0},he&&ye,c.createElement(o.IX,{searchPlaceholder:w("transferList:searchPlaceholder",{type:"groups"}),addItems:Ce,removeItems:Ze,handleUnelectedListSearch:Re,handleSelectedListSearch:Ie,"data-testid":"role-mgt-update-groups-modal"},c.createElement(o.Jv,{isListEmpty:!((null==H?void 0:H.length)>0),listType:"unselected",listHeaders:[w("transferList:list.headers.0"),w("transferList:list.headers.1"),""],handleHeaderCheckboxChange:Ee,isHeaderCheckboxChecked:re,emptyPlaceholderContent:w("transferList:list.emptyPlaceholders.roles.unselected",{type:"groups"}),"data-testid":"role-mgt-update-groups-modal-unselected-groups-select-all-checkbox",emptyPlaceholderDefaultContent:w("transferList:list.emptyPlaceholders.default")},null==H?void 0:H.map((function(e,t){return c.createElement(o.qT,{handleItemChange:function(){return function(e){var t=P(W);null!=t&&t.includes(e)?(t.splice(t.indexOf(e),1),Y(t)):(t.push(e),Y(t))}(e)},key:t,listItem:ke(null==e?void 0:e.displayName),listItemId:e.id,listItemIndex:t,listItemTypeLabel:Pe(null==e?void 0:e.displayName),isItemChecked:W.includes(e),showSecondaryActions:!1,"data-testid":"role-mgt-update-groups-modal-unselected-groups"})}))),c.createElement(o.Jv,{isListEmpty:!((null==N?void 0:N.length)>0),listType:"selected",listHeaders:[w("transferList:list.headers.0"),w("transferList:list.headers.1")],handleHeaderCheckboxChange:Se,isHeaderCheckboxChecked:ie,emptyPlaceholderContent:w("transferList:list.emptyPlaceholders.roles.selected",{type:"groups"}),"data-testid":"role-mgt-update-groups-modal-selected-groups-select-all-checkbox",emptyPlaceholderDefaultContent:w("transferList:list.emptyPlaceholders.default")},null==N?void 0:N.map((function(e,t){return c.createElement(o.qT,{handleItemChange:function(){return function(e){var t=P(te);null!=t&&t.includes(e)?(t.splice(t.indexOf(e),1),le(t)):(t.push(e),le(t))}(e)},key:t,listItem:ke(null==e?void 0:e.displayName),listItemId:null==e?void 0:e.id,listItemIndex:t,listItemTypeLabel:Pe(null==e?void 0:e.displayName),isItemChecked:te.includes(e),showSecondaryActions:!1,"data-testid":"role-mgt-update-groups-modal-selected-groups"})}))))),c.createElement(m.Z.Actions,null,c.createElement(f.Z,null,c.createElement(f.Z.Row,{columns:2},c.createElement(f.Z.Column,{mobile:8,tablet:8,computer:8},c.createElement(o.Qj,{"data-testid":"role-mgt-update-groups-modal-cancel-button",floated:"left",onClick:we},w("common:cancel"))),c.createElement(f.Z.Column,{mobile:8,tablet:8,computer:8},c.createElement(o.KM,{"data-testid":"role-mgt-update-groups-modal-save-button",floated:"right",loading:me,disabled:me,onClick:function(){return function(e,t){var o,a=[];t.map((function(e){a.push(e.id)}));var i,s,u={Operations:[],failOnErrors:1,schemas:["urn:ietf:params:scim:api:messages:2.0:BulkRequest"]},c={data:{Operations:[]},method:"PATCH",path:"/Roles/"+e.id},d=[],p=[],m=[],f=[];K&&(m=P(K.values())),(null==a?void 0:a.length)>0&&a.map((function(e){var t;null!==(t=m)&&void 0!==t&&t.includes(e)?m.splice(m.indexOf(e),1):f.push(e)})),m&&(null===(o=m)||void 0===o?void 0:o.length)>0&&(m.map((function(e){var t={op:"remove",path:"groups[value eq ".concat(e,"]")};d.push(t)})),(i=c.data.Operations).push.apply(i,d),u.Operations.push(c)),f&&(null==f?void 0:f.length)>0&&(f.map((function(e){p.push({op:"add",value:{groups:[{value:e}]}})})),(s=c.data.Operations).push.apply(s,p),u.Operations.push(c)),fe(!0),(0,S.fU)(u).then((function(){I((0,r.V_)({description:w("roles:notifications.updateRole.success.description"),level:n.QU.SUCCESS,message:w("roles:notifications.updateRole.success.message")})),we(),l(e.id)})).catch((function(e){var t,l,r,o;404!==(null==e||null===(t=e.response)||void 0===t?void 0:t.status)&&(null!=e&&e.response&&null!=e&&null!==(l=e.response)&&void 0!==l&&l.data&&null!=e&&null!==(r=e.response)&&void 0!==r&&null!==(r=r.data)&&void 0!==r&&r.description?ve({description:null===(o=e.response)||void 0===o||null===(o=o.data)||void 0===o?void 0:o.description,level:n.QU.ERROR,message:w("roles:notifications.updateRole.error.message")}):ve({description:w("roles:notifications.updateRole.genericError.description"),level:n.QU.ERROR,message:w("roles:notifications.updateRole.genericError.message")}))})).finally((function(){fe(!1)}))}(t,N)}},w("common:save"))))))))}}}]);