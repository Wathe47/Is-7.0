"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[22048],{83179:(e,t,n)=>{n.d(t,{X:()=>se});var r=n(61763),l=n(54833),o=n(93129),a=n(3356),s=n(86727),i=n(44194),u=n(10479),c=n(47245),d=n(39345),p=n(26109),m=n(67127),f=n(47018),v=n(89141),g=n(66528),h=n(37077),y=n(62508),b=n(12950),E=n(26154),S=n(10909),U=n(12436),O=n(24393),R=n(49534),Z=n(45770);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){var r;return r=function(e,t){if("object"!=C(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==C(r)?r:r+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e){return function(e){if(Array.isArray(e))return T(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||L(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,l,o,a,s=[],i=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);i=!0);}catch(e){u=!0,l=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw l}}return s}}(e,t)||L(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){if(e){if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var M=function(e){var t,n,r=e.onAlertFired,l=e.user,C=e.handleUserUpdate,A=e.isReadOnly,P=(0,u.$)().t,L=(0,c.I0)(),T=j((0,i.useState)(!1),2),M=T[0],N=T[1],k=j((0,i.useState)([]),2),x=k[0],H=k[1],G=j((0,i.useState)([]),2),F=G[0],$=G[1],z=j((0,i.useState)([]),2),D=z[0],Q=z[1],_=j((0,i.useState)(void 0),2),X=_[0],J=_[1],V=j((0,i.useState)(!1),2),B=V[0],q=V[1],K=j((0,i.useState)([]),2),Y=K[0],W=K[1],ee=j((0,i.useState)(!1),2),te=ee[0],ne=ee[1],re=j((0,i.useState)([]),2),le=re[0],oe=re[1],ae=(null==l||null===(t=l.userName)||void 0===t?void 0:t.split("/").length)>1?null==l||null===(n=l.userName)||void 0===n?void 0:n.split[0]:U.userstoresConfig.primaryUserstoreName,se=(0,R.Ug)(ae),ie=se.data,ue=se.error,ce=se.isLoading,de=se.isValidating,pe=(0,i.useMemo)((function(){if(null!=ie&&ie.Resources)return ie.Resources}),[ie]),me=(0,i.useMemo)((function(){return ce||de}),[ce,de]);(0,i.useEffect)((function(){l&&(fe(),W(l.groups))}),[]),(0,i.useEffect)((function(){if(ue){if(ue.response&&ue.response.data&&ue.response.data.description)return void L((0,a.V_)({description:ue.response.data.description,level:o.QU.ERROR,message:P("console:manage.features.roles.edit.groups.notifications.fetchError.message")}));L((0,a.V_)({description:P("console:manage.features.roles.edit.groups.notifications.fetchError.description"),level:o.QU.ERROR,message:P("console:manage.features.roles.edit.groups.notifications.fetchError.message")}))}}),[ue]),(0,i.useEffect)((function(){l&&(fe(),W(l.groups))}),[l]),(0,i.useEffect)((function(){l.groups&&ge()}),[l.groups&&pe]);var fe=function(){var e=new Map;l.groups&&l.groups instanceof Array?((0,p.Z)(l.groups,(function(t){var n,r=null==t||null===(n=t.display)||void 0===n?void 0:n.split("/");r[0]!==Z.Fn&&r[0]!==Z.eT&&e.set(t.display,t.value)})),J(e)):J(void 0)},ve=function(){$(B?[]:x),q(!B)},ge=function(){var e=pe?I(pe):[],t=[];(0,p.Z)(e,(function(e){null!=X&&X.has(e.displayName)&&t.push(e)})),$(t),oe(t),H(e),Q(e),q(e.length===t.length)},he=function(){ge(),N(!0)},ye=function(){q(!1),N(!1)},be=function(e,t){var n=t.value,r=[];if((0,m.Z)(n))H(D);else{var l=new RegExp((0,d.Z)(n),"i");x&&x.map((function(e){l.test(e.displayName)&&(r.push(e),H(r))}))}},Ee=function(e){var t=null==e?void 0:e.split("/"),n={labelColor:"olive",labelText:Z.$R};return t[0]!==Z.Fn&&t[0]!==Z.eT&&(null==t?void 0:t.length)>1&&(n=w(w({},n),{},{labelText:t[0]})),n};return i.createElement(s.pJ,{padded:"very"},i.createElement(s.X6,{as:"h4"},P("user:updateUser.groups.editGroups.heading")),i.createElement(s.X6,{subHeading:!0,ellipsis:!0,as:"h6"},P("user:updateUser.groups.editGroups.subHeading")),i.createElement(y.Z,{hidden:!0}),i.createElement(v.Z,null,i.createElement(v.Z.Row,null,i.createElement(v.Z.Column,{computer:10,tablet:16,mobile:16},(null==X?void 0:X.size)>0?i.createElement(s.pJ,{"data-testid":"user-mgt-groups-list",className:"user-role-edit-header-segment"},i.createElement(v.Z.Row,null,i.createElement(v.Z.Column,null,i.createElement(b.Z,{"data-testid":"user-mgt-groups-list-search-input",icon:i.createElement(E.Z,{name:"search"}),onChange:function(e,t){var n=t.value,r=[];if((0,m.Z)(n))W(l.groups);else{var o=new RegExp((0,d.Z)(n),"i");Y&&(null==Y||Y.map((function(e){var t;1===(null==e||null===(t=e.display)||void 0===t?void 0:t.split("/")).length&&o.test(e.display)&&(r.push(e),W(r))})))}},placeholder:P("user:updateUser.groups.editGroups.searchPlaceholder"),floated:"left",size:"small"}),!A&&i.createElement(S.Z,{"data-testid":"user-mgt-groups-list-update-button",size:"medium",icon:"pencil",floated:"right",onClick:he}))),i.createElement(v.Z.Row,null,i.createElement(g.Z,{singleLine:!0,compact:!0},i.createElement(g.Z.Header,null,i.createElement(g.Z.Row,null,i.createElement(g.Z.HeaderCell,null,i.createElement("strong",null,P("user:updateUser.groups.editGroups.groupList.headers.0"))),i.createElement(g.Z.HeaderCell,null,i.createElement("strong",null,P("user:updateUser.groups.editGroups.groupList.headers.1"))))),i.createElement(g.Z.Body,null,null==Y?void 0:Y.map((function(e,t){var n,r=null==e||null===(n=e.display)||void 0===n?void 0:n.split("/");if(r[0]!==Z.Fn&&r[0]!==Z.eT)return i.createElement(g.Z.Row,{key:t},i.createElement(g.Z.Cell,null,1===(null==r?void 0:r.length)?i.createElement(h.Z,{color:"olive"},Z.$R):i.createElement(h.Z,{color:"olive"},r[0])),i.createElement(g.Z.Cell,null,1===(null==r?void 0:r.length)?null==e?void 0:e.display:r[1]))})))))):i.createElement(s.pJ,null,i.createElement(s.$J,{"data-testid":"user-mgt-empty-groups-list",title:P("user:updateUser.groups.editGroups.groupList.emptyListPlaceholder.title"),subtitle:[P("user:updateUser.groups.editGroups.groupList.emptyListPlaceholder.subTitle.0"),P("user:updateUser.groups.editGroups.groupList.emptyListPlaceholder.subTitle.1"),P("user:updateUser.groups.editGroups.groupList.emptyListPlaceholder.subTitle.2")],action:!A&&i.createElement(s.KM,{"data-testid":"user-mgt-empty-groups-list-assign-group-button",onClick:he,loading:me,disabled:me},i.createElement(E.Z,{name:"plus"}),"Assign Group"),image:(0,O.jF)().emptyList,imageSize:"tiny"}))))),i.createElement(f.Z,{"data-testid":"user-mgt-update-groups-modal",open:M,size:"small",className:"user-roles"},i.createElement(f.Z.Header,null,P("user:updateUser.groups.addGroupsModal.heading"),i.createElement(s.X6,{subHeading:!0,ellipsis:!0,as:"h6"},P("user:updateUser.groups.addGroupsModal.subHeading"))),i.createElement(f.Z.Content,{image:!0},me?i.createElement(s.pO,null):i.createElement(s.IX,{selectionComponent:!0,searchPlaceholder:P("transferList:searchPlaceholder",{type:"Groups"}),handleUnelectedListSearch:be,"data-testid":"user-mgt-update-groups-modal"},i.createElement(s.Jv,{isListEmpty:!(x.length>0),listType:"unselected",listHeaders:[P("transferList:list.headers.0"),P("transferList:list.headers.1")],handleHeaderCheckboxChange:ve,isHeaderCheckboxChecked:B,emptyPlaceholderContent:P("transferList:list.emptyPlaceholders.users.roles.unselected",{type:"groups"}),"data-testid":"user-mgt-update-groups-modal-unselected-groups-select-all-checkbox",emptyPlaceholderDefaultContent:P("transferList:list.emptyPlaceholders.default")},null==x?void 0:x.map((function(e,t){return i.createElement(s.qT,{handleItemChange:function(){return function(e){var t=I(F);null!=t&&t.includes(e)?(t.splice(t.indexOf(e),1),$(t)):(t.push(e),$(t)),q(t.length===x.length)}(e)},key:t,listItem:(n=null==e?void 0:e.displayName,l=null===(r=n)||void 0===r?void 0:r.split("/"),1!==(null==l?void 0:l.length)&&(n=l[1]),n),listItemId:null==e?void 0:e.id,listItemIndex:t,listItemTypeLabel:Ee(null==e?void 0:e.displayName),isItemChecked:F.includes(e),showSecondaryActions:!1,"data-testid":"user-mgt-update-groups-modal-unselected-groups"});var n,r,l}))))),i.createElement(f.Z.Actions,null,i.createElement(v.Z,null,i.createElement(v.Z.Row,{columns:2},i.createElement(v.Z.Column,{mobile:8,tablet:8,computer:8},i.createElement(s.Qj,{"data-testid":"user-mgt-update-groups-modal-cancel-button",floated:"left",onClick:ye},P("common:cancel"))),i.createElement(v.Z.Column,{mobile:8,tablet:8,computer:8},i.createElement(s.KM,{"data-testid":"user-mgt-update-groups-modal-save-button",floated:"right",loading:te,disabled:te,onClick:function(){return function(e,t){var n=[];t.map((function(e){n.push(e.id)}));var l={Operations:[],schemas:["urn:ietf:params:scim:api:messages:2.0:BulkRequest"]},a={data:{Operations:[{op:"remove",path:"members[display eq "+e.userName+"]"}]},method:"PATCH"},s={data:{Operations:[{op:"add",value:{members:[{display:e.userName,value:e.id}]}}]},method:"PATCH"},i=[],u=[],c=[];X&&(c=I(X.values())),(null==n?void 0:n.length)>0&&n.map((function(e){var t;null!==(t=c)&&void 0!==t&&t.includes(e)&&c.splice(c.indexOf(e),1)})),c&&c.length>0&&(c.map((function(e){a=w(w({},a),{path:"/Groups/"+e}),i.push(a)})),i.map((function(e){l.Operations.push(e)}))),n&&(null==n?void 0:n.length)>0&&(n.map((function(e){le.find((function(t){return t.id===e}))||(s=w(w({},s),{path:"/Groups/"+e}),u.push(s))})),u.map((function(e){l.Operations.push(e)}))),ne(!0),(0,O.fU)(l).then((function(){r({description:P("user:updateUser.groups.notifications.updateUserGroups.success.description"),level:o.QU.SUCCESS,message:P("user:updateUser.groups.notifications.updateUserGroups.success.message")}),ye(),C(e.id)})).catch((function(e){var t,n,l,a;404!==(null==e||null===(t=e.response)||void 0===t?void 0:t.status)&&(null!=e&&e.response&&null!=e&&null!==(n=e.response)&&void 0!==n&&n.data&&null!=e&&null!==(l=e.response)&&void 0!==l&&null!==(l=l.data)&&void 0!==l&&l.description?r({description:null===(a=e.response)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.description,level:o.QU.ERROR,message:P("user:updateUser.groups.notifications.updateUserGroups.error.message")}):r({description:P("user:updateUser.groups.notifications.updateUserGroups.genericError.description"),level:o.QU.ERROR,message:P("user:updateUser.groups.notifications.updateUserGroups.genericError.message")}))})).finally((function(){ne(!1)}))}(l,F)}},P("common:save"))))))))},N=n(6958),k=n(206),x=n(12886),H=n(92325),G=n(48397),F=n(73384),$=n(12742);function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){var r;return r=function(e,t){if("object"!=z(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==z(r)?r:r+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X(e){return function(e){if(Array.isArray(e))return B(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||V(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,l,o,a,s=[],i=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);i=!0);}catch(e){u=!0,l=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw l}}return s}}(e,t)||V(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var q=function(e){var t=e.onAlertFired,n=e.user,r=e.handleUserUpdate,l=e.isReadOnly,a=e.isGroupAndRoleSeparationEnabled,U=e.showDomain,R=e.permissionsToHide,C=e.hideApplicationRoles,A=(0,u.$)().t,w=J((0,i.useState)(!1),2),P=w[0],I=w[1],j=J((0,i.useState)([]),2),L=j[0],T=j[1],M=J((0,i.useState)([]),2),N=M[0],k=M[1],z=J((0,i.useState)([]),2),D=z[0],_=z[1],V=J((0,i.useState)(void 0),2),B=V[0],q=V[1],K=J((0,i.useState)(void 0),2),Y=K[0],W=K[1],ee=J((0,i.useState)(!1),2),te=ee[0],ne=ee[1],re=J((0,i.useState)(!1),2),le=re[0],oe=re[1],ae=J((0,i.useState)(""),2),se=ae[0],ie=ae[1],ue=J((0,i.useState)(!1),2),ce=ue[0],de=ue[1],pe=J((0,i.useState)(!1),2),me=pe[0],fe=pe[1],ve=J((0,i.useState)(),2),ge=ve[0],he=ve[1],ye=J((0,i.useState)(!1),2),be=ye[0],Ee=ye[1],Se=J((0,i.useState)(!1),2),Ue=Se[0],Oe=Se[1],Re=J((0,i.useState)([]),2),Ze=Re[0],Ce=Re[1],Ae=J((0,i.useState)([]),2),we=Ae[0],Pe=Ae[1],Ie=J((0,i.useState)(!1),2),je=Ie[0],Le=Ie[1],Te=(0,c.v9)((function(e){return e.organization.organization})),Me=(0,i.useMemo)((function(){return F.F.isSuperOrganization(Te)}),[Te]);(0,i.useEffect)((function(){se&&ce&&Xe()}),[ce]),(0,i.useEffect)((function(){ge&&be&&fe(!0)}),[be]),(0,i.useEffect)((function(){Ce(we)}),[we]),(0,i.useEffect)((function(){if(n){if(!C)return Pe(n.roles),xe(),void Ne();Pe(n.roles.filter((function(e){var t,n;return 2!==(null===(t=e.display)||void 0===t?void 0:t.split("/").length)&&"Application"!==(null===(n=e.display)||void 0===n?void 0:n.split("/")[0])}))),xe(),Ne()}}),[n]),(0,i.useEffect)((function(){n&&ke()}),[n.roles&&B]),(0,i.useEffect)((function(){Oe(!0),Me?(0,$.Sd)(null).then((function(e){var t=e.data.Resources;C&&t&&t instanceof Array&&(e.data.Resources=t.filter((function(e){var t;return(null===(t=e.displayName)||void 0===t||!t.includes(Z.Fn))&&e}))),q(e.data.Resources)})).finally((function(){Oe(!1)})):(0,G.Sr)(Te.id,null,100,null).then((function(e){var t=e.Resources;C&&t&&t instanceof Array&&(e.Resources=t.filter((function(e){var t;return(null===(t=e.displayName)||void 0===t||!t.includes(Z.Fn))&&e}))),q(e.Resources)})).finally((function(){Oe(!1)}))}),[]);var Ne=function(){if(a)Ce(C?we:null==n?void 0:n.roles);else{var e,t=[];null==n||null===(e=n.groups)||void 0===e||e.map((function(e){var n,r=null==e||null===(n=e.display)||void 0===n?void 0:n.split("/");if((null==r?void 0:r.length)>1&&(r[0]==Z.Fn||r[0]==Z.eT)){if(C&&"Application"===e[0]&&2===e.length)return;t.push(e)}})),Pe(t),Ce(t)}},ke=function(){var e=B?X(B):[],t=[];if(e&&Y){var n=Array.from(null==Y?void 0:Y.values());(0,p.Z)(e,(function(e){null!=n&&n.includes(e.id)&&t.push(e)}))}k(t),T(e),_(e),ne(e.length===t.length)},xe=function(){var e=new Map;if(a)n.roles&&n.roles instanceof Array&&((0,p.Z)(n.roles,(function(t){var n,r=null==t||null===(n=t.display)||void 0===n?void 0:n.split("/");if((null==r?void 0:r.length)>=1&&null!=t&&t.value){if(C&&"Application"===r[0]&&2===r.length)return;e.set(null==t?void 0:t.display,null==t?void 0:t.value)}})),W(e));else{var t=new Map;n.groups&&n.groups instanceof Array&&((0,p.Z)(n.groups,(function(e){var n,r=null==e||null===(n=e.display)||void 0===n?void 0:n.split("/");if((null==r?void 0:r.length)>=1){if(C&&"Application"===e[0]&&2===e.length)return;null==t||t.set(e.display,e.value)}})),W(t))}},He=function(e,n){var l,a=[];n.map((function(e){a.push(e.id)}));var s={Operations:[],failOnErrors:1,schemas:["urn:ietf:params:scim:api:messages:2.0:BulkRequest"]},i={data:{Operations:[{op:"remove",path:"users[value eq "+e.id+"]"}],schemas:["urn:ietf:params:scim:schemas:core:2.0:Role"]},method:"PATCH"},u={data:{Operations:[{op:"add",value:{users:[{value:e.id}]}}],schemas:["urn:ietf:params:scim:schemas:core:2.0:Role"]},method:"PATCH"},c=[],d=[],p=[],m=[];Y&&(p=X(Y.values())),(null==a?void 0:a.length)>0&&a.map((function(e){var t;null!==(t=p)&&void 0!==t&&t.includes(e)?p.splice(p.indexOf(e),1):m.push(e)})),p&&(null===(l=p)||void 0===l?void 0:l.length)>0&&(p.map((function(e){i=Q(Q({},i),{path:"/Roles/"+e}),c.push(i)})),c.map((function(e){s.Operations.push(e)}))),m&&(null==m?void 0:m.length)>0&&(m.map((function(e){u=Q(Q({},u),{path:"/Roles/"+e}),d.push(u)})),d.map((function(e){s.Operations.push(e)}))),Le(!0),(0,O.fU)(s).then((function(){t({description:A("user:updateUser.roles.notifications.updateUserRoles.success.description"),level:o.QU.SUCCESS,message:A("user:updateUser.roles.notifications.updateUserRoles.success.message")}),I(!1),r(e.id)})).catch((function(e){var n,r,l,a;404!==(null==e||null===(n=e.response)||void 0===n?void 0:n.status)&&(null!=e&&e.response&&null!=e&&null!==(r=e.response)&&void 0!==r&&r.data&&null!=e&&null!==(l=e.response)&&void 0!==l&&null!==(l=l.data)&&void 0!==l&&l.description?t({description:null===(a=e.response)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.description,level:o.QU.ERROR,message:A("user:updateUser.roles.notifications.updateUserRoles.error.message")}):t({description:A("user:updateUser.roles.notifications.updateUserRoles.genericError.description"),level:o.QU.ERROR,message:A("user:updateUser.roles.notifications.updateUserRoles.genericError.message")}))})).finally((function(){Le(!1)}))},Ge=function(e,t){var n=t.value,r=!1,l=[];if((0,m.Z)(n))T(D);else{var o=new RegExp((0,d.Z)(n),"i");L&&L.map((function(e){r=o.test(e.displayName),!U&&e.displayName.split("/").length>1&&(r=o.test(e.displayName.split("/")[1])),r&&(l.push(e),T(l))}))}},Fe=function(){k(te?[]:L),ne(!te)},$e=function(){ke(),I(!0)},ze=function(){ne(!1),I(!1)},De=function(e){var t=null==e?void 0:e.split("/");if((null==t?void 0:t.length)>0)return"Application"==t[0]?{labelColor:null,labelText:"Application",name:"application-label"}:{labelColor:null,labelText:"Internal",name:"internal-label"}},Qe=function(){fe(!me),Ee(!1)},_e=function(){oe(!1),de(!1)},Xe=function(){oe(!0)};return i.createElement(i.Fragment,null,i.createElement(s.X6,{as:"h4"},A("user:updateUser.roles.editRoles.heading")),i.createElement(s.X6,{subHeading:!0,ellipsis:!0,as:"h6"},A("user:updateUser.roles.editRoles.subHeading")),i.createElement(y.Z,{hidden:!0}),i.createElement(v.Z,null,i.createElement(v.Z.Row,null,i.createElement(v.Z.Column,{computer:10,tablet:16,mobile:16},!Ue&&(null==Y?void 0:Y.size)>0?i.createElement(s.pJ,{clearing:!0,"data-testid":"user-mgt-roles-list",className:"user-role-edit-header-segment"},i.createElement(v.Z.Row,null,i.createElement(v.Z.Column,null,i.createElement(b.Z,{"data-testid":"user-mgt-roles-list-search-input",icon:i.createElement(E.Z,{name:"search"}),onChange:function(e,t){var n=t.value,r=!1,l=[];if((0,m.Z)(n))Ce(we);else{var o=new RegExp((0,d.Z)(n),"i");Ze&&(null==Ze||Ze.map((function(e){var t,n=null==e||null===(t=e.display)||void 0===t?void 0:t.split("/");(null==n?void 0:n.length)>=1&&(r=o.test(e.display),!U&&(null==n?void 0:n.length)>1&&(r=o.test(n[1])),r&&(l.push(e),Ce(l)))})))}},placeholder:A("user:updateUser.roles.editRoles.searchPlaceholder"),floated:"left",size:"small"}),!l&&i.createElement(S.Z,{"data-testid":"user-mgt-roles-list-update-button",size:"medium",icon:"pencil",floated:"right",onClick:$e}))),i.createElement(v.Z.Row,null,i.createElement(g.Z,{singleLine:!0,compact:!0},i.createElement(g.Z.Header,null,i.createElement(g.Z.Row,null,U&&i.createElement(g.Z.HeaderCell,null,i.createElement("strong",null,A("user:updateUser.roles.editRoles.roleList.headers.0"))),i.createElement(g.Z.HeaderCell,null,i.createElement("strong",null,A("user:updateUser.roles.editRoles.roleList.headers.1"))),i.createElement(g.Z.HeaderCell,null))),i.createElement(g.Z.Body,null,null==Ze?void 0:Ze.map((function(e,t){var n,r=null==e||null===(n=e.display)||void 0===n?void 0:n.split("/");if((null==r?void 0:r.length)>=1&&null!=e&&e.value)return i.createElement(g.Z.Row,{key:t},U&&("Application"==r[0]?i.createElement(g.Z.Cell,null,i.createElement(h.Z,{className:"application-label"},Z.Fn)):i.createElement(g.Z.Cell,null,i.createElement(h.Z,{className:"internal-label"},Z.eT))),i.createElement(g.Z.Cell,{width:8},1==(null==r?void 0:r.length)?r[0]:r[1]),i.createElement(g.Z.Cell,{textAlign:"right"},i.createElement(s.GI,{content:"View permissions",position:"top right",trigger:i.createElement(E.Z,{"data-testid":"user-mgt-roles-list-\n                                                                                        ".concat(r[1],"-\n                                                                                        permissions-button"),color:"grey",className:"mr-2",name:"key",onClick:function(){return function(e){ie(e),de(!0)}(e.value)}})})))})))))):0===(null==Y?void 0:Y.size)?i.createElement(s.pJ,null,i.createElement(s.$J,{"data-testid":"user-mgt-user-empty-roles-list",title:A("user:updateUser.roles.editRoles.roleList.emptyListPlaceholder.title"),subtitle:[A("user:updateUser.roles.editRoles.roleList.emptyListPlaceholder.subTitle.0"),A("user:updateUser.roles.editRoles.roleList.emptyListPlaceholder.subTitle.1"),A("user:updateUser.roles.editRoles.roleList.emptyListPlaceholder.subTitle.2")],action:!l&&i.createElement(s.KM,{"data-testid":"user-mgt-user-empty-roles-list-assign-group-button",onClick:$e},i.createElement(E.Z,{name:"plus"}),"Assign Role"),image:(0,O.jF)().emptyList,imageSize:"tiny"})):i.createElement(s.pO,null))),i.createElement(x.r,{"data-testid":"user-mgt-roles-list-roles-permission-modal",openRolePermissionModal:le,handleCloseRolePermissionModal:_e,roleId:se,permissionsToHide:R}),i.createElement(f.Z,{"data-testid":"user-mgt-update-roles-modal",open:P,size:"small",className:"user-roles"},i.createElement(f.Z.Header,null,A("user:updateUser.roles.addRolesModal.heading"),i.createElement(s.X6,{subHeading:!0,ellipsis:!0,as:"h6"},A("user:updateUser.roles.addRolesModal.subHeading"))),me?i.createElement(i.Fragment,null,i.createElement(f.Z.Content,null,i.createElement(H.M,{"data-testid":"user-mgt-update-roles-modal-unselected-role-permissions",handleNavigateBack:Qe,roleId:ge})),i.createElement(y.Z,{hidden:!0})):i.createElement(f.Z.Content,{image:!0},Ue?i.createElement(s.pO,null):i.createElement(s.IX,{selectionComponent:!0,searchPlaceholder:A("transferList:searchPlaceholder",{type:"Roles"}),handleUnelectedListSearch:Ge,"data-testid":"user-mgt-update-roles-modal"},i.createElement(s.Jv,{isListEmpty:!((null==L?void 0:L.length)>0),listType:"unselected",listHeaders:U?[A("transferList:list.headers.0"),A("transferList:list.headers.1"),""]:[A("transferList:list.headers.1"),""],handleHeaderCheckboxChange:Fe,isHeaderCheckboxChecked:te,emptyPlaceholderContent:A("transferList:list.emptyPlaceholders.users.roles.unselected",{type:"roles"}),"data-testid":"user-mgt-update-roles-modal-unselected-roles-select-all-checkbox",emptyPlaceholderDefaultContent:A("transferList:list.emptyPlaceholders.default")},null==L?void 0:L.map((function(e,t){var n,r=null==e||null===(n=e.displayName)||void 0===n?void 0:n.split("/");if((null==r?void 0:r.length)>=1)return i.createElement(s.qT,{handleItemChange:function(){return function(e){var t=X(N);null!=t&&t.includes(e)?(t.splice(t.indexOf(e),1),k(t)):(t.push(e),k(t)),ne(t.length===L.length)}(e)},key:t,listItem:(null==r?void 0:r.length)>1?r[1]:r[0],listItemId:e.id,listItemIndex:t,listItemTypeLabel:U?De(null==e?void 0:e.displayName):null,isItemChecked:N.includes(e),showSecondaryActions:!0,handleOpenPermissionModal:function(){return function(e){he(e),Ee(!0)}(e.id)},"data-testid":"user-mgt-update-roles-modal-unselected-roles"})}))))),i.createElement(f.Z.Actions,null,i.createElement(v.Z,null,i.createElement(v.Z.Row,{column:2},i.createElement(v.Z.Column,{mobile:8,tablet:8,computer:8},i.createElement(s.Qj,{"data-testid":"user-mgt-update-roles-modal-cancel-button",floated:"left",onClick:ze},A("common:cancel"))),i.createElement(v.Z.Column,{mobile:8,tablet:8,computer:8},i.createElement(s.KM,{"data-testid":"user-mgt-update-roles-modal-save-button",floated:"right",loading:je,disabled:je,onClick:function(){return He(n,N)}},A("common:save")))))))))};q.defaultProps={hideApplicationRoles:!1,showDomain:!0};var K=n(12104),Y=n(61145),W=n(61263),ee=n(84902),te=n(40518),ne=n(18867),re=n(71527);const le=function(){var e=(0,i.useContext)(re.Z);if(!e)throw new Error("useUserManagement must be used within a UserManagementProvider");return e};function oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,l,o,a,s=[],i=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);i=!0);}catch(e){u=!0,l=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw l}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ae(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var se=function(e){var t,n=e.user,d=e.handleUserUpdate,p=e.featureConfig,m=e.readOnlyUserStores,f=e.connectorProperties,v=e.isLoading,g=e.isReadOnlyUserStoresLoading,h=(0,u.$)().t,y=le(),b=y.activeTab,E=y.updateActiveTab,S=(0,c.I0)(),O=(0,ee.z)().isSuperOrganization,R=(0,r.Z)().UIConfig,Z=(0,c.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.allowedScopes})),C=(0,c.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t?void 0:t.isGroupAndRoleSeparationEnabled})),A=null==R||null===(t=R.legacyMode)||void 0===t?void 0:t.rolesV1,w=oe((0,i.useState)(!1),2),P=w[0],I=w[1],j=oe((0,i.useState)(!1),2),L=j[0],T=j[1],x=oe((0,i.useState)(!1),2),H=x[0],G=x[1],F=oe((0,i.useState)(!1),2),$=F[0],z=F[1],D=oe((0,i.useState)(!1),2),Q=D[0],_=D[1],X=oe((0,i.useState)(null),2),J=X[0],V=X[1],B=oe((0,i.useState)(!1),2),re=B[0],ae=B[1],se=oe((0,i.useState)(!1),2),ie=se[0],ue=se[1];(0,i.useEffect)((function(){var e,t,r,o,a=(null==n||null===(e=n.userName)||void 0===e?void 0:e.split("/").length)>1?null==n||null===(t=n.userName)||void 0===t?void 0:t.split("/")[0]:U.userstoresConfig.primaryUserstoreName;(!(0,l.cr)(null==p?void 0:p.users,ne._F.FEATURE_DICTIONARY.get("USER_UPDATE"))||null!=m&&m.includes(null==a?void 0:a.toString())||!(0,l.Xr)(null==p?void 0:p.users,null==p||null===(r=p.users)||void 0===r||null===(r=r.scopes)||void 0===r?void 0:r.update,Z)||null!==(o=n[Y.SCIMConfigs.scim.enterpriseSchema])&&void 0!==o&&o.userSourceId)&&I(!0)}),[n,m]),(0,i.useEffect)((function(){O()&&de()}),[n]),(0,i.useEffect)((function(){var e;null!==(e=n[Y.SCIMConfigs.scim.enterpriseSchema])&&void 0!==e&&e.managedOrg&&(ae(!0),ue(!0))}),[n]);var ce=function(e){S((0,a.V_)(e))},de=function(){z(!0),(0,te.Un)().then((function(e){var t=W.h.getState().profile.profileInfo.userName,r=null==e?void 0:e.realmConfig.adminUser;V(r),t===r&&T(!0),(null==n?void 0:n.userName)===r&&G(!0)})).catch((function(e){_(!0),e.response&&e.response.data&&(e.response.data.description||e.response.data.detail)?S((0,a.V_)({description:e.response.data.description||e.response.data.detail,level:o.QU.ERROR,message:h("users:userSessions.notifications.getAdminUser.error.message")})):S((0,a.V_)({description:h("users:userSessions.notifications.getAdminUser.genericError.description"),level:o.QU.ERROR,message:h("users:userSessions.notifications.getAdminUser.genericError.message")}))})).finally((function(){z(!1)}))};return i.createElement(s.M$,{activeIndex:b,isLoading:v,onTabChange:function(e,t){E(t.activeIndex)},panes:[{menuItem:h("users:editUser.tab.menuItems.0"),render:function(){return i.createElement(s.M$.Pane,{controlledSegmentation:!0,attached:!1},i.createElement(N.I,{adminUsername:J,onAlertFired:ce,user:n,handleUserUpdate:d,isReadOnly:P||ie,connectorProperties:f,isReadOnlyUserStoresLoading:g,isUserManagedByParentOrg:re,adminUserType:ne.lu.INTERNAL}))}},{menuItem:h("users:editUser.tab.menuItems.1"),render:function(){return i.createElement(s.M$.Pane,{controlledSegmentation:!0,attached:!1},i.createElement(M,{onAlertFired:ce,user:n,handleUserUpdate:d,isReadOnly:P}))}},O()&&A?{menuItem:h("users:editUser.tab.menuItems.2"),render:function(){return i.createElement(s.M$.Pane,{controlledSegmentation:!0,attached:!1},i.createElement(q,{isGroupAndRoleSeparationEnabled:C,onAlertFired:ce,user:n,handleUserUpdate:d,isReadOnly:P}))}}:null,O()&&!A?{menuItem:h("users:editUser.tab.menuItems.2"),render:function(){return i.createElement(s.M$.Pane,{controlledSegmentation:!0,attached:!1},i.createElement(k.e,{user:n}))}}:null,{menuItem:h("users:editUser.tab.menuItems.3"),render:function(){return i.createElement(s.M$.Pane,{controlledSegmentation:!0,attached:!1},i.createElement(K.Y,{user:n,showSessionTerminationButton:!$&&!Q&&(H&&L||!H&&L||!H&&!L)}))}}]})}},71527:(e,t,n)=>{n.d(t,{Z:()=>l});var r=(0,n(44194).createContext)(null);r.displayName="UserManagementContext";const l=r},86898:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(44194),l=n(71527);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,l,o,a,s=[],i=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);i=!0);}catch(e){u=!0,l=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw l}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const s=function(e){var t=e.children,n=o((0,r.useState)(0),2),a=n[0],s=n[1];return r.createElement(l.Z.Provider,{value:{activeTab:a,updateActiveTab:s}},t)}}}]);