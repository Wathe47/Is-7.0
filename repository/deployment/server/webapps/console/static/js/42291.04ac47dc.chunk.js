"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[42291],{42291:(e,t,n)=>{n.r(t),n.d(t,{default:()=>pe});var o=n(24184),r=n(54833),a=n(93129),i=n(3356),l=n(86727),c=n(44194),u=n(10479),s=n(47245),m=n(75246),p=n(24393),d=n(34148),f=n(67442),g=n(73508);function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){var o;return o=function(e,t){if("object"!=v(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=v(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==v(o)?o:o+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=d.AsgardeoSPAClient.getInstance().httpRequest.bind(d.AsgardeoSPAClient.getInstance()).bind(d.AsgardeoSPAClient.getInstance()),T=n(20812),S=n(89141);function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=a.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw r}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var O=function(e){var t,n=e.isEmailTemplatesListLoading,r=e.selectedEmailTemplate,a=e.selectedLocale,i=e.onTemplateChanged,m=e.onSubmit,d=e.onDeleteRequested,f=e.readOnly,g=e["data-componentid"],v=(0,u.$)().t,b=(0,l.fQ)().getLink,y=(0,s.v9)((function(e){return e.config.ui.features})),h=w((0,c.useState)(0),2),E=h[0],A=h[1];return(0,c.useEffect)((function(){A((E+1)%100)}),[r]),n?c.createElement(l.pO,null):c.createElement(c.Fragment,null,c.createElement(T.l0,{id:"email-customization-content-form",uncontrolledForm:!0,onSubmit:m,"data-componentid":g},c.createElement(S.Z,null,c.createElement(S.Z.Row,null,c.createElement(S.Z.Column,{mobile:16,computer:8},c.createElement(T.gN.Input,{ariaLabel:"Email Subject Input",inputType:"default",name:"emailSubject",label:v("extensions:develop.emailTemplates.form.inputs.subject.label"),placeholder:v("extensions:develop.emailTemplates.form.inputs.subject.placeholder"),hint:v("extensions:develop.emailTemplates.form.inputs.subject.hint"),required:!0,value:null==r?void 0:r.subject,maxLength:255,minLength:1,"data-componentid":"".concat(g,"-email-subject"),listen:function(e){i({subject:e})},readOnly:f,key:E}))),c.createElement(S.Z.Row,null,c.createElement(S.Z.Column,{mobile:16,computer:8},c.createElement(l.X6,{as:"h6"},v("extensions:develop.emailTemplates.form.inputs.body.label")),c.createElement(l.v0,{type:"info",content:c.createElement(c.Fragment,null,v("extensions:develop.emailTemplates.form.inputs.body.hint"),c.createElement(l.eb,{link:b("develop.emailCustomization.form.emailBody.learnMore")},v("extensions:common.learnMore")))}))),c.createElement(S.Z.Row,null,c.createElement(S.Z.Column,{mobile:16,computer:16},c.createElement("div",{className:"code-editor-wrapper"},c.createElement(l.pq,{lint:!0,allowFullScreen:!0,smart:!0,controlledFullScreenMode:!1,language:"htmlmixed",sourceCode:null==r?void 0:r.body,lineWrapping:!0,onChange:function(e,t,n){i({body:e.getValue()})},height:"500px",theme:"light",translations:{copyCode:v("common:copyToClipboard"),exitFullScreen:v("common:exitFullScreen"),goFullScreen:v("common:goFullScreen")},"data-componentId":"".concat(g,"-email-body-editor"),readOnly:f})))),c.createElement(S.Z.Row,null,c.createElement(S.Z.Column,{mobile:16,computer:8},c.createElement(T.gN.Input,{ariaLabel:"Email Footer Input",inputType:"default",name:"emailFooter",label:v("extensions:develop.emailTemplates.form.inputs.footer.label"),placeholder:v("extensions:develop.emailTemplates.form.inputs.footer.placeholder"),hint:v("extensions:develop.emailTemplates.form.inputs.footer.hint"),required:!1,value:null==r?void 0:r.footer,maxLength:255,minLength:1,"data-componentid":"".concat(g,"-email-footer"),listen:function(e){i({footer:e})},readOnly:f,key:E}))))),c.createElement(o.di,{when:null==y||null===(t=y.emailTemplates)||void 0===t||null===(t=t.scopes)||void 0===t?void 0:t.delete},c.createElement(l.cN,{"data-componentid":"".concat(g,"-revert-email-provider-config"),actionTitle:v("extensions:develop.emailTemplates.dangerZone.action"),header:v("extensions:develop.emailTemplates.dangerZone.heading"),subheader:v("extensions:develop.emailTemplates.dangerZone.message"),isButtonDisabled:a===p.bx.DEFAULT_FALLBACK_LANGUAGE,buttonDisableHint:v("extensions:develop.emailTemplates.dangerZone.actionDisabledHint"),onActionClick:d})))};O.defaultProps={"data-componentid":"email-customization-form"};var j=n(14045),_=n(19907),L=n(77176),P=n(93140),x=n(90696),F=n(76543);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function k(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,R(o.key),o)}}function R(e){var t=function(e,t){if("object"!=C(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=C(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==C(t)?t:t+""}var D,U,I,z=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},n=[{key:"getTemplateBody",value:function(e,t,n,o,r){var a,i,l,c=o;if(!(null==t||null===(a=t.theme[null==t||null===(i=t.theme)||void 0===i?void 0:i.activeTheme])||void 0===a||null===(a=a.images)||void 0===a||null===(a=a.logo)||void 0===a||!a.imgURL)||(c=c.replace(/alt="{{organization.logo.altText}}"/g,"").replace(/src="{{organization.logo.img}}"/g,"")),!t)return c.replace(/{{organization.color.background}}/g,this.brandingFallBackValues.background_color).replace(/{{organization.color.primary}}/g,this.brandingFallBackValues.primary_color).replace(/{{organization.theme.background.color}}/g,this.brandingFallBackValues.light_background_color).replace(/{{organization.theme.border.color}}/g,this.brandingFallBackValues.light_border_color).replace(/{{organization.font}}/g,this.brandingFallBackValues.font_style).replace(/{{organization.font.color}}/g,this.brandingFallBackValues.font_color).replace(/{{organization.button.font.color}}/g,this.brandingFallBackValues.button_font_color).replace(/{{organization-name}}/g,e).replace(/{{organization.logo.img}}/g,this.brandingFallBackValues.light_logo_url);var u=P.t.migrateThemePreference(t,{theme:r}),s=u.organizationDetails,m=s.copyrightText,p=s.supportEmail,d=s.displayName,f=u.theme,g=f[f.activeTheme],v=f.activeTheme===x.gf.DARK?this.brandingFallBackValues.dark_logo_url:this.brandingFallBackValues.light_logo_url;return c=c.replace(/{{organization.color.background}}/g,g.colors.background.body.main).replace(/{{organization.color.primary}}/g,g.colors.primary.main).replace(/{{organization.theme.background.color}}/g,g.colors.background.surface.main?g.colors.background.surface.main:f.activeTheme===x.gf.DARK?"#111111":"#FFFFFF").replace(/{{organization.theme.border.color}}/g,g.colors.outlined.default?g.colors.outlined.default:f.activeTheme===x.gf.DARK?"#333333":"transparent").replace(/{{organization.font}}/g,g.typography.font.fontFamily).replace(/{{organization.font.color}}/g,g.colors.text.primary).replace(/{{organization.button.font.color}}/g,g.buttons.primary.base.font.color).replace(/{{organization-name}}/g,d||e).replace(/{{organization.logo.img}}/g,g.images.logo.imgURL||v).replace(/{{organization.logo.altText}}/g,g.images.logo.altText).replace(/{{organization.copyright.text}}/g,null!==(l=n&&(0,F.Z)(n.copyright))&&void 0!==l?l:m).replace(/{{organization.support.mail}}/g,p)}}],(t=null)&&k(e.prototype,t),n&&k(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e,t,n){var o;return o=function(e,t){if("object"!=M(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=M(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==M(o)?o:o+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=a.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw r}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}D=z,I={background_color:"#F8F9FA",button_font_color:"#FFFFFF",copyright_text:"&#169; YYYY WSO2 LLC.",dark_background_color:"#111111",dark_border_color:"#333333",dark_logo_url:"",font_color:"#231F20",font_style:"Montserrat",light_background_color:"#FFFFFF",light_border_color:"transparent",light_logo_url:"",primary_color:"#FF7300"},(U=R(U="brandingFallBackValues"))in D?Object.defineProperty(D,U,{value:I,enumerable:!0,configurable:!0,writable:!0}):D[U]=I;var G=function(e){var t=e.emailTemplate,n=e["data-componentid"],o=(0,L.Z)(),r=o.preference,a=o.customText,i=Z((0,c.useState)(!1),2)[1],u=Z((0,c.useState)(_.H.DEFAULT_PREFERENCE.theme),2),m=u[0],p=u[1],d=(0,s.v9)((function(e){var t;return null==e||null===(t=e.organization)||void 0===t||null===(t=t.organization)||void 0===t?void 0:t.name})),f=(0,s.v9)((function(e){var t;return null===(t=e.config.ui.theme)||void 0===t?void 0:t.name})),g=(0,c.useMemo)((function(){return null!=t&&t.body?z.getTemplateBody(d,null==r?void 0:r.preference,a,null==t?void 0:t.body,m):""}),[null==t?void 0:t.body,d,null==r?void 0:r.preference,m]);return(0,c.useEffect)((function(){f&&P.t.getPredefinedThemePreferences(f).then((function(e){p(V(V({},m),e))}))}),[f]),c.createElement("div",{className:"email-template-preview","data-componentid":n},c.createElement(l.hv,{isReady:i,"data-componentid":"".concat(n,"-iframe"),className:"email-template-preview-iframe"},c.createElement("div",{dangerouslySetInnerHTML:{__html:j.Encode.forHtml(g)},"data-componentid":"".concat(n,"-iframe-body-div")})))};G.defaultProps={"data-componentid":"email-customization-preview"};var Q=n(19980),$=function(e){var t=e["data-componentid"],n=e.isSaveButtonLoading,o=e.onSaveButtonClick,r=(0,u.$)().t;return c.createElement(Q.Z,{className:"email-customization-footer",attached:"bottom",padded:!0,"data-componentid":t},c.createElement(l.KM,{size:"small",loading:n,onClick:function(e,t){o(e,t)},ariaLabel:"Email Templates form save button","data-componentid":"".concat(t,"-save-button")},r("common:save")))};$.defaultProps={"data-componentid":"email-customization-footer"};const K=$;function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=a.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw r}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var X=function(e){var t=e.selectedEmailTemplateId,n=e.selectedEmailTemplateDescription,o=e.selectedLocale,r=e.emailTemplatesList,a=e.onTemplateSelected,i=e.onLocaleChanged,l=e["data-componentid"],m=(0,u.$)().t,p=Y((0,c.useState)(void 0),2),d=p[0],f=p[1],g=(0,s.v9)((function(e){return e.global.supportedI18nLanguages})),v=(0,c.useMemo)((function(){return null==r?void 0:r.map((function(e){return{text:e.displayName,value:e.id}}))}),[r]);return(0,c.useEffect)((function(){if(g){var e=[];Object.keys(g).map((function(t){e.push({key:g[t].code,text:c.createElement("div",null,c.createElement("i",{className:g[t].flag+" flag"}),g[t].name,", ",g[t].code),value:g[t].code})})),f(e)}}),[g]),c.createElement(Q.Z,{className:"mb-4 p-4","data-componentid":l,padded:"very"},c.createElement(T.l0,{id:"email-customization-header-form",uncontrolledForm:!0,onSubmit:function(){}},c.createElement(S.Z,null,c.createElement(S.Z.Column,{mobile:16,computer:8},c.createElement(T.gN.Dropdown,{ariaLabel:"Email Template Dropdown",name:"selectedEmailTemplate",label:m("extensions:develop.emailTemplates.form.inputs.template.label"),options:v,required:!0,"data-componentid":"".concat(l,"-email-template-list"),hint:null!=n?n:null,placeholder:m("extensions:develop.emailTemplates.form.inputs.template.placeholder"),value:t,listen:a})),c.createElement(S.Z.Column,{mobile:16,computer:8},c.createElement(T.gN.Dropdown,{ariaLabel:"Email Template Locale Dropdown",name:"selectedEmailTemplateLocale",label:m("extensions:develop.emailTemplates.form.inputs.locale.label"),options:d,required:!0,"data-componentid":"".concat(l,"-email-template-locale"),placeholder:m("extensions:develop.emailTemplates.form.inputs.locale.placeholder"),defaultValue:o,value:o,listen:i})))))};X.defaultProps={"data-componentid":"email-customization-header"};const W=X;function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function ee(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,oe(o.key),o)}}function te(e,t,n){return t&&ee(e.prototype,t),n&&ee(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ne(e,t,n){return(t=oe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(e){var t=function(e,t){if("object"!=J(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=J(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==J(t)?t:t+""}var re=te((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}));function ae(e){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ae(e)}function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ce(e,t,n){var o;return o=function(e,t){if("object"!=ae(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=ae(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==ae(o)?o:o+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=a.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw r}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}ne(re,"DEFAULT_CONTENT_TYPE","text/html; charset=UTF-8"),ne(re,"FEATURE_DICTIONARY",(new Map).set("EMAIL_TEMPLATES_CREATE","emailTemplates.create").set("EMAIL_TEMPLATES_UPDATE","emailTemplates.update").set("EMAIL_TEMPLATES_DELETE","emailTemplates.delete").set("EMAIL_TEMPLATES_READ","emailTemplates.read"));var me=function(e){var t,n,d,v,b,h=e["data-componentid"],T=ue((0,c.useState)([]),2),S=T[0],w=T[1],A=ue((0,c.useState)(),2),j=A[0],_=A[1],L=ue((0,c.useState)(),2),P=L[0],x=L[1],F=ue((0,c.useState)(p.bx.DEFAULT_FALLBACK_LANGUAGE),2),C=F[0],k=F[1],R=ue((0,c.useState)(),2),D=R[0],U=R[1],I=ue((0,c.useState)(),2),z=I[0],M=I[1],N=ue((0,c.useState)(!1),2),V=N[0],B=N[1],Z=ue((0,c.useState)(!1),2),q=Z[0],Q=Z[1],$=(0,s.v9)((function(e){return e.config.deployment.extensions.emailTemplates})),Y=(0,s.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t?void 0:t.enableCustomEmailTemplates})),H=(0,s.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t||null===(t=t.features)||void 0===t?void 0:t.emailTemplates})),X=(0,s.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.allowedScopes})),J=(0,s.v9)((function(e){return e.config.ui.features})),ee=(0,s.I0)(),te=(0,u.$)().t,ne=(0,l.fQ)().getLink,oe=(0,c.useMemo)((function(){var e;return!(0,r.cr)(H,re.FEATURE_DICTIONARY.get("EMAIL_TEMPLATES_UPDATE"))||!(0,r.Xr)(H,null==H||null===(e=H.scopes)||void 0===e?void 0:e.update,X)}),[H,X]),ae=(0,c.useMemo)((function(){var e;return(0,r.cr)(H,re.FEATURE_DICTIONARY.get("EMAIL_TEMPLATES_CREATE"))&&(0,r.Xr)(H,null==H||null===(e=H.scopes)||void 0===e?void 0:e.create,X)}),[H,X]),ie=(n={headers:{Accept:"application/json","Content-Type":"application/json"},method:a.f2.GET,url:"".concat(p.h.getState().config.endpoints.emailManagement,"/template-types")},d=(0,g.Z)(n),v=d.data,b=d.error,{data:v,error:b,isLoading:!b&&!v,isValidating:d.isValidating,mutate:d.mutate}),ce=ie.data,se=ie.isLoading,me=ie.error,pe=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.bx.DEFAULT_FALLBACK_LANGUAGE).replace("-","_"),n={headers:{Accept:"application/json","Content-Type":"application/json"},method:a.f2.GET,url:p.h.getState().config.endpoints.emailManagement+"/template-types/".concat(e,"/templates/").concat(t)},o=(0,g.Z)(n,{onErrorRetry:function(e){e.response.status}}),r=o.data,i=o.error;return{data:r,error:i,isLoading:!i&&!r,isValidating:o.isValidating,mutate:o.mutate}}(j,C),de=pe.data,fe=pe.isLoading,ge=pe.error,ve=pe.mutate;(0,c.useEffect)((function(){var e,t,n=ce?(Y?ce:ce.filter((function(e){return null==$?void 0:$.find((function(t){return t.id===e.id}))}))).map((function(e){var t=null==$?void 0:$.find((function(t){return t.id===e.id}));return le(le({},e),{},{description:(null==t?void 0:t.description)||"".concat(e.displayName," Template"),displayName:(null==t?void 0:t.displayName)||e.displayName})})):[];(w(n),j)||(_(null==n||null===(e=n[0])||void 0===e?void 0:e.id),x(null==n||null===(t=n[0])||void 0===t?void 0:t.description))}),[ce]),(0,c.useEffect)((function(){U(le({},de)),Q(!1),de&&Object.keys(de).length>0&&M(le({},de))}),[de]),(0,c.useEffect)((function(){var e,t;me&&(me.response.data.description?ee((0,i.V_)({description:null===(e=me.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.description,level:a.QU.ERROR,message:null!==(t=me.response.data.message)&&void 0!==t?t:te("extensions:develop.emailTemplates.notifications.getEmailTemplateList.error.message")})):ee((0,i.V_)({description:te("extensions:develop.emailTemplates.notifications.getEmailTemplateList.error.description"),level:a.QU.ERROR,message:te("extensions:develop.emailTemplates.notifications.getEmailTemplateList.error.message")})))}),[me]),(0,c.useEffect)((function(){if(ge&&j){if(404===ge.response.status){if(Q(!0),ae)return void B(!0);M(void 0)}var e,t;if(ge.response.data.description)ee((0,i.V_)({description:null===(e=ge.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.description,level:a.QU.ERROR,message:null!==(t=ge.response.data.message)&&void 0!==t?t:te("extensions:develop.emailTemplates.notifications.getEmailTemplate.error.message")}));else ee((0,i.V_)({description:te("extensions:develop.emailTemplates.notifications.getEmailTemplate.error.description"),level:a.QU.ERROR,message:te("extensions:develop.emailTemplates.notifications.getEmailTemplate.error.message")}))}}),[ge]),(0,c.useEffect)((function(){var e=window.location.hash;if(e.startsWith("#templateId=")){var t,n=e.split("=")[1];_(n),x(null==S||null===(t=S.find((function(e){return e.id===n})))||void 0===t?void 0:t.description)}}),[window.location.hash]);var be,ye=function(){var e=le(le({},D),{},{id:C.replace("-","_")});null!=e&&e.contentType||(e.contentType=re.DEFAULT_CONTENT_TYPE),q?function(e,t){var n={data:y({},t),headers:{Accept:"application/json","Content-Type":"application/json"},method:a.f2.POST,url:p.h.getState().config.endpoints.emailManagement+"/template-types/".concat(e)};return E(n).then((function(e){if(200!==e.status&&201!==e.status)throw new f.u("Error occurred while creating the email template.",null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){var t;throw new f.u("Error occurred while creating the email template.",e.stack,null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.code,e.request,e.response,e.config)}))}(j,e).then((function(e){ee((0,i.V_)({description:te("extensions:develop.emailTemplates.notifications.updateEmailTemplate.success.description"),level:a.QU.SUCCESS,message:te("extensions:develop.emailTemplates.notifications.updateEmailTemplate.success.message")}))})).catch((function(e){var t;ee((0,i.V_)({description:te("extensions:develop.emailTemplates.notifications.updateEmailTemplate.error.description"),level:a.QU.ERROR,message:null!==(t=e.message)&&void 0!==t?t:te("extensions:develop.emailTemplates.notifications.updateEmailTemplate.error.message")}))})).finally((function(){return ve()})):function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:p.bx.DEFAULT_FALLBACK_LANGUAGE).replace("-","_"),o={data:y({},t),headers:{Accept:"application/json","Content-Type":"application/json"},method:a.f2.PUT,url:p.h.getState().config.endpoints.emailManagement+"/template-types/".concat(e,"/templates/").concat(n)};return E(o).then((function(e){if(200!==e.status&&201!==e.status)throw new f.u("Error occurred while updating the email template.",null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){var t;throw new f.u("Error occurred while updating the email template.",e.stack,null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.code,e.request,e.response,e.config)}))}(j,e,C).then((function(e){ee((0,i.V_)({description:te("extensions:develop.emailTemplates.notifications.updateEmailTemplate.success.description"),level:a.QU.SUCCESS,message:te("extensions:develop.emailTemplates.notifications.updateEmailTemplate.success.message")}))})).catch((function(e){var t;ee((0,i.V_)({description:te("extensions:develop.emailTemplates.notifications.updateEmailTemplate.error.description"),level:a.QU.ERROR,message:null!==(t=e.message)&&void 0!==t?t:te("extensions:develop.emailTemplates.notifications.updateEmailTemplate.error.message")}))})).finally((function(){return ve()})),Q(!1)},he=function(){(function(e,t){var n=t.replace("-","_"),o={headers:{Accept:"application/json","Content-Type":"application/json"},method:a.f2.DELETE,url:p.h.getState().config.endpoints.emailManagement+"/template-types/".concat(e,"/templates/").concat(n)};return E(o).then((function(e){if(204!==e.status)throw new f.u("Error occurred while deleting the email template.",null,e.status,e.request,e,e.config);return e})).catch((function(e){var t;throw new f.u("Error occurred while deleting the email template.",e.stack,null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.code,e.request,e.response,e.config)}))})(j,C).then((function(e){ee((0,i.V_)({description:te("extensions:develop.emailTemplates.notifications.deleteEmailTemplate.success.description"),level:a.QU.SUCCESS,message:te("extensions:develop.emailTemplates.notifications.deleteEmailTemplate.success.message")}))})).catch((function(e){var t;ee((0,i.V_)({description:te("extensions:develop.emailTemplates.notifications.deleteEmailTemplate.error.description"),level:a.QU.ERROR,message:null!==(t=e.message)&&void 0!==t?t:te("extensions:develop.emailTemplates.notifications.deleteEmailTemplate.error.message")}))})).finally((function(){k(p.bx.DEFAULT_FALLBACK_LANGUAGE)}))};return c.createElement(m.Z,null,c.createElement(l.Xg,{title:te("extensions:develop.emailTemplates.page.header"),pageTitle:"Email Templates",description:c.createElement(c.Fragment,null,te("extensions:develop.emailTemplates.page.description"),c.createElement(l.eb,{link:ne("develop.emailCustomization.learnMore")},te("extensions:common.learnMore"))),titleTextAlign:"left",bottomMargin:!1,"data-componentid":h},c.createElement(W,{selectedEmailTemplateId:j,selectedEmailTemplateDescription:P,selectedLocale:C,emailTemplatesList:S,onTemplateSelected:function(e){var t;Q(!1),M(void 0),k(p.bx.DEFAULT_FALLBACK_LANGUAGE),_(e),x(null==S||null===(t=S.find((function(t){return t.id===e})))||void 0===t?void 0:t.description)},onLocaleChanged:function(e){M(le({},D)),Q(!1),k(e)}}),c.createElement(l.M$,{attached:"top",secondary:!1,pointing:!1,panes:(be=[],be.push({menuItem:te("extensions:develop.emailTemplates.tabs.preview.label"),render:function(){return c.createElement(l.M$.Pane,{className:"email-template-resource-tab-pane",attached:"bottom","data-componentid":"email-customization-template-preview"},c.createElement(G,{emailTemplate:D||z}))}}),be.push({menuItem:te("extensions:develop.emailTemplates.tabs.content.label"),render:function(){return c.createElement(l.M$.Pane,{className:"email-template-resource-tab-pane",attached:"bottom","data-componentid":"email-customization-template-content"},c.createElement(O,{isEmailTemplatesListLoading:se||fe,selectedEmailTemplate:z,selectedLocale:C,onTemplateChanged:function(e){return function(e){U(le(le({},D),e))}(e)},onSubmit:ye,onDeleteRequested:he,readOnly:oe||q&&!ae}))}}),be),onTabChange:function(){M(D)},"data-componentid":"".concat(h,"-forms")}),c.createElement(o.di,{when:null==J||null===(t=J.emailTemplates)||void 0===t||null===(t=t.scopes)||void 0===t?void 0:t.update},(!q||ae)&&c.createElement(K,{isSaveButtonLoading:se||fe,onSaveButtonClick:ye})),c.createElement(l.cV,{type:"info",open:V,primaryAction:te("common:confirm"),secondaryAction:te("common:cancel"),onSecondaryActionClick:function(){return U(void 0),M(void 0),void B(!1)},onPrimaryActionClick:function(){return U(z),void B(!1)},"data-componentid":"".concat(h,"-replicate-previous-template-confirmation-modal"),closeOnDimmerClick:!1},c.createElement(l.cV.Header,{"data-componentid":"".concat(h,"-replicate-previous-template-confirmation-modal-header")},te("extensions:develop.emailTemplates.modal.replicateContent.header")),c.createElement(l.cV.Message,{attached:!0,info:!0,"data-componentid":"".concat(h,"-replicate-previous-template-confirmation-modal-message")},te("extensions:develop.emailTemplates.modal.replicateContent.message")))))};me.defaultProps={"data-componentid":"email-customization-page"};const pe=me}}]);