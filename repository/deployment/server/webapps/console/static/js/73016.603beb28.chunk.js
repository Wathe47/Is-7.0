"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[73016],{48585:(e,t,n)=>{n.r(t),n.d(t,{AllUsersList:()=>E});var i=n(54833),s=n(86727),r=n(44194),l=n(10479),a=n(47245),o=n(12638),u=n(26154),c=n(24393),d=n(18867),m=n(67858),p=n(61145),v=n(17507),g=n(31659),f=n(78645);function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,s,r,l,a=[],o=!0,u=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(i=r.call(n)).done)&&(a.push(i.value),a.length!==t);o=!0);}catch(e){u=!0,s=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw s}}return a}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var E=function(e){var t,n=e.defaultListItemLimit,y=e.isLoading,E=e.readOnlyUserStores,S=e.featureConfig,C=e.onColumnSelectionChange,T=e.onListItemClick,A=e.realmConfigs,N=e.selection,R=e.showListItemActions,U=e.allUsersList,b=e.onSearchQueryClear,I=e.searchQuery,_=e.handleConsumerUserDelete,w=e.handleGuestUserDelete,L=e["data-testid"],O=(0,l.$)().t,k=h((0,r.useState)(!1),2),F=k[0],x=k[1],D=h((0,r.useState)(void 0),2),M=D[0],P=D[1],j=h((0,s.ZK)(),3),V=j[0],G=j[1],H=j[2],Z=h((0,r.useState)({}),2),z=Z[0],Q=Z[1],Y=h((0,r.useState)(""),2),X=Y[0],$=Y[1],J=h((0,r.useState)(!1),2),B=J[0],q=J[1],K=(0,a.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.username}));(0,r.useEffect)((function(){A&&$(null==A?void 0:A.adminUser)}),[A]),(0,r.useEffect)((function(){U&&Q(U)}),[U]);var W=(0,a.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.allowedScopes})),ee=function(e){(0,i.tF)(e.userName)===f.userstoresConfig.primaryUserstoreName?c.m8.push(v.AdministratorConstants.getPaths().get("CUSTOMER_USER_EDIT_PATH").replace(":id",e.id)):c.m8.push(v.AdministratorConstants.getPaths().get("COLLABORATOR_USER_EDIT_PATH").replace(":id",e.id))},te=function(){return I&&0===(null==z?void 0:z.totalResults)?r.createElement(s.$J,{action:r.createElement(s.Qj,{onClick:b},O("users:usersList.search.emptyResultPlaceholder.clearButton")),image:(0,c.jF)().emptySearch,imageSize:"tiny",title:O("users:usersList.search.emptyResultPlaceholder.title"),subtitle:[O("users:usersList.search.emptyResultPlaceholder.subTitle.0",{query:I}),O("users:usersList.search.emptyResultPlaceholder.subTitle.1")]}):0===(null==z?void 0:z.totalResults)?r.createElement(s.$J,{"data-testid":"".concat(L,"-empty-placeholder"),image:(0,c.jF)().newList,imageSize:"tiny",title:O("users:usersList.list.emptyResultPlaceholder.title"),subtitle:[O("users:usersList.list.emptyResultPlaceholder.subTitle.0"),O("users:usersList.list.emptyResultPlaceholder.subTitle.1"),O("users:usersList.list.emptyResultPlaceholder.subTitle.2")]}):null};return r.createElement(r.Fragment,null,r.createElement(s.wQ,{className:"users-table",isLoading:y,loadingStateOptions:{count:null!=n?n:c.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT,imageType:"circular"},actions:function(){if(R){var e=[{"data-testid":"all-users-list-item-edit-button",hidden:function(){return!(0,i.cr)(null==S?void 0:S.users,d._F.FEATURE_DICTIONARY.get("USER_READ"))},icon:function(e){var t,n,s,r=(null==e||null===(t=e.userName)||void 0===t?void 0:t.split("/").length)>1?null==e||null===(n=e.userName)||void 0===n?void 0:n.split("/")[0]:v.AdministratorConstants.ASGARDEO_USERSTORE;return!(0,i.Xr)(null==S?void 0:S.users,null==S||null===(s=S.users)||void 0===s||null===(s=s.scopes)||void 0===s?void 0:s.update,W)||!(0,i.cr)(null==S?void 0:S.users,d._F.FEATURE_DICTIONARY.get("USER_UPDATE"))||null!=E&&E.includes(r.toString())?"eye":"pencil alternate"},onClick:function(e,t){return ee(t)},popupText:function(e){var t,n,s,r=(null==e||null===(t=e.userName)||void 0===t?void 0:t.split("/").length)>1?null==e||null===(n=e.userName)||void 0===n?void 0:n.split("/")[0]:v.AdministratorConstants.ASGARDEO_USERSTORE;return!(0,i.Xr)(null==S?void 0:S.users,null==S||null===(s=S.users)||void 0===s||null===(s=s.scopes)||void 0===s?void 0:s.update,W)||!(0,i.cr)(null==S?void 0:S.users,d._F.FEATURE_DICTIONARY.get("USER_UPDATE"))||null!=E&&E.includes(r.toString())?O("common:view"):O("common:edit")},renderer:"semantic-icon"}];return e.push({"data-testid":"all-users-list-item-delete-button",hidden:function(e){var t,n,s,r=(null==e||null===(t=e.userName)||void 0===t?void 0:t.split("/").length)>1?null==e||null===(n=e.userName)||void 0===n?void 0:n.split("/")[0]:v.AdministratorConstants.ASGARDEO_USERSTORE;return!(0,i.cr)(null==S?void 0:S.users,d._F.FEATURE_DICTIONARY.get("USER_DELETE"))||!(0,i.Xr)(null==S?void 0:S.users,null==S||null===(s=S.users)||void 0===s||null===(s=s.scopes)||void 0===s?void 0:s.delete,W)||(null==E?void 0:E.includes(r.toString()))||e.userName===(null==A?void 0:A.adminUser)||K.includes(e.userName)},icon:function(){return"trash alternate"},onClick:function(e,t){x(!0),P(t)},popupText:function(){return O("users:usersList.list.iconPopups.delete")},renderer:"semantic-icon"}),e}}(),columns:[{allowToggleVisibility:!1,dataIndex:"name",id:"name",key:"name",render:function(e){var t,n,l,a=(0,i.WX)(null==e?void 0:e.userName),u=g.QH.resolveUserListSubheader(e),c=void 0===(null===(t=e.name)||void 0===t?void 0:t.familyName)&&void 0===(null===(n=e.name)||void 0===n?void 0:n.givenName);return r.createElement(o.Z,{image:!0,as:"h6",className:"header-with-icon","data-testid":"".concat(L,"-item-heading")},r.createElement(s.Yt,{"data-testid":"all-users-list-item-image",name:(null===(l=e.userName.split("/"))||void 0===l?void 0:l.length)>1?e.userName.split("/")[1]:e.userName.split("/")[0],size:"mini",image:e.profileUrl,spaced:"right","data-hj-suppress":""}),r.createElement(o.Z.Content,null,r.createElement("div",{className:c?"mt-2":"","data-hj-suppress":""},a),!c&&r.createElement(o.Z.Subheader,{"data-testid":"".concat(L,"-item-sub-heading")},u)))},title:"User"},{allowToggleVisibility:!1,dataIndex:"type",id:"type",key:"type",render:function(e){return e.userName===X?"Owner":(0,i.tF)(e.userName)===f.userstoresConfig.primaryUserstoreName?v.UserAccountTypes.USER:m.administratorConfig.adminRoleName},title:r.createElement(r.Fragment,null,r.createElement("div",{className:"header-with-popup"},r.createElement("span",null,O("extensions:manage.users.list.columns.accountType")),r.createElement(s.GI,{trigger:r.createElement("div",{className:"inline"},r.createElement(u.Z,{disabled:!0,name:"info circle",className:"link pointing pl-1"})),content:O("extensions:manage.users.list.popups.content.AccountTypeContent"),position:"top center",size:"mini",hideOnScroll:!0,inverted:!0})))},{allowToggleVisibility:!1,dataIndex:"idpType",id:"idpType",key:"idpType",render:function(e){var t,n;return null!==(t=e[p.SCIMConfigs.scim.enterpriseSchema])&&void 0!==t&&t.idpType?null===(n=e[p.SCIMConfigs.scim.enterpriseSchema])||void 0===n?void 0:n.idpType:"N/A"},title:r.createElement(r.Fragment,null,r.createElement("div",{className:"header-with-popup"},r.createElement("span",null,O("extensions:manage.users.list.columns.idpType")),r.createElement(s.GI,{trigger:r.createElement("div",{className:"inline"},r.createElement(u.Z,{disabled:!0,name:"info circle",className:"link pointing pl-1"})),content:O("extensions:manage.users.list.popups.content.idpTypeContent"),position:"top center",size:"mini",hideOnScroll:!0,inverted:!0})))},{allowToggleVisibility:!1,dataIndex:"userStore",id:"userStore",key:"userStore",render:function(e){var t,n;return null!==(t=e[p.SCIMConfigs.scim.enterpriseSchema])&&void 0!==t&&t.userSource?null===(n=e[p.SCIMConfigs.scim.enterpriseSchema])||void 0===n?void 0:n.userSource:"N/A"},title:r.createElement(r.Fragment,null,r.createElement("div",{className:"header-with-popup"},r.createElement("span",null,O("extensions:manage.users.list.columns.userStore")),r.createElement(s.GI,{trigger:r.createElement("div",{className:"inline"},r.createElement(u.Z,{disabled:!0,name:"info circle",className:"link pointing pl-1"})),content:O("extensions:manage.users.list.popups.content.sourceContent"),position:"top center",size:"mini",hideOnScroll:!0,inverted:!0})))},{allowToggleVisibility:!1,dataIndex:"action",id:"actions",key:"actions",textAlign:"right",title:""}],data:z.Resources,onColumnSelectionChange:C,onRowClick:function(e,t){ee(t),T&&T(e,t)},placeholders:te(),selectable:N,showHeader:!0,transparent:!y&&null!==te(),"data-testid":L}),M&&r.createElement(s.cV,{primaryActionLoading:B,"data-testid":"".concat(L,"-confirmation-modal"),onClose:function(){return x(!1)},type:"negative",open:F,assertionHint:O("user:deleteUser.confirmationModal.assertionHint"),assertionType:"checkbox",primaryAction:"Confirm",secondaryAction:"Cancel",onSecondaryActionClick:function(){x(!1),G(null)},onPrimaryActionClick:function(){var e;q(!0),(null===(e=M.userName)||void 0===e?void 0:e.split("/")[0])===f.userstoresConfig.primaryUserstoreName?_(M.id).finally((function(){q(!1),P(void 0),x(!1)})):w(M.id).finally((function(){q(!1),P(void 0),x(!1)}))},closeOnDimmerClick:!1},r.createElement(s.cV.Header,{"data-testid":"".concat(L,"-confirmation-modal-header")},O("user:deleteUser.confirmationModal.header")),r.createElement(s.cV.Message,{"data-testid":"".concat(L,"-confirmation-modal-message"),attached:!0,negative:!0},(0,i.tF)(M.userName)===f.userstoresConfig.primaryUserstoreName?O("user:deleteUser.confirmationModal.message"):O("extensions:manage.guest.deleteUser.confirmationModal.message")),r.createElement(s.cV.Content,{"data-testid":"".concat(L,"-confirmation-modal-content")},r.createElement("div",{className:"modal-alert-wrapper"}," ",V&&H),(0,i.tF)(M.userName)===f.userstoresConfig.primaryUserstoreName?null!==(t=M[p.SCIMConfigs.scim.enterpriseSchema])&&void 0!==t&&t.userSourceId?O("user:deleteJITUser.confirmationModal.content"):O("user:deleteUser.confirmationModal.content"):O("extensions:manage.guest.deleteUser.confirmationModal.content"))))};E.defaultProps={selection:!0,showListItemActions:!0}}}]);