"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[22433],{5030:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(93129),i=n(73508),a=n(61263);const r=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,l={headers:{Accept:"application/json","Content-Type":"application/json"},method:o.f2.GET,params:{filter:t,limit:r,offset:n},url:"".concat(a.h.getState().config.endpoints.organizations,"/organizations/discovery")},c=(0,i.Z)(e?l:null,{shouldRetryOnError:!1}),s=c.data,u=c.error;return{data:s,error:u,isLoading:!u&&!s,isValidating:c.isValidating,mutate:c.mutate}}},5300:(e,t,n)=>{n.d(t,{w:()=>o});var o=n(21337).r},8906:(e,t,n)=>{n.d(t,{R:()=>u});var o,i=n(22732);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,s(o.key),o)}}function l(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=a(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}var u=l((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}));o=u,c(u,"ORGANIZATION_DOMAIN_ASSIGN_ERROR_CODE","CON-ODA-10001"),c(u,"ORGANIZATION_DOMAIN_ASSIGN_INVALID_STATUS_CODE_ERROR_CODE","CON-ODA-10002"),c(u,"ORGANIZATION_DOMAIN_ASSIGN_FORM_ID","organization-domain-assign-form"),c(u,"ErrorMessages",{ORGANIZATION_DOMAIN_ASSIGN_ERROR:new i.O(o.ORGANIZATION_DOMAIN_ASSIGN_ERROR_CODE,"An error occurred while assigning email domains for the organization.","Error while assigning domains",null),ORGANIZATION_DOMAIN_ASSIGN_INVALID_STATUS_CODE_ERROR:new i.O(o.ORGANIZATION_DOMAIN_ASSIGN_INVALID_STATUS_CODE_ERROR_CODE,"An invalid status code was received while assigning email domains for the organization.","Invalid status code while assigning domains",null)}),c(u,"FEATURE_DICTIONARY",(new Map).set("ORGANIZATION_DISCOVERY_CREATE","organizationDiscovery.create").set("ORGANIZATION_DISCOVERY_UPDATE","organizationDiscovery.update").set("ORGANIZATION_DISCOVERY_DELETE","organizationDiscovery.delete").set("ORGANIZATION_DISCOVERY_READ","organizationDiscovery.read"))},22433:(e,t,n)=>{n.r(t),n.d(t,{default:()=>J});var o=n(73150),i=n(24184),a=n(54833),r=n(93129),l=n(3356),c=n(90960),s=n(86727),u=n(38314),d=n(67127),m=n(44194),g=n(10479),f=n(47245),v=n(39114),p=n(26154),y=n(62508),h=n(24393),O=n(34148),b=n(61263),D=O.AsgardeoSPAClient.getInstance().httpRequest.bind(O.AsgardeoSPAClient.getInstance());const S=function(e){var t={data:e,headers:{"Content-Type":"application/json"},method:r.f2.POST,url:"".concat(b.h.getState().config.endpoints.organizations,"/organization-configs/discovery")};return D(t).then((function(e){return 201!==e.status?Promise.reject(new Error("Failed to add organization discovery configs.")):Promise.resolve(null==e?void 0:e.data)})).catch((function(e){var t;return Promise.reject(null==e||null===(t=e.response)||void 0===t?void 0:t.data)}))};var E=O.AsgardeoSPAClient.getInstance().httpRequest.bind(O.AsgardeoSPAClient.getInstance());const I=function(){var e={headers:{Accept:"application/json","Content-Type":"application/json"},method:"DELETE",url:"".concat(b.h.getState().config.endpoints.organizations,"/organization-configs/discovery")};return E(e).then((function(e){return 204!==(null==e?void 0:e.status)?Promise.reject(new Error("Failed to delete organization discovery configs.")):Promise.resolve(null==e?void 0:e.data)})).catch((function(e){return Promise.reject(e)}))};var A=n(5030),R=n(73508);function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function N(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,C(o.key),o)}}function z(e,t,n){return t&&N(e.prototype,t),n&&N(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function C(e){var t=function(e,t){if("object"!=_(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=_(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_(t)?t:t+""}var T,w,P,j=z((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}));function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e,t,n){var o;return o=function(e,t){if("object"!=L(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=L(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==L(o)?o:o+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}T=j,P="OCM-60002",(w=C(w="ORGANIZATION_DISCOVERY_DOMAINS_NOT_CONFIGURED_ERROR_CODE"))in T?Object.defineProperty(T,w,{value:P,enumerable:!0,configurable:!0,writable:!0}):T[w]=P;const V=function(){var e,t,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],o={headers:{Accept:"application/json","Content-Type":"application/json"},method:r.f2.GET,url:"".concat(b.h.getState().config.endpoints.organizations,"/organization-configs/discovery")},i=(0,R.Z)(n?o:null,{shouldRetryOnError:!1}),a=i.data,l=i.error,c=i.isValidating,s=i.mutate,u=!1;null!=a&&a.properties&&(null===(t=a.properties)||void 0===t||t.forEach((function(e){"emailDomain.enable"===e.key&&(u=!0)})));return(null==l||null===(e=l.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.code)===j.ORGANIZATION_DISCOVERY_DOMAINS_NOT_CONFIGURED_ERROR_CODE?{data:G({isOrganizationDiscoveryEnabled:u=!1},a),error:l,isLoading:!l&&!a,isValidating:c,mutate:s}:{data:G({isOrganizationDiscoveryEnabled:u},a),error:l,isLoading:!l&&!a,isValidating:c,mutate:s}};var M=n(12638),U=n(69772),x=n(5300),Q=n(8906),F=function(e){var t=e.defaultListItemLimit,n=e.isLoading,o=e.list,r=e.onEmptyListPlaceholderActionClick,l=e.onSearchQueryClear,c=e.searchQuery,u=e.selection,v=e.showListItemActions,y=e.isRenderedOnPortal,O=e["data-componentid"],b=(0,g.$)().t,D=(0,f.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.allowedScopes})),S=(0,f.v9)((function(e){var t;return null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t||null===(t=t.features)||void 0===t?void 0:t.organizationDiscovery})),E=(0,f.v9)((function(e){return e.config.ui.features})),I=h.lD.getInstance(),A=function(e){h.m8.push({pathname:h.$x.getPaths().get("UPDATE_ORGANIZATION_DISCOVERY_DOMAINS").replace(":id",e)})},R=function(){return c&&((0,d.Z)(o)||0===(null==o?void 0:o.totalResults))?m.createElement(s.$J,{action:m.createElement(s.Qj,{onClick:l},b("console:manage.placeholders.emptySearchResult.action")),image:(0,U.jF)().emptySearch,imageSize:"tiny",title:b("console:manage.placeholders.emptySearchResult.title"),subtitle:[b("console:manage.placeholders.emptySearchResult.subtitles.0",{query:c.split(" ").pop()}),b("console:manage.placeholders.emptySearchResult.subtitles.1")],"data-componentid":"".concat(O,"-empty-search-placeholder")}):(0,d.Z)(o)||0===(null==o?void 0:o.totalResults)?m.createElement(s.$J,{className:y?"":"list-placeholder mr-0",action:r&&m.createElement(i.di,{when:null==E||null===(e=E.organizationDiscovery)||void 0===e||null===(e=e.scopes)||void 0===e?void 0:e.create},m.createElement(s.KM,{onClick:function(){I.publish(O+"-click-assign-email-domain-button"),r()}},m.createElement(p.Z,{name:"add"}),b("organizationDiscovery:placeholders.emptyList.action"))),image:(0,U.jF)().newList,imageSize:"tiny",title:b("console:manage.placeholders.emptySearchResult.title"),subtitle:[b("organizationDiscovery:placeholders.emptyList.subtitles")],"data-componentid":"".concat(O,"-empty-placeholder")}):null;var e};return m.createElement(s.wQ,{className:"organizations-table",isLoading:n,loadingStateOptions:{count:null!=t?t:h.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT,imageType:"square"},actions:function(){if(v)return[{"data-componentid":"".concat(O,"-item-edit-button"),hidden:function(){return!(0,a.cr)(S,Q.R.FEATURE_DICTIONARY.get("ORGANIZATION_DISCOVERY_UPDATE"))},icon:function(){var e;return(0,a.Xr)(S,null==S||null===(e=S.scopes)||void 0===e?void 0:e.update,D)?"pencil alternate":"eye"},onClick:function(e,t){return A(t.organizationId)},popupText:function(){var e;return(0,a.Xr)(S,null==S||null===(e=S.scopes)||void 0===e?void 0:e.update,D)?b("common:edit"):b("common:view")},renderer:"semantic-icon"}]}(),columns:[{allowToggleVisibility:!1,dataIndex:"name",id:"name",key:"name",render:function(e){return m.createElement(M.Z,{image:!0,as:"h6",className:"header-with-icon","data-componentid":"".concat(O,"-item-heading")},m.createElement(s.dn,{defaultIcon:!0,relaxed:"very",size:"micro",shape:"rounded",spaced:"right",hoverable:!1,icon:x.w}),m.createElement(M.Z.Content,null,e.organizationName))},title:b("organizations:list.columns.name")},{allowToggleVisibility:!1,dataIndex:"action",id:"actions",key:"actions",textAlign:"right",title:b("organizations:list.columns.actions")}],data:null==o?void 0:o.organizations,onRowClick:function(e,t){A(t.organizationId)},placeholders:R(),selectable:u,showHeader:!1,transparent:!n&&null!==R(),"data-componentid":O})};F.defaultProps={"data-componentid":"discoverable-organizations-list",selection:!0,showListItemActions:!0};const Y=F;function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,i,a,r,l=[],c=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=a.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){s=!0,i=e}finally{try{if(!c&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(s)throw i}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var X=[{key:0,text:c.I18n.instance.t("organizationDiscovery:advancedSearch.form.dropdown.filterAttributeOptions.organizationName"),value:"organizationName"}],B=function(e){var t,n,c,O,b=e["data-componentid"],D=(0,g.$)().t,E=(0,f.I0)(),R=(0,f.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t?void 0:t.features})),_=(0,f.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.allowedScopes})),N=(0,m.useMemo)((function(){var e;return!(0,a.Xr)(null==R?void 0:R.organizationDiscovery,null==R||null===(e=R.organizationDiscovery)||void 0===e||null===(e=e.scopes)||void 0===e?void 0:e.update,_)}),[R,_]),z=$((0,m.useState)(""),2),C=z[0],T=z[1],w=$((0,m.useState)(X[0]),2),P=w[0],j=w[1],L=$((0,m.useState)(h.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT),2),Z=L[0],G=L[1],k=$((0,m.useState)(0),2),M=k[0],U=k[1],x=$((0,m.useState)(!1),2),Q=x[0],F=x[1],q=h.lD.getInstance(),B=(0,m.useMemo)((function(){return C}),[C]),J=V(),K=J.data,W=J.error,H=J.isLoading,ee=J.mutate,te=(0,A.Z)(!0,B,M,Z),ne=te.data,oe=te.error,ie=te.isLoading,ae=K.isOrganizationDiscoveryEnabled;(0,m.useEffect)((function(){var e;W&&404!==(null===(e=W.response)||void 0===e?void 0:e.status)&&E((0,l.V_)({description:D("organizationDiscovery:notifications.getEmailDomainDiscovery.error.description"),level:r.QU.ERROR,message:D("organizationDiscovery:notifications.getEmailDomainDiscovery.error.message")}))}),[W]),(0,m.useEffect)((function(){oe&&E((0,l.V_)({description:D("organizationDiscovery:notifications.getOrganizationListWithDiscovery.error.description"),level:r.QU.ERROR,message:D("organizationDiscovery:notifications.getOrganizationListWithDiscovery.error.message")}))}),[oe]);var re,le=(0,m.useCallback)((function(e){T(e)}),[T]),ce=(0,m.useCallback)((function(){F(!Q),T("")}),[T,Q]),se=function(e,t){if(!0===t.checked){var n={properties:[]};return n.properties.push({key:"emailDomain.enable",value:!0}),void S(n).then((function(){E((0,l.V_)({description:D("organizationDiscovery:notifications.enableEmailDomainDiscovery.success.description"),level:r.QU.SUCCESS,message:D("organizationDiscovery:notifications.enableEmailDomainDiscovery.success.message")})),ee()})).catch((function(){E((0,l.V_)({description:D("organizationDiscovery:notifications.enableEmailDomainDiscovery.error.description"),level:r.QU.ERROR,message:D("organizationDiscovery:notifications.enableEmailDomainDiscovery.error.message")}))}))}I().then((function(){E((0,l.V_)({description:D("organizationDiscovery:notifications.disableEmailDomainDiscovery.success.description"),level:r.QU.SUCCESS,message:D("organizationDiscovery:notifications.disableEmailDomainDiscovery.success.message")})),ee()})).catch((function(){E((0,l.V_)({description:D("organizationDiscovery:notifications.disableEmailDomainDiscovery.error.description"),level:r.QU.ERROR,message:D("organizationDiscovery:notifications.disableEmailDomainDiscovery.error.message")}))}))};return m.createElement(s.Xg,{action:!H&&ae&&!(!C&&((0,d.Z)(ne)||(null==ne?void 0:ne.totalResults)<=0))&&m.createElement(i.di,{when:null==R||null===(t=R.organizationDiscovery)||void 0===t||null===(t=t.scopes)||void 0===t?void 0:t.create},m.createElement(s.KM,{disabled:ie,loading:ie,onClick:function(){q.publish("organization-click-assign-email-domain-button"),h.m8.push(h.$x.getPaths().get("ASSIGN_ORGANIZATION_DISCOVERY_DOMAINS"))},"data-componentid":"".concat(b,"-list-layout-assign-button")},m.createElement(p.Z,{name:"add"}),D("organizationDiscovery:emailDomains.actions.assign"))),pageTitle:D("pages:emailDomainDiscovery.title"),title:D("pages:emailDomainDiscovery.title"),description:D("pages:emailDomainDiscovery.subTitle"),"data-componentid":"".concat(b,"-page-layout"),backButton:{"data-testid":"".concat(b,"-page-back-button"),onClick:function(){h.m8.push(h.$x.getPaths().get("LOGIN_AND_REGISTRATION"))},text:D("governanceConnectors:goBackLoginAndRegistration")}},m.createElement(v.Z,{label:D("organizationDiscovery:emailDomains.actions.enable"),toggle:!0,onChange:se,checked:ae,"data-testId":"".concat(b,"-enable-toggle"),readOnly:N}),m.createElement(y.Z,{hidden:!0}),m.createElement(o.Z,{severity:"info"},D("organizationDiscovery:message")),m.createElement(y.Z,{hidden:!0}),ae&&m.createElement(s.PS,{advancedSearch:m.createElement(h.nC,{onFilter:le,filterAttributeOptions:[{key:0,text:D("organizationDiscovery:advancedSearch.form.dropdown.filterAttributeOptions.organizationName"),value:"organizationName"}],filterAttributePlaceholder:D("organizationDiscovery:advancedSearch.form.inputs.filterAttribute.placeholder"),filterConditionsPlaceholder:D("organizationDiscovery:advancedSearch.form.inputs.filterCondition.placeholder"),filterValuePlaceholder:D("organizationDiscovery:advancedSearch.form.inputs.filterValue.placeholder"),placeholder:D("organizationDiscovery:advancedSearch.placeholder"),defaultSearchAttribute:"organizationName",defaultSearchOperator:"co",triggerClearQuery:Q,"data-componentid":"".concat(b,"-list-advanced-search")}),currentListSize:null==ne||null===(n=ne.organizations)||void 0===n?void 0:n.length,listItemLimit:Z,onItemsPerPageDropdownChange:function(e,t){G(t.value)},onPageChange:function(e,t){var n=(t.activePage-1)*Z;U(n)},onSortStrategyChange:function(e,t){j((0,u.Z)(X,(function(e){return t.value===e.value})))},showTopActionPanel:ie||!(!C&&(null==ne||null===(c=ne.organizations)||void 0===c?void 0:c.length)<=0),sortOptions:X,sortStrategy:P,totalPages:10,totalListSize:null==ne||null===(O=ne.organizations)||void 0===O?void 0:O.length,isLoading:ie,paginationOptions:{disableNextButton:(re=ne,!((null==re?void 0:re.startIndex)+(null==re?void 0:re.count)!==(null==re?void 0:re.totalResults)+1))},"data-componentid":"".concat(b,"-list-layout"),showPagination:!0},m.createElement(Y,{list:ne,onEmptyListPlaceholderActionClick:function(){h.m8.push(h.$x.getPaths().get("ASSIGN_ORGANIZATION_DISCOVERY_DOMAINS"))},onSearchQueryClear:ce,searchQuery:C,"data-componentid":"organization-list-with-discovery"})))};B.defaultProps={"data-componentid":"organization-discovery-domains-page"};const J=B}}]);